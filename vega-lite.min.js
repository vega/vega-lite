!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var n;n="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,n.vl=e()}}(function(){var e;return function n(e,t,i){function a(o,u){if(!t[o]){if(!e[o]){var l="function"==typeof require&&require;if(!u&&l)return l(o,!0);if(r)return r(o,!0);var c=new Error("Cannot find module '"+o+"'");throw c.code="MODULE_NOT_FOUND",c}var s=t[o]={exports:{}};e[o][0].call(s.exports,function(n){var t=e[o][1][n];return a(t?t:n)},s,s.exports,n,e,t,i)}return t[o].exports}for(var r="function"==typeof require&&require,o=0;o<i.length;o++)a(i[o]);return a}({1:[function(e,n,t){},{}],2:[function(n,t,i){!function(n,a){"object"==typeof i&&"undefined"!=typeof t?a(i):"function"==typeof e&&e.amd?e("d3-time",["exports"],a):a(n.d3_time={})}(this,function(e){"use strict";function n(e,t,i,o){function u(n){return e(n=new Date(+n)),n}return u.floor=u,u.round=function(n){var i=new Date(+n),a=new Date(n-1);return e(i),e(a),t(a,1),a-n>n-i?i:a},u.ceil=function(n){return e(n=new Date(n-1)),t(n,1),n},u.offset=function(e,n){return t(e=new Date(+e),null==n?1:Math.floor(n)),e},u.range=function(n,i,a){var r=[];if(n=new Date(n-1),i=new Date(+i),a=null==a?1:Math.floor(a),!(i>n&&a>0))return r;for(t(n,1),e(n),i>n&&r.push(new Date(+n));t(n,a),e(n),i>n;)r.push(new Date(+n));return r},u.filter=function(i){return n(function(n){for(;e(n),!i(n);)n.setTime(n-1)},function(e,n){for(;--n>=0;)for(;t(e,1),!i(e););})},i&&(u.count=function(n,t){return a.setTime(+n),r.setTime(+t),e(a),e(r),Math.floor(i(a,r))},u.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?u.filter(o?function(n){return o(n)%e===0}:function(n){return u.count(0,n)%e===0}):u:null}),u}function t(e){return n(function(n){n.setHours(0,0,0,0),n.setDate(n.getDate()-(n.getDay()+7-e)%7)},function(e,n){e.setDate(e.getDate()+7*n)},function(e,n){return(n-e-6e4*(n.getTimezoneOffset()-e.getTimezoneOffset()))/6048e5})}function i(e){return n(function(n){n.setUTCHours(0,0,0,0),n.setUTCDate(n.getUTCDate()-(n.getUTCDay()+7-e)%7)},function(e,n){e.setUTCDate(e.getUTCDate()+7*n)},function(e,n){return(n-e)/6048e5})}var a=new Date,r=new Date,o=n(function(){},function(e,n){e.setTime(+e+n)},function(e,n){return n-e});o.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?n(function(n){n.setTime(Math.floor(n/e)*e)},function(n,t){n.setTime(+n+t*e)},function(n,t){return(t-n)/e}):o:null};var u=n(function(e){e.setMilliseconds(0)},function(e,n){e.setTime(+e+1e3*n)},function(e,n){return(n-e)/1e3},function(e){return e.getSeconds()}),l=n(function(e){e.setSeconds(0,0)},function(e,n){e.setTime(+e+6e4*n)},function(e,n){return(n-e)/6e4},function(e){return e.getMinutes()}),c=n(function(e){e.setMinutes(0,0,0)},function(e,n){e.setTime(+e+36e5*n)},function(e,n){return(n-e)/36e5},function(e){return e.getHours()}),s=n(function(e){e.setHours(0,0,0,0)},function(e,n){e.setDate(e.getDate()+n)},function(e,n){return(n-e-6e4*(n.getTimezoneOffset()-e.getTimezoneOffset()))/864e5},function(e){return e.getDate()-1}),f=t(0),d=t(1),p=t(2),m=t(3),g=t(4),h=t(5),O=t(6),T=n(function(e){e.setHours(0,0,0,0),e.setDate(1)},function(e,n){e.setMonth(e.getMonth()+n)},function(e,n){return n.getMonth()-e.getMonth()+12*(n.getFullYear()-e.getFullYear())},function(e){return e.getMonth()}),E=n(function(e){e.setHours(0,0,0,0),e.setMonth(0,1)},function(e,n){e.setFullYear(e.getFullYear()+n)},function(e,n){return n.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()}),y=n(function(e){e.setUTCMilliseconds(0)},function(e,n){e.setTime(+e+1e3*n)},function(e,n){return(n-e)/1e3},function(e){return e.getUTCSeconds()}),v=n(function(e){e.setUTCSeconds(0,0)},function(e,n){e.setTime(+e+6e4*n)},function(e,n){return(n-e)/6e4},function(e){return e.getUTCMinutes()}),A=n(function(e){e.setUTCMinutes(0,0,0)},function(e,n){e.setTime(+e+36e5*n)},function(e,n){return(n-e)/36e5},function(e){return e.getUTCHours()}),S=n(function(e){e.setUTCHours(0,0,0,0)},function(e,n){e.setUTCDate(e.getUTCDate()+n)},function(e,n){return(n-e)/864e5},function(e){return e.getUTCDate()-1}),N=i(0),R=i(1),M=i(2),C=i(3),L=i(4),x=i(5),D=i(6),I=n(function(e){e.setUTCHours(0,0,0,0),e.setUTCDate(1)},function(e,n){e.setUTCMonth(e.getUTCMonth()+n)},function(e,n){return n.getUTCMonth()-e.getUTCMonth()+12*(n.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()}),b=n(function(e){e.setUTCHours(0,0,0,0),e.setUTCMonth(0,1)},function(e,n){e.setUTCFullYear(e.getUTCFullYear()+n)},function(e,n){return n.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()}),k=o.range,U=u.range,Y=l.range,_=c.range,X=s.range,w=f.range,H=d.range,P=p.range,z=m.range,F=g.range,W=h.range,V=O.range,G=f.range,Z=T.range,B=E.range,Q=o,q=k,j=y.range,K=v.range,$=A.range,J=S.range,ee=N.range,ne=R.range,te=M.range,ie=C.range,ae=L.range,re=x.range,oe=D.range,ue=N.range,le=I.range,ce=b.range,se="0.1.1";e.version=se,e.milliseconds=k,e.seconds=U,e.minutes=Y,e.hours=_,e.days=X,e.sundays=w,e.mondays=H,e.tuesdays=P,e.wednesdays=z,e.thursdays=F,e.fridays=W,e.saturdays=V,e.weeks=G,e.months=Z,e.years=B,e.utcMillisecond=Q,e.utcMilliseconds=q,e.utcSeconds=j,e.utcMinutes=K,e.utcHours=$,e.utcDays=J,e.utcSundays=ee,e.utcMondays=ne,e.utcTuesdays=te,e.utcWednesdays=ie,e.utcThursdays=ae,e.utcFridays=re,e.utcSaturdays=oe,e.utcWeeks=ue,e.utcMonths=le,e.utcYears=ce,e.millisecond=o,e.second=u,e.minute=l,e.hour=c,e.day=s,e.sunday=f,e.monday=d,e.tuesday=p,e.wednesday=m,e.thursday=g,e.friday=h,e.saturday=O,e.week=f,e.month=T,e.year=E,e.utcSecond=y,e.utcMinute=v,e.utcHour=A,e.utcDay=S,e.utcSunday=N,e.utcMonday=R,e.utcTuesday=M,e.utcWednesday=C,e.utcThursday=L,e.utcFriday=x,e.utcSaturday=D,e.utcWeek=N,e.utcMonth=I,e.utcYear=b,e.interval=n})},{}],3:[function(e,n,t){function i(e){if(!e)throw Error("Missing binning options.");var n,t,i,u,l,c,s,f=e.maxbins||15,d=e.base||10,p=Math.log(d),m=e.div||[5,2],g=e.min,h=e.max,O=h-g;if(e.step)n=e.step;else if(e.steps)n=e.steps[Math.min(e.steps.length-1,a(e.steps,O/f,0,e.steps.length))];else{for(t=Math.ceil(Math.log(f)/p),i=e.minstep||0,n=Math.max(i,Math.pow(d,Math.round(Math.log(O)/p)-t));Math.ceil(O/n)>f;)n*=d;for(c=0;c<m.length;++c)l=n/m[c],l>=i&&f>=O/l&&(n=l)}return l=Math.log(n),u=l>=0?0:~~(-l/p)+1,s=Math.pow(d,-u-1),g=Math.min(g,Math.floor(g/n+s)*n),h=Math.ceil(h/n)*n,{start:g,stop:h,step:n,unit:{precision:u},value:r,index:o}}function a(e,n,t,i){for(;i>t;){var a=t+i>>>1;c.cmp(e[a],n)<0?t=a+1:i=a}return t}function r(e){return this.step*Math.floor(e/this.step+f)}function o(e){return Math.floor((e-this.start)/this.step+f)}function u(e){return this.unit.date(r.call(this,e))}function l(e){return o.call(this,this.unit.unit(e))}var c=e("../util"),s=e("../time"),f=1e-15;i.date=function(e){if(!e)throw Error("Missing date binning options.");var n=e.utc?s.utc:s,t=e.min,a=e.max,r=e.maxbins||20,o=e.minbins||4,c=+a-+t,f=e.unit?n[e.unit]:n.find(c,o,r),d=i({min:null!=f.min?f.min:f.unit(t),max:null!=f.max?f.max:f.unit(a),maxbins:r,minstep:f.minstep,steps:f.step});return d.unit=f,d.index=l,e.raw||(d.value=u),d},n.exports=i},{"../time":5,"../util":6}],4:[function(e,n,t){var i=e("./util"),a=n.exports;a.repeat=function(e,n){var t,i=Array(n);for(t=0;n>t;++t)i[t]=e;return i},a.zeros=function(e){return a.repeat(0,e)},a.range=function(e,n,t){if(arguments.length<3&&(t=1,arguments.length<2&&(n=e,e=0)),(n-e)/t==1/0)throw new Error("Infinite range");var i,a=[],r=-1;if(0>t)for(;(i=e+t*++r)>n;)a.push(i);else for(;(i=e+t*++r)<n;)a.push(i);return a},a.random={},a.random.uniform=function(e,n){void 0===n&&(n=void 0===e?1:e,e=0);var t=n-e,i=function(){return e+t*Math.random()};return i.samples=function(e){return a.zeros(e).map(i)},i.pdf=function(i){return i>=e&&n>=i?1/t:0},i.cdf=function(i){return e>i?0:i>n?1:(i-e)/t},i.icdf=function(n){return n>=0&&1>=n?e+n*t:NaN},i},a.random.integer=function(e,n){void 0===n&&(n=e,e=0);var t=n-e,i=function(){return e+Math.floor(t*Math.random())};return i.samples=function(e){return a.zeros(e).map(i)},i.pdf=function(i){return i===Math.floor(i)&&i>=e&&n>i?1/t:0},i.cdf=function(i){var a=Math.floor(i);return e>a?0:a>=n?1:(a-e+1)/t},i.icdf=function(n){return n>=0&&1>=n?e-1+Math.floor(n*t):NaN},i},a.random.normal=function(e,n){e=e||0,n=n||1;var t,i=function(){var i,a,r=0,o=0;if(void 0!==t)return r=t,t=void 0,r;do r=2*Math.random()-1,o=2*Math.random()-1,i=r*r+o*o;while(0===i||i>1);return a=Math.sqrt(-2*Math.log(i)/i),t=e+o*a*n,e+r*a*n};return i.samples=function(e){return a.zeros(e).map(i)},i.pdf=function(t){var i=Math.exp(Math.pow(t-e,2)/(-2*Math.pow(n,2)));return 1/(n*Math.sqrt(2*Math.PI))*i},i.cdf=function(t){var i,a=(t-e)/n,r=Math.abs(a);if(r>37)i=0;else{var o,u=Math.exp(-r*r/2);7.07106781186547>r?(o=.0352624965998911*r+.700383064443688,o=o*r+6.37396220353165,o=o*r+33.912866078383,o=o*r+112.079291497871,o=o*r+221.213596169931,o=o*r+220.206867912376,i=u*o,o=.0883883476483184*r+1.75566716318264,o=o*r+16.064177579207,o=o*r+86.7807322029461,o=o*r+296.564248779674,o=o*r+637.333633378831,o=o*r+793.826512519948,o=o*r+440.413735824752,i/=o):(o=r+.65,o=r+4/o,o=r+3/o,o=r+2/o,o=r+1/o,i=u/o/2.506628274631)}return a>0?1-i:i},i.icdf=function(t){if(0>=t||t>=1)return NaN;var i=2*t-1,a=8*(Math.PI-3)/(3*Math.PI*(4-Math.PI)),r=2/(Math.PI*a)+Math.log(1-Math.pow(i,2))/2,o=Math.log(1-i*i)/a,u=(i>0?1:-1)*Math.sqrt(Math.sqrt(r*r-o)-r);return e+n*Math.SQRT2*u},i},a.random.bootstrap=function(e,n){var t=e.filter(i.isValid),r=t.length,o=n?a.random.normal(0,n):null,u=function(){return t[~~(Math.random()*r)]+(o?o():0)};return u.samples=function(e){return a.zeros(e).map(u)},u}},{"./util":6}],5:[function(e,n,t){function i(e){return c.setTime(+e),c}function a(e,n,t,i,a,r){var o={type:e,date:n,unit:t};return i?o.step=i:o.minstep=1,null!=a&&(o.min=a),null!=r&&(o.max=r),o}function r(e,n,t,i,r,o){return a(e,function(e){return n.offset(t,e)},function(e){return n.count(t,e)},i,r,o)}function o(e,n,t,i){var a,r,o,u=m[0];for(a=1,r=m.length;r>a;++a)if(u=m[a],n>u[0]){if(o=n/u[0],o>i)return e[m[a-1][1]];if(o>=t)return e[u[1]]}return e[m[r-1][1]]}function u(e){var n,t,i={};for(n=0,t=e.length;t>n;++n)i[e[n].type]=e[n];return i.find=function(n,t,i){return o(e,n,t,i)},i}var l=e("d3-time"),c=new Date,s=new Date(0,0,1).setFullYear(0),f=new Date(Date.UTC(0,0,1)).setUTCFullYear(0),d=[r("second",l.second,s),r("minute",l.minute,s),r("hour",l.hour,s),r("day",l.day,s,[1,7]),r("month",l.month,s,[1,3,6]),r("year",l.year,s),a("seconds",function(e){return new Date(1970,0,1,0,0,e)},function(e){return i(e).getSeconds()},null,0,59),a("minutes",function(e){return new Date(1970,0,1,0,e)},function(e){return i(e).getMinutes()},null,0,59),a("hours",function(e){return new Date(1970,0,1,e)},function(e){return i(e).getHours()},null,0,23),a("weekdays",function(e){return new Date(1970,0,4+e)},function(e){return i(e).getDay()},[1],0,6),a("dates",function(e){return new Date(1970,0,e)},function(e){return i(e).getDate()},[1],1,31),a("months",function(e){return new Date(1970,e%12,1)},function(e){return i(e).getMonth()},[1],0,11)],p=[r("second",l.utcSecond,f),r("minute",l.utcMinute,f),r("hour",l.utcHour,f),r("day",l.utcDay,f,[1,7]),r("month",l.utcMonth,f,[1,3,6]),r("year",l.utcYear,f),a("seconds",function(e){return new Date(Date.UTC(1970,0,1,0,0,e))},function(e){return i(e).getUTCSeconds()},null,0,59),a("minutes",function(e){return new Date(Date.UTC(1970,0,1,0,e))},function(e){return i(e).getUTCMinutes()},null,0,59),a("hours",function(e){return new Date(Date.UTC(1970,0,1,e))},function(e){return i(e).getUTCHours()},null,0,23),a("weekdays",function(e){return new Date(Date.UTC(1970,0,4+e))},function(e){return i(e).getUTCDay()},[1],0,6),a("dates",function(e){return new Date(Date.UTC(1970,0,e))},function(e){return i(e).getUTCDate()},[1],1,31),a("months",function(e){return new Date(Date.UTC(1970,e%12,1))},function(e){return i(e).getUTCMonth()},[1],0,11)],m=[[31536e6,5],[7776e6,4],[2592e6,4],[12096e5,3],[6048e5,3],[1728e5,3],[864e5,3],[432e5,2],[216e5,2],[108e5,2],[36e5,2],[18e5,1],[9e5,1],[3e5,1],[6e4,1],[3e4,0],[15e3,0],[5e3,0],[1e3,0]];n.exports=u(d),n.exports.utc=u(p)},{"d3-time":2}],6:[function(e,n,t){(function(e){function t(e){return e.replace(l,"$1\\'")}function i(e,n){var t,i="";for(t=0;e>t;++t)i+=n;return i}function a(e,n,t){var i=0,a=e.split(s);return e=t?(a=a.reverse()).filter(function(e){return i+=e.length,n>=i}).reverse():a.filter(function(e){return i+=e.length,n>=i}),e.length?e.join("").trim():a[0].slice(0,n)}var r=n.exports,o="__name__";r.namedfunc=function(e,n){return n[o]=e,n},r.name=function(e){return null==e?null:e[o]},r.identity=function(e){return e},r["true"]=r.namedfunc("true",function(){return!0}),r["false"]=r.namedfunc("false",function(){return!1}),r.duplicate=function(e){return JSON.parse(JSON.stringify(e))},r.equal=function(e,n){return JSON.stringify(e)===JSON.stringify(n)},r.extend=function(e){for(var n,t,i=1,a=arguments.length;a>i;++i){n=arguments[i];for(t in n)e[t]=n[t]}return e},r.length=function(e){return null!=e&&null!=e.length?e.length:null},r.keys=function(e){var n,t=[];for(n in e)t.push(n);return t},r.vals=function(e){var n,t=[];for(n in e)t.push(e[n]);return t},r.toMap=function(e,n){return(n=r.$(n))?e.reduce(function(e,t){return e[n(t)]=1,e},{}):e.reduce(function(e,n){return e[n]=1,e},{})},r.keystr=function(e){var n=e.length;if(!n)return"";for(var t=String(e[0]),i=1;n>i;++i)t+="|"+String(e[i]);return t};var u=Object.prototype.toString;r.isObject=function(e){return e===Object(e)},r.isFunction=function(e){return"[object Function]"===u.call(e)},r.isString=function(e){return"string"==typeof value||"[object String]"===u.call(e)},r.isArray=Array.isArray||function(e){return"[object Array]"===u.call(e)},r.isNumber=function(e){return"number"==typeof e||"[object Number]"===u.call(e)},r.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==u.call(e)},r.isDate=function(e){return"[object Date]"===u.call(e)},r.isValid=function(e){return null!=e&&e===e},r.isBuffer="function"==typeof e&&e.isBuffer||r["false"],r.number=function(e){return null==e||""===e?null:+e},r["boolean"]=function(e){return null==e||""===e?null:"false"===e?!1:!!e},r.date=function(e,n){var t=n?n:Date;return null==e||""===e?null:t.parse(e)},r.array=function(e){return null!=e?r.isArray(e)?e:[e]:[]},r.str=function(e){return r.isArray(e)?"["+e.map(r.str)+"]":r.isObject(e)?JSON.stringify(e):r.isString(e)?"'"+t(e)+"'":e};var l=/(^|[^\\])'/g,c=/\[(.*?)\]|[^.\[]+/g;r.field=function(e){return String(e).match(c).map(function(e){return"["!==e[0]?e:"'"!==e[1]&&'"'!==e[1]?e.slice(1,-1):e.slice(2,-2).replace(/\\(["'])/g,"$1")})},r.accessor=function(e){var n;return null==e||r.isFunction(e)?e:r.namedfunc(e,(n=r.field(e)).length>1?function(e){return n.reduce(function(e,n){return e[n]},e)}:function(n){return n[e]})},r.$=r.accessor,r.mutator=function(e){var n;return r.isString(e)&&(n=r.field(e)).length>1?function(e,t){for(var i=0;i<n.length-1;++i)e=e[n[i]];e[n[i]]=t}:function(n,t){n[e]=t}},r.$func=function(e,n){return function(t){t=r.$(t)||r.identity;var i=e+(r.name(t)?"_"+r.name(t):"");return r.namedfunc(i,function(e){return n(t(e))})}},r.$valid=r.$func("valid",r.isValid),r.$length=r.$func("length",r.length),r.$in=function(e,n){e=r.$(e);var t=r.isArray(n)?r.toMap(n):n;return function(n){return!!t[e(n)]}},r.comparator=function(e){var n=[];return void 0===e&&(e=[]),e=r.array(e).map(function(e){var t=1;return"-"===e[0]?(t=-1,e=e.slice(1)):"+"===e[0]&&(t=1,e=e.slice(1)),n.push(t),r.accessor(e)}),function(t,i){var a,r,o,u,l;for(a=0,r=e.length;r>a;++a){if(o=e[a],u=o(t),l=o(i),l>u)return-1*n[a];if(u>l)return n[a]}return 0}},r.cmp=function(e,n){return n>e?-1:e>n?1:e>=n?0:null===e?-1:null===n?1:NaN},r.numcmp=function(e,n){return e-n},r.stablesort=function(e,n,t){var i=e.reduce(function(e,n,i){return e[t(n)]=i,e},{});return e.sort(function(e,a){var r=n(e),o=n(a);return o>r?-1:r>o?1:i[t(e)]-i[t(a)]}),e},r.pad=function(e,n,t,a){a=a||" ";var r=n-e.length;if(0>=r)return e;switch(t){case"left":return i(r,a)+e;case"middle":case"center":return i(Math.floor(r/2),a)+e+i(Math.ceil(r/2),a);default:return e+i(r,a)}},r.truncate=function(e,n,t,i,r){var o=e.length;if(n>=o)return e;r=void 0!==r?String(r):"â€¦";var u=Math.max(0,n-r.length);switch(t){case"left":return r+(i?a(e,u,1):e.slice(o-u));case"middle":case"center":var l=Math.ceil(u/2),c=Math.floor(u/2);return(i?a(e,l):e.slice(0,l))+r+(i?a(e,c,1):e.slice(o-c));default:return(i?a(e,u):e.slice(0,u))+r}};var s=/([\u0009\u000A\u000B\u000C\u000D\u0020\u00A0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u2028\u2029\u3000\uFEFF])/}).call(this,e("buffer").Buffer)},{buffer:1}],7:[function(e,n,t){!function(e){e[e.VALUES="values"]="VALUES",e[e.COUNT="count"]="COUNT",e[e.VALID="valid"]="VALID",e[e.MISSING="missing"]="MISSING",e[e.DISTINCT="distinct"]="DISTINCT",e[e.SUM="sum"]="SUM",e[e.MEAN="mean"]="MEAN",e[e.AVERAGE="average"]="AVERAGE",e[e.VARIANCE="variance"]="VARIANCE",e[e.VARIANCEP="variancep"]="VARIANCEP",e[e.STDEV="stdev"]="STDEV",e[e.STDEVP="stdevp"]="STDEVP",e[e.MEDIAN="median"]="MEDIAN",e[e.Q1="q1"]="Q1",e[e.Q3="q3"]="Q3",e[e.MODESKEW="modeskew"]="MODESKEW",e[e.MIN="min"]="MIN",e[e.MAX="max"]="MAX",e[e.ARGMIN="argmin"]="ARGMIN",e[e.ARGMAX="argmax"]="ARGMAX"}(t.AggregateOp||(t.AggregateOp={}));var i=t.AggregateOp;t.AGGREGATE_OPS=[i.VALUES,i.COUNT,i.VALID,i.MISSING,i.DISTINCT,i.SUM,i.MEAN,i.AVERAGE,i.VARIANCE,i.VARIANCEP,i.STDEV,i.STDEVP,i.MEDIAN,i.Q1,i.Q3,i.MODESKEW,i.MIN,i.MAX,i.ARGMIN,i.ARGMAX],t.SHARED_DOMAIN_OPS=[i.MEAN,i.AVERAGE,i.STDEV,i.STDEVP,i.MEDIAN,i.Q1,i.Q3,i.MIN,i.MAX]},{}],8:[function(e,n,t){function i(e){switch(e){case a.ROW:case a.COLUMN:case a.SIZE:case a.SHAPE:return 6;default:return 10}}var a=e("./channel");t.autoMaxBins=i},{"./channel":9}],9:[function(e,n,t){function i(e,n){return!!a(e)[n]}function a(e){switch(e){case t.X:case t.Y:case t.COLOR:case t.DETAIL:case t.ORDER:case t.ROW:case t.COLUMN:return{point:!0,tick:!0,circle:!0,square:!0,bar:!0,line:!0,area:!0,text:!0};case t.SIZE:return{point:!0,tick:!0,circle:!0,square:!0,bar:!0,text:!0};case t.SHAPE:return{point:!0};case t.TEXT:return{text:!0};case t.PATH:return{line:!0}}return{}}function r(e){switch(e){case t.X:case t.Y:case t.COLOR:case t.LABEL:return{measure:!0,dimension:!0};case t.ROW:case t.COLUMN:case t.SHAPE:case t.DETAIL:return{measure:!1,dimension:!0};case t.SIZE:case t.TEXT:return{measure:!0,dimension:!1};case t.PATH:return{measure:!1,dimension:!0}}throw new Error("Invalid encoding channel"+e)}function o(e){return!u.contains([t.DETAIL,t.PATH,t.TEXT,t.LABEL,t.ORDER],e)}var u=e("./util");!function(e){e[e.X="x"]="X",e[e.Y="y"]="Y",e[e.ROW="row"]="ROW",e[e.COLUMN="column"]="COLUMN",e[e.SHAPE="shape"]="SHAPE",e[e.SIZE="size"]="SIZE",e[e.COLOR="color"]="COLOR",e[e.TEXT="text"]="TEXT",e[e.DETAIL="detail"]="DETAIL",e[e.LABEL="label"]="LABEL",e[e.PATH="path"]="PATH",e[e.ORDER="order"]="ORDER"}(t.Channel||(t.Channel={}));var l=t.Channel;t.X=l.X,t.Y=l.Y,t.ROW=l.ROW,t.COLUMN=l.COLUMN,t.SHAPE=l.SHAPE,t.SIZE=l.SIZE,t.COLOR=l.COLOR,t.TEXT=l.TEXT,t.DETAIL=l.DETAIL,t.LABEL=l.LABEL,t.PATH=l.PATH,t.ORDER=l.ORDER,t.CHANNELS=[t.X,t.Y,t.ROW,t.COLUMN,t.SIZE,t.SHAPE,t.COLOR,t.PATH,t.ORDER,t.TEXT,t.DETAIL,t.LABEL],t.supportMark=i,t.getSupportedMark=a,t.getSupportedRole=r,t.hasScale=o},{"./util":46}],10:[function(e,n,t){var i=e("../schema/config.schema"),a=e("../channel"),r=e("../data"),o=e("../fielddef"),u=e("../encoding"),l=e("../mark"),c=e("../type"),s=e("../util"),f=e("./config"),d=e("./stack"),p=e("./scale"),m=e("../enums"),g=e("../aggregate"),h=function(){function e(e){var n=this;this._spec=e;var t=this._spec.mark,r=this._spec.encoding=this._spec.encoding||{},o=this._config=s.mergeDeep(s.duplicate(i.defaultConfig),e.config);u.forEach(this._spec.encoding,function(e,n){a.supportMark(n,this._spec.mark)||(console.warn(n,"dropped as it is incompatible with",this._spec.mark),delete this._spec.encoding[n].field),e.type&&(e.type=c.getFullName(e.type)),n!==a.PATH&&n!==a.ORDER||e.aggregate||e.type!==c.QUANTITATIVE||(e.aggregate=g.AggregateOp.MIN)},this);var h=this._scale=[a.X,a.Y,a.COLOR,a.SHAPE,a.SIZE,a.ROW,a.COLUMN].reduce(function(e,i){if(u.has(r,i)){var c=r[i].scale||{},f=r[i],d=p.scaleType(c,f,i,t);s.contains([a.ROW,a.COLUMN],i)?e[i]=s.extend({type:d,round:o.facet.scale.round,padding:i===a.ROW&&n.has(a.Y)||i===a.COLUMN&&n.has(a.X)?o.facet.scale.padding:0},c):e[i]=s.extend({type:d,round:o.scale.round,padding:o.scale.padding,useRawDomain:o.scale.useRawDomain,bandSize:i===a.X&&d===m.ScaleType.ORDINAL&&t===l.TEXT?o.scale.textBandWidth:o.scale.bandSize},c)}return e},{});this._axis=[a.X,a.Y,a.ROW,a.COLUMN].reduce(function(e,n){if(u.has(r,n)){var t=r[n].axis;t!==!1&&(e[n]=s.extend({},n===a.X||n===a.Y?o.axis:o.facet.axis,t===!0?{}:t||{}))}return e},{}),this._legend=[a.COLOR,a.SHAPE,a.SIZE].reduce(function(e,n){if(u.has(r,n)){var t=r[n].legend;t!==!1&&(e[n]=s.extend({},o.legend,t===!0?{}:t||{}))}return e},{}),this._stack=d.compileStackProperties(t,r,h,o),this._config.mark=f.compileMarkConfig(t,r,o,this._stack)}return e.prototype.stack=function(){return this._stack},e.prototype.toSpec=function(e,n){var t,i=s.duplicate(this._spec.encoding);return t={mark:this._spec.mark,encoding:i},e||(t.config=s.duplicate(this._spec.config)),n||(t.data=s.duplicate(this._spec.data)),t},e.prototype.cellWidth=function(){return(this.isFacet()?this.config().facet.cell.width:null)||this.config().cell.width},e.prototype.cellHeight=function(){return(this.isFacet()?this.config().facet.cell.height:null)||this.config().cell.height},e.prototype.mark=function(){return this._spec.mark},e.prototype.spec=function(){return this._spec},e.prototype.is=function(e){return this._spec.mark===e},e.prototype.has=function(e){return u.has(this._spec.encoding,e)},e.prototype.encoding=function(){return this._spec.encoding},e.prototype.fieldDef=function(e){return this._spec.encoding[e]||{}},e.prototype.field=function(e,n){void 0===n&&(n={});var t=this.fieldDef(e),i=this.scale(e);return t.bin&&(n=s.extend({binSuffix:p.scaleType(i,t,e,this.mark())===m.ScaleType.ORDINAL?"_range":"_start"},n)),o.field(t,n)},e.prototype.fieldTitle=function(e){return o.title(this._spec.encoding[e])},e.prototype.channels=function(){return u.channels(this._spec.encoding)},e.prototype.map=function(e,n){return u.map(this._spec.encoding,e,n)},e.prototype.reduce=function(e,n,t){return u.reduce(this._spec.encoding,e,n,t)},e.prototype.forEach=function(e,n){u.forEach(this._spec.encoding,e,n)},e.prototype.isOrdinalScale=function(e){var n=this.fieldDef(e),t=this.scale(e);return this.has(e)&&p.scaleType(t,n,e,this.mark())===m.ScaleType.ORDINAL},e.prototype.isDimension=function(e){return o.isDimension(this.fieldDef(e))},e.prototype.isMeasure=function(e){return o.isMeasure(this.fieldDef(e))},e.prototype.isAggregate=function(){return u.isAggregate(this._spec.encoding)},e.prototype.isFacet=function(){return this.has(a.ROW)||this.has(a.COLUMN)},e.prototype.dataTable=function(){return this.isAggregate()?r.SUMMARY:r.SOURCE},e.prototype.data=function(){return this._spec.data},e.prototype.transform=function(){return this._spec.transform||{}},e.prototype.config=function(){return this._config},e.prototype.sort=function(e){return this._spec.encoding[e].sort},e.prototype.scale=function(e){return this._scale[e]},e.prototype.axis=function(e){return this._axis[e]},e.prototype.legend=function(e){return this._legend[e]},e.prototype.scaleName=function(e){var n=this.spec().name;return(n?n+"-":"")+e},e.prototype.sizeValue=function(e){void 0===e&&(e=a.SIZE);var n=this.fieldDef(a.SIZE);if(n&&void 0!==n.value)return n.value;var t=this.config().scale;switch(this.mark()){case l.TEXT:return this.config().mark.fontSize;case l.BAR:return this.config().mark.barSize?this.config().mark.barSize:this.isOrdinalScale(e)?this.scale(e).bandSize-1:this.has(e)?this.config().mark.barThinSize:t.bandSize-1;case l.TICK:if(this.config().mark.tickSize)return this.config().mark.tickSize;var i=this.has(e)?this.scale(e).bandSize:t.bandSize;return i/1.5}return this.config().mark.size},e}();t.Model=h},{"../aggregate":7,"../channel":9,"../data":29,"../encoding":30,"../enums":31,"../fielddef":32,"../mark":33,"../schema/config.schema":38,"../type":45,"../util":46,"./config":13,"./scale":25,"./stack":26}],11:[function(e,n,t){function i(e,n){var i=e===g.COLUMN,a=e===g.ROW,r=i?"x":a?"y":e,o={type:r,scale:n.scaleName(e),grid:!0,tickSize:0,properties:{labels:{text:{value:""}},axis:{stroke:{value:"transparent"}}}},u=n.axis(e);return["layer","ticks","values","subdivide"].forEach(function(i){var a,r=(a=t[i])?a(n,e,o):u[i];void 0!==r&&(o[i]=r)}),o}function a(e,n){var i=e===g.COLUMN,a=e===g.ROW,r=i?"x":a?"y":e,o=n.axis(e),u={type:r,scale:n.scaleName(e)};p.extend(u,O.formatMixins(n,e,n.axis(e).format)),["grid","layer","offset","orient","tickSize","ticks","title","tickPadding","tickSize","tickSizeMajor","tickSizeMinor","tickSizeEnd","titleOffset","values","subdivide"].forEach(function(i){var a,r=(a=t[i])?a(n,e,u):o[i];void 0!==r&&(u[i]=r)});var l=n.axis(e).properties||{};return["axis","labels","grid","title","ticks","majorTicks","minorTicks"].forEach(function(t){var i=T[t]?T[t](n,e,l[t]||{},u):l[t];void 0!==i&&(u.properties=u.properties||{},u.properties[t]=i)}),u}function r(e,n){return e.axis(n).offset}function o(e,n){var t=e.axis(n).grid;return void 0!==t?t:!e.isOrdinalScale(n)&&!e.fieldDef(n).bin}function u(e,n){return n!==g.ROW&&n!==g.COLUMN?o(e,n)&&(n===g.Y||n===g.X)&&!(e.has(g.COLUMN)||e.has(g.ROW)):void 0}function l(e,n,t){var i=e.axis(n).layer;return void 0!==i?i:t.grid?"back":void 0}function c(e,n){var t=e.axis(n).orient;return t?t:n===g.COLUMN?h.AxisOrient.TOP:n===g.ROW&&e.has(g.Y)&&e.axis(g.Y).orient!==h.AxisOrient.RIGHT?h.AxisOrient.RIGHT:void 0}function s(e,n){var t=e.axis(n).ticks;return void 0!==t?t:n!==g.X||e.fieldDef(n).bin?void 0:5}function f(e,n){var t=e.axis(n).tickSize;return void 0!==t?t:void 0}function d(e,n){var t=e.axis(n);if(void 0!==t.title)return t.title;var i,a=e.fieldTitle(n);return t.titleMaxLength?i=t.titleMaxLength:n!==g.X||e.isOrdinalScale(g.X)?n!==g.Y||e.isOrdinalScale(g.Y)||(i=e.cellHeight()/e.axis(g.Y).characterWidth):i=e.cellWidth()/e.axis(g.X).characterWidth,i?p.truncate(a,i):a}var p=e("../util"),m=e("../type"),g=e("../channel"),h=e("../enums"),O=e("./util");t.compileInnerAxis=i,t.compileAxis=a,t.offset=r,t.gridShow=o,t.grid=u,t.layer=l,t.orient=c,t.ticks=s,t.tickSize=f,t.title=d;var T;!function(e){function n(e,n,t,i){var a=e.axis(n);return p.extend(void 0!==a.axisWidth?{strokeWidth:{value:a.axisWidth}}:{},t||{})}function t(e,n,t,i){var a=e.fieldDef(n),r=e.axis(n);return r.labels?(p.contains([m.NOMINAL,m.ORDINAL],a.type)&&r.labelMaxLength&&(t=p.extend({text:{template:"{{ datum.data | truncate:"+r.labelMaxLength+"}}"}},t||{})),void 0!==r.labelAngle?t.angle={value:r.labelAngle}:n!==g.X||!e.isDimension(g.X)&&a.type!==m.TEMPORAL?n===g.ROW&&e.has(g.X)&&(t.angle={value:"left"===i.orient?270:90}):t.angle={value:270},void 0!==r.labelAlign?t.align={value:r.labelAlign}:t.angle&&(270===t.angle.value?t.align={value:"top"===i.orient?"left":"x"===i.type?"right":"center"}:90===t.angle.value&&(t.align={value:"center"})),void 0!==r.labelBaseline?t.baseline={value:r.labelBaseline}:t.angle&&(270===t.angle.value?t.baseline={value:"x"===i.type?"middle":"bottom"}:90===t.angle.value&&(t.baseline={value:"bottom"})),t||void 0):p.extend({text:""},t)}e.axis=n,e.labels=t}(T=t.properties||(t.properties={}))},{"../channel":9,"../enums":31,"../type":45,"../util":46,"./util":28}],12:[function(e,n,t){function i(e){var n=new r.Model(e),t=n.config(),i=m.extend(e.name?{name:e.name}:{},{width:1,height:1,padding:"auto"},t.viewport?{viewport:t.viewport}:{},t.background?{background:t.background}:{},{data:u.compileData(n).concat([l.compileLayoutData(n)]),marks:[a(n)]});return{spec:i}}function a(e){var n=e.spec(),t=m.extend({name:n.name?n.name+"-root":"root",type:"group"},n.description?{description:n.description}:{},{from:{data:g.LAYOUT},properties:{update:{width:{field:"width"},height:{field:"height"}}}}),i=f.compileMark(e);if(e.has(h.ROW)||e.has(h.COLUMN))m.extend(t,c.facetMixins(e,i));else{p.applyConfig(t.properties.update,e.config().cell,p.FILL_STROKE_CONFIG.concat(["clip"])),t.marks=i,t.scales=d.compileScales(e.channels(),e);var a=(e.has(h.X)&&e.axis(h.X)?[o.compileAxis(h.X,e)]:[]).concat(e.has(h.Y)&&e.axis(h.Y)?[o.compileAxis(h.Y,e)]:[]);a.length>0&&(t.axes=a)}var r=s.compileLegends(e);return r.length>0&&(t.legends=r),t}var r=e("./Model"),o=e("./axis"),u=e("./data"),l=e("./layout"),c=e("./facet"),s=e("./legend"),f=e("./mark"),d=e("./scale"),p=e("./util"),m=e("../util"),g=e("../data"),h=e("../channel"),O=e("./Model");t.Model=O.Model,t.compile=i,t.compileRootGroup=a},{"../channel":9,"../data":29,"../util":46,"./Model":10,"./axis":11,"./data":14,"./facet":15,"./layout":16,"./legend":17,"./mark":24,"./scale":25,"./util":28}],13:[function(e,n,t){function i(e,n,t,i){return l.extend(["filled","opacity","orient","align"].reduce(function(c,s){var f=t.mark[s];switch(s){case"filled":void 0===f&&(c[s]=e!==u.POINT&&e!==u.LINE);break;case"opacity":void 0===f&&l.contains([u.POINT,u.TICK,u.CIRCLE,u.SQUARE],e)&&(r.isAggregate(n)&&!r.has(n,a.DETAIL)||(c[s]=.7));break;case"orient":i&&(c[s]=i.groupbyChannel===a.Y?"horizontal":void 0),void 0===f&&(c[s]=o.isMeasure(n[a.X])&&!o.isMeasure(n[a.Y])?"horizontal":void 0);break;case"align":void 0===f&&(c[s]=r.has(n,a.X)?"center":"right")}return c},{}),t.mark)}var a=e("../channel"),r=e("../encoding"),o=e("../fielddef"),u=e("../mark"),l=e("../util");t.compileMarkConfig=i},{"../channel":9,"../encoding":30,"../fielddef":32,"../mark":33,"../util":46}],14:[function(e,n,t){function i(e){var n=[T.def(e)],t=E.def(e);t&&n.push(t),a(n[n.length-1],e),r(n[n.length-1],e);var i=e.stack();return i&&n.push(y.def(e,i)),n.concat(v.defs(e))}function a(e,n){n.has(s.COLOR)&&n.fieldDef(s.COLOR).type===p.ORDINAL&&(e.transform=e.transform.concat([{type:"sort",by:n.field(s.COLOR)},{type:"rank",field:n.field(s.COLOR),output:{rank:n.field(s.COLOR,{prefn:"rank_"})}}]))}function r(e,n){n.forEach(function(t,i){var a=n.scale(i);a&&a.type===l.ScaleType.LOG&&e.transform.push({type:"filter",test:n.field(i,{datum:!0})+" > 0"})})}var o=e("../fielddef"),u=e("../util"),l=e("../enums"),c=e("../bin"),s=e("../channel"),f=e("../data"),d=e("../fielddef"),p=e("../type"),m=e("./scale"),g=e("./time"),h=e("../aggregate"),O={nominal:!1,ordinal:!1,quantitative:!0,temporal:!0};t.compileData=i;var T;!function(e){function n(e){var n={name:f.SOURCE},a=e.data();if(a)if(a.values&&a.values.length>0)n.values=e.data().values,n.format={type:"json"};else if(a.url){n.url=a.url;var r=/(?:\.([^.]+))?$/.exec(n.url)[1];u.contains(["json","csv","tsv"],r)||(r="json"),n.format={type:e.data().formatType||r}}var o=t(e);return o&&(n.format=n.format||{},n.format.parse=o),n.transform=i(e),n}function t(e){var n,t=(e.transform().calculate||[]).reduce(function(e,n){return e[n.field]=!0,e},{});return e.forEach(function(e){if(e.type===p.TEMPORAL)n=n||{},n[e.field]="date";else if(e.type===p.QUANTITATIVE){if(o.isCount(e)||t[e.field])return;n=n||{},n[e.field]="number"}}),n}function i(e){return h(e).concat(E(e),T(e),r(e),a(e))}function a(e){return e.reduce(function(e,n,t){var i=d.field(n,{nofn:!0,datum:!0});return n.type===p.TEMPORAL&&n.timeUnit&&e.push({type:"formula",field:d.field(n),expr:g.parseExpression(n.timeUnit,i)}),e},[])}function r(e){return e.reduce(function(n,t,i){var a=e.fieldDef(i).bin,r=e.scale(i);if(a){var o=u.extend({type:"bin",field:t.field,output:{start:d.field(t,{binSuffix:"_start"}),mid:d.field(t,{binSuffix:"_mid"}),end:d.field(t,{binSuffix:"_end"})}},"boolean"==typeof a?{}:a);o.maxbins||o.step||(o.maxbins=c.autoMaxBins(i)),n.push(o),m.scaleType(r,t,i,e.mark())!==l.ScaleType.ORDINAL&&i!==s.COLOR||n.push({type:"formula",field:d.field(t,{binSuffix:"_range"}),expr:d.field(t,{datum:!0,binSuffix:"_start"})+" + '-' + "+d.field(t,{datum:!0,binSuffix:"_end"})})}return n},[])}function h(e){var n=e.transform().filterNull,t=u.keys(e.reduce(function(e,t){
return(n||void 0===n&&t.field&&"*"!==t.field&&O[t.type])&&(e[t.field]=!0),e},{}));return t.length>0?[{type:"filter",test:t.map(function(e){return"datum."+e+"!==null"}).join(" && ")}]:[]}function T(e){var n=e.transform().filter;return n?[{type:"filter",test:n}]:[]}function E(e){return(e.transform().calculate||[]).reduce(function(e,n){return e.push(u.extend({type:"formula"},n)),e},[])}e.def=n,e.transform=i,e.timeTransform=a,e.binTransform=r,e.nullFilterTransform=h,e.filterTransform=T,e.formulaTransform=E}(T=t.source||(t.source={}));var E;!function(e){function n(e){var n={},t={},i=!1;e.forEach(function(a,r){if(a.aggregate)i=!0,a.aggregate===h.AggregateOp.COUNT?(t["*"]=t["*"]||{},t["*"].count=!0):(t[a.field]=t[a.field]||{},t[a.field][a.aggregate]=!0);else if(a.bin){n[d.field(a,{binSuffix:"_start"})]=d.field(a,{binSuffix:"_start"}),n[d.field(a,{binSuffix:"_mid"})]=d.field(a,{binSuffix:"_mid"}),n[d.field(a,{binSuffix:"_end"})]=d.field(a,{binSuffix:"_end"});var o=e.scale(r);m.scaleType(o,a,r,e.mark())===l.ScaleType.ORDINAL&&(n[d.field(a,{binSuffix:"_range"})]=d.field(a,{binSuffix:"_range"}))}else n[d.field(a)]=d.field(a)});var a=u.vals(n),r=u.reduce(t,function(e,n,t){return e[t]=u.keys(n),e},{});return i?{name:f.SUMMARY,source:f.SOURCE,transform:[{type:"aggregate",groupby:a,summarize:r}]}:null}e.def=n}(E=t.summary||(t.summary={}));var y;!function(e){function n(e,n){var t=n.groupbyChannel,i=n.fieldChannel,a=(e.has(s.COLUMN)?[e.field(s.COLUMN)]:[]).concat(e.has(s.ROW)?[e.field(s.ROW)]:[]),r={name:f.STACKED_SCALE,source:e.dataTable(),transform:[{type:"aggregate",groupby:[e.field(t)].concat(a),summarize:[{ops:["sum"],field:e.field(i)}]}]};return r}e.def=n}(y=t.stack||(t.stack={}));var v;!function(e){function n(e){var n={};return e.reduce(function(e,t,i){if(t.timeUnit){var a=g.rawDomain(t.timeUnit,i);a&&!n[t.timeUnit]&&(n[t.timeUnit]=!0,e.push({name:t.timeUnit,values:a,transform:[{type:"formula",field:"date",expr:g.parseExpression(t.timeUnit,"datum.data",!0)}]}))}return e},[])}e.defs=n}(v=t.dates||(t.dates={})),t.rankTransform=a,t.filterNonPositiveForLog=r},{"../aggregate":7,"../bin":8,"../channel":9,"../data":29,"../enums":31,"../fielddef":32,"../type":45,"../util":46,"./scale":25,"./time":27}],15:[function(e,n,t){function i(e,n){var t=e.has(m.ROW),i=e.has(m.COLUMN);return e.has(m.ROW)&&!e.isDimension(m.ROW)&&d.error("Row encoding should be ordinal."),e.has(m.COLUMN)&&!e.isDimension(m.COLUMN)&&d.error("Col encoding should be ordinal."),{marks:[].concat(u(e),[r(e,n)]),scales:h.compileScales(e.channels(),e),axes:[].concat(t&&e.axis(m.ROW)?[g.compileAxis(m.ROW,e)]:[],i&&e.axis(m.COLUMN)?[g.compileAxis(m.COLUMN,e)]:[])}}function a(e){var n=[];return e.has(m.X)&&e.axis(m.X)&&g.gridShow(e,m.X)&&n.push(g.compileInnerAxis(m.X,e)),e.has(m.Y)&&e.axis(m.Y)&&g.gridShow(e,m.Y)&&n.push(g.compileInnerAxis(m.Y,e)),n}function r(e,n){var t=e.spec().name,i={name:(t?t+"-":"")+"cell",type:"group",from:{data:e.dataTable(),transform:[{type:"facet",groupby:[].concat(e.has(m.ROW)?[e.field(m.ROW)]:[],e.has(m.COLUMN)?[e.field(m.COLUMN)]:[])}]},properties:{update:o(e)},marks:n},r=a(e);return r.length>0&&(i.axes=r),i}function o(e){var n={x:e.has(m.COLUMN)?{scale:e.scaleName(m.COLUMN),field:e.field(m.COLUMN),offset:e.scale(m.COLUMN).padding/2}:{value:e.config().facet.scale.padding/2},y:e.has(m.ROW)?{scale:e.scaleName(m.ROW),field:e.field(m.ROW),offset:e.scale(m.ROW).padding/2}:{value:e.config().facet.scale.padding/2},width:{field:{parent:"cellWidth"}},height:{field:{parent:"cellHeight"}}};return O.applyConfig(n,e.config().cell,O.FILL_STROKE_CONFIG.concat(["clip"])),O.applyConfig(n,e.config().facet.cell,O.FILL_STROKE_CONFIG.concat(["clip"])),n}function u(e){var n=[];return e.has(m.X)?e.axis(m.X)&&n.push(l(e)):e.has(m.ROW)&&n.push.apply(n,s(e)),e.has(m.Y)?e.axis(m.Y)&&n.push(c(e)):e.has(m.COLUMN)&&n.push.apply(n,f(e)),n}function l(e){var n=e.has(m.COLUMN),t=e.spec().name;return p.extend({name:(t?t+"-":"")+"x-axes",type:"group"},n?{from:{data:e.dataTable(),transform:[{type:"aggregate",groupby:[e.field(m.COLUMN)],summarize:{"*":"count"}}]}}:{},{properties:{update:{width:{field:{parent:"cellWidth"}},height:{field:{group:"height"}},x:n?{scale:e.scaleName(m.COLUMN),field:e.field(m.COLUMN),offset:e.scale(m.COLUMN).padding/2}:{value:e.config().facet.scale.padding/2}}}},e.axis(m.X)?{axes:[g.compileAxis(m.X,e)]}:{})}function c(e){var n=e.has(m.ROW),t=e.spec().name;return p.extend({name:(t?t+"-":"")+"y-axes",type:"group"},n?{from:{data:e.dataTable(),transform:[{type:"aggregate",groupby:[e.field(m.ROW)],summarize:{"*":"count"}}]}}:{},{properties:{update:{width:{field:{group:"width"}},height:{field:{parent:"cellHeight"}},y:n?{scale:e.scaleName(m.ROW),field:e.field(m.ROW),offset:e.scale(m.ROW).padding/2}:{value:e.config().facet.scale.padding/2}}}},e.axis(m.Y)?{axes:[g.compileAxis(m.Y,e)]}:{})}function s(e){var n=e.spec().name,t=e.config().facet.grid,i={name:(n?n+"-":"")+"row-grid",type:"rule",from:{data:e.dataTable(),transform:[{type:"facet",groupby:[e.field(m.ROW)]}]},properties:{update:{y:{scale:e.scaleName(m.ROW),field:e.field(m.ROW)},x:{value:0,offset:-t.offset},x2:{field:{group:"width"},offset:t.offset},stroke:{value:t.color},strokeOpacity:{value:t.opacity},strokeWidth:{value:.5}}}};return[i,{name:(n?n+"-":"")+"row-grid-end",type:"rule",properties:{update:{y:{field:{group:"height"}},x:{value:0,offset:-t.offset},x2:{field:{group:"width"},offset:t.offset},stroke:{value:t.color},strokeOpacity:{value:t.opacity},strokeWidth:{value:.5}}}}]}function f(e){var n=e.spec().name,t=e.config().facet.grid,i={name:(n?n+"-":"")+"column-grid",type:"rule",from:{data:e.dataTable(),transform:[{type:"facet",groupby:[e.field(m.COLUMN)]}]},properties:{update:{x:{scale:e.scaleName(m.COLUMN),field:e.field(m.COLUMN)},y:{value:0,offset:-t.offset},y2:{field:{group:"height"},offset:t.offset},stroke:{value:t.color},strokeOpacity:{value:t.opacity},strokeWidth:{value:.5}}}};return[i,{name:(n?n+"-":"")+"column-grid-end",type:"rule",properties:{update:{x:{field:{group:"width"}},y:{value:0,offset:-t.offset},y2:{field:{group:"height"},offset:t.offset},stroke:{value:t.color},strokeOpacity:{value:t.opacity},strokeWidth:{value:.5}}}}]}var d=e("../util"),p=e("../util"),m=e("../channel"),g=e("./axis"),h=e("./scale"),O=e("./util");t.facetMixins=i},{"../channel":9,"../util":46,"./axis":11,"./scale":25,"./util":28}],16:[function(e,n,t){function i(e){var n=[u.X,u.Y,u.ROW,u.COLUMN].reduce(function(n,t){if(e.has(t)&&e.isOrdinalScale(t)){var i=e.scale(t);i.domain instanceof Array||n.push({field:e.field(t),ops:["distinct"]})}return n},[]),t=r(e,u.X,e.cellWidth()),i=r(e,u.Y,e.cellHeight()),a=e.has(u.COLUMN)||e.has(u.ROW),c=[{type:"formula",field:"cellWidth",expr:t},{type:"formula",field:"cellHeight",expr:i},{type:"formula",field:"width",expr:a?o(e,u.COLUMN,"datum.cellWidth"):t},{type:"formula",field:"height",expr:a?o(e,u.ROW,"datum.cellHeight"):i}];return n.length>0?{name:l.LAYOUT,source:e.dataTable(),transform:[].concat([{type:"aggregate",summarize:n}],c)}:{name:l.LAYOUT,values:[{}],transform:c}}function a(e,n){var t=e.scale(n);if(t.domain instanceof Array)return t.domain.length;var i=e.fieldDef(n).timeUnit,a=i?s.rawDomain(i,n):null;return null!==a?a.length:e.field(n,{datum:!0,prefn:"distinct_"})}function r(e,n,t){if(e.has(n)){if(e.isOrdinalScale(n)){var i=e.scale(n);return"("+a(e,n)+" + "+i.padding+") * "+i.bandSize}return t+""}return e.mark()===c.TEXT&&n===u.X?e.config().scale.textBandWidth+"":e.config().scale.bandSize+""}function o(e,n,t){var i=e.scale(n);if(e.has(n)){var a=i.domain instanceof Array?i.domain.length:e.field(n,{datum:!0,prefn:"distinct_"});return"("+t+" + "+i.padding+") * "+a}return t+" + "+e.config().facet.scale.padding}var u=e("../channel"),l=e("../data"),c=e("../mark"),s=e("./time");t.compileLayoutData=i},{"../channel":9,"../data":29,"../mark":33,"./time":27}],17:[function(e,n,t){function i(e){var n=[];if(e.has(l.COLOR)&&e.legend(l.COLOR)){var t=e.fieldDef(l.COLOR),i=u(t)?m.COLOR_LEGEND:e.scaleName(l.COLOR);n.push(a(e,l.COLOR,e.config().mark.filled?{fill:i}:{stroke:i}))}return e.has(l.SIZE)&&e.legend(l.SIZE)&&n.push(a(e,l.SIZE,{size:e.scaleName(l.SIZE)})),e.has(l.SHAPE)&&e.legend(l.SHAPE)&&n.push(a(e,l.SHAPE,{shape:e.scaleName(l.SHAPE)})),n}function a(e,n,t){var i=e.fieldDef(n),a=e.legend(n);t.title=r(a,i),f.extend(t,o(a,e,n)),["orient","values"].forEach(function(e){var n=a[e];void 0!==n&&(t[e]=n)});var u="boolean"!=typeof a&&a.properties||{};return["title","symbols","legend","labels"].forEach(function(a){var r=g[a]?g[a](i,u[a],e,n):u[a];void 0!==r&&(t.properties=t.properties||{},t.properties[a]=r)}),t}function r(e,n){return"boolean"!=typeof e&&e.title?e.title:c.title(n)}function o(e,n,t){var i=n.fieldDef(t);return i.bin?{}:d.formatMixins(n,t,"boolean"!=typeof e?e.format:void 0)}function u(e){return e.type===p.ORDINAL||e.bin||e.timeUnit}var l=e("../channel"),c=e("../fielddef"),s=e("../mark"),f=e("../util"),d=e("./util"),p=e("../type"),m=e("./scale");t.compileLegends=i,t.compileLegend=a,t.title=r,t.formatMixins=o,t.useColorLegendScale=u;var g;!function(e){function n(e,n,t,i){var a={},r=t.mark();switch(r){case s.BAR:case s.TICK:case s.TEXT:a.shape={value:"square"};break;case s.CIRCLE:case s.SQUARE:a.shape={value:r};break;case s.POINT:case s.LINE:case s.AREA:}var o=t.config().mark.filled;d.applyMarkConfig(a,t,f.without(d.FILL_STROKE_CONFIG,[o?"fill":"stroke"])),o&&(a.strokeWidth={value:0});var c;return t.has(l.COLOR)&&i===l.COLOR?u(e)&&(c={scale:t.scaleName(l.COLOR),field:"data"}):t.fieldDef(l.COLOR).value&&(c={value:t.fieldDef(l.COLOR).value}),void 0!==c?o?a.fill=c:a.stroke=c:i!==l.COLOR&&(a[o?"fill":"stroke"]=a[o?"fill":"stroke"]||{value:t.config().mark.color}),a=f.extend(a,n||{}),f.keys(a).length>0?a:void 0}function t(e,n,t,i){if(i===l.COLOR){if(e.type===p.ORDINAL)return{text:{scale:m.COLOR_LEGEND,field:"data"}};if(e.bin)return{text:{scale:m.COLOR_LEGEND_LABEL,field:"data"}};if(e.timeUnit)return{text:{template:"{{ datum.data | time:'"+d.timeFormat(t,i)+"'}}"}}}}e.symbols=n,e.labels=t}(g||(g={}))},{"../channel":9,"../fielddef":32,"../mark":33,"../type":45,"../util":46,"./scale":25,"./util":28}],18:[function(e,n,t){var i,a=e("../channel"),r=e("./util");!function(e){function n(){return"area"}function t(e){var n={},t=e.config().mark.orient;void 0!==t&&(n.orient={value:t});var i=e.stack();return i&&a.X===i.fieldChannel?n.x={scale:e.scaleName(a.X),field:e.field(a.X,{suffix:"_start"})}:e.isMeasure(a.X)?n.x={scale:e.scaleName(a.X),field:e.field(a.X)}:e.isDimension(a.X)&&(n.x={scale:e.scaleName(a.X),field:e.field(a.X,{binSuffix:"_mid"})}),"horizontal"===t&&(i&&a.X===i.fieldChannel?n.x2={scale:e.scaleName(a.X),field:e.field(a.X,{suffix:"_end"})}:n.x2={scale:e.scaleName(a.X),value:0}),i&&a.Y===i.fieldChannel?n.y={scale:e.scaleName(a.Y),field:e.field(a.Y,{suffix:"_start"})}:e.isMeasure(a.Y)?n.y={scale:e.scaleName(a.Y),field:e.field(a.Y)}:e.isDimension(a.Y)&&(n.y={scale:e.scaleName(a.Y),field:e.field(a.Y,{binSuffix:"_mid"})}),"horizontal"!==t&&(i&&a.Y===i.fieldChannel?n.y2={scale:e.scaleName(a.Y),field:e.field(a.Y,{suffix:"_end"})}:n.y2={scale:e.scaleName(a.Y),value:0}),r.applyColorAndOpacity(n,e),r.applyMarkConfig(n,e,["interpolate","tension"]),n}function i(e){}e.markType=n,e.properties=t,e.labels=i}(i=t.area||(t.area={}))},{"../channel":9,"./util":28}],19:[function(e,n,t){var i,a=e("../channel"),r=e("./util");!function(e){function n(){return"rect"}function t(e){var n={},t=e.config().mark.orient,i=e.stack();return i&&a.X===i.fieldChannel?(n.x={scale:e.scaleName(a.X),field:e.field(a.X,{suffix:"_start"})},n.x2={scale:e.scaleName(a.X),field:e.field(a.X,{suffix:"_end"})}):e.isMeasure(a.X)?"horizontal"===t?(n.x={scale:e.scaleName(a.X),field:e.field(a.X)},n.x2={scale:e.scaleName(a.X),value:0}):(n.xc={scale:e.scaleName(a.X),field:e.field(a.X)},n.width={value:e.sizeValue(a.X)}):e.fieldDef(a.X).bin?e.has(a.SIZE)&&"horizontal"!==t?(n.xc={scale:e.scaleName(a.X),field:e.field(a.X,{binSuffix:"_mid"})},n.width={scale:e.scaleName(a.SIZE),field:e.field(a.SIZE)}):(n.x={scale:e.scaleName(a.X),field:e.field(a.X,{binSuffix:"_start"}),offset:1},n.x2={scale:e.scaleName(a.X),field:e.field(a.X,{binSuffix:"_end"})}):(e.has(a.X)?n.xc={scale:e.scaleName(a.X),field:e.field(a.X)}:n.x={value:0,offset:2},n.width=e.has(a.SIZE)&&"horizontal"!==t?{scale:e.scaleName(a.SIZE),field:e.field(a.SIZE)}:{value:e.sizeValue(a.X)}),i&&a.Y===i.fieldChannel?(n.y={scale:e.scaleName(a.Y),field:e.field(a.Y,{suffix:"_start"})},n.y2={scale:e.scaleName(a.Y),field:e.field(a.Y,{suffix:"_end"})}):e.isMeasure(a.Y)?"horizontal"!==t?(n.y={scale:e.scaleName(a.Y),field:e.field(a.Y)},n.y2={scale:e.scaleName(a.Y),value:0}):(n.yc={scale:e.scaleName(a.Y),field:e.field(a.Y)},n.height={value:e.sizeValue(a.Y)}):e.fieldDef(a.Y).bin?e.has(a.SIZE)&&"horizontal"===t?(n.yc={scale:e.scaleName(a.Y),field:e.field(a.Y,{binSuffix:"_mid"})},n.height={scale:e.scaleName(a.SIZE),field:e.field(a.SIZE)}):(n.y={scale:e.scaleName(a.Y),field:e.field(a.Y,{binSuffix:"_start"})},n.y2={scale:e.scaleName(a.Y),field:e.field(a.Y,{binSuffix:"_end"}),offset:1}):(e.has(a.Y)?n.yc={scale:e.scaleName(a.Y),field:e.field(a.Y)}:n.y2={field:{group:"height"},offset:-1},n.height=e.has(a.SIZE)&&"horizontal"===t?{scale:e.scaleName(a.SIZE),field:e.field(a.SIZE)}:{value:e.sizeValue(a.Y)}),r.applyColorAndOpacity(n,e),n}function i(e){}e.markType=n,e.properties=t,e.labels=i}(i=t.bar||(t.bar={}))},{"../channel":9,"./util":28}],20:[function(e,n,t){var i,a=e("../channel"),r=e("./util");!function(e){function n(){return"line"}function t(e){var n={};return e.has(a.X)?n.x={scale:e.scaleName(a.X),field:e.field(a.X,{binSuffix:"_mid"})}:n.x={value:0},e.has(a.Y)?n.y={scale:e.scaleName(a.Y),field:e.field(a.Y,{binSuffix:"_mid"})}:n.y={field:{group:"height"}},r.applyColorAndOpacity(n,e),r.applyMarkConfig(n,e,["interpolate","tension"]),n}function i(e){}e.markType=n,e.properties=t,e.labels=i}(i=t.line||(t.line={}))},{"../channel":9,"./util":28}],21:[function(e,n,t){var i,a=e("../channel"),r=e("./util");!function(e){function n(){return"symbol"}function t(e,n){var t={};return e.has(a.X)?t.x={scale:e.scaleName(a.X),field:e.field(a.X,{binSuffix:"_mid"})}:t.x={value:e.config().scale.bandSize/2},e.has(a.Y)?t.y={scale:e.scaleName(a.Y),field:e.field(a.Y,{binSuffix:"_mid"})}:t.y={value:e.config().scale.bandSize/2},e.has(a.SIZE)?t.size={scale:e.scaleName(a.SIZE),field:e.field(a.SIZE)}:t.size={value:e.sizeValue()},n?t.shape={value:n}:e.has(a.SHAPE)?t.shape={scale:e.scaleName(a.SHAPE),field:e.field(a.SHAPE)}:e.fieldDef(a.SHAPE).value?t.shape={value:e.fieldDef(a.SHAPE).value}:e.config().mark.shape&&(t.shape={value:e.config().mark.shape}),r.applyColorAndOpacity(t,e),t}function i(e){}e.markType=n,e.properties=t,e.labels=i}(i=t.point||(t.point={}));var o;!function(e){function n(){return"symbol"}function t(e){return i.properties(e,"circle")}function a(e){}e.markType=n,e.properties=t,e.labels=a}(o=t.circle||(t.circle={}));var u;!function(e){function n(){return"symbol"}function t(e){return i.properties(e,"square")}function a(e){}e.markType=n,e.properties=t,e.labels=a}(u=t.square||(t.square={}))},{"../channel":9,"./util":28}],22:[function(e,n,t){var i,a=e("../channel"),r=e("./util"),o=e("../util"),u=e("../type");!function(e){function n(){return"text"}function t(e){return{x:{value:0},y:{value:0},width:{field:{group:"width"}},height:{field:{group:"height"}},fill:{scale:e.scaleName(a.COLOR),field:e.field(a.COLOR,e.fieldDef(a.COLOR).type===u.ORDINAL?{prefn:"rank_"}:{})}}}function i(e){var n={};r.applyMarkConfig(n,e,["angle","align","baseline","dx","dy","font","fontWeight","fontStyle","radius","theta","text"]);var t=e.fieldDef(a.TEXT);if(e.has(a.X)?n.x={scale:e.scaleName(a.X),field:e.field(a.X,{binSuffix:"_mid"})}:e.has(a.TEXT)&&e.fieldDef(a.TEXT).type===u.QUANTITATIVE?n.x={field:{group:"width"},offset:-5}:n.x={value:e.config().scale.textBandWidth/2},e.has(a.Y)?n.y={scale:e.scaleName(a.Y),field:e.field(a.Y,{binSuffix:"_mid"})}:n.y={value:e.config().scale.bandSize/2},e.has(a.SIZE)?n.fontSize={scale:e.scaleName(a.SIZE),field:e.field(a.SIZE)}:n.fontSize={value:e.sizeValue()},!e.config().mark.applyColorToBackground||e.has(a.X)||e.has(a.Y))r.applyColorAndOpacity(n,e);else{n.fill={value:"black"};var i=e.config().mark.opacity;i&&(n.opacity={value:i})}if(e.has(a.TEXT))if(o.contains([u.QUANTITATIVE,u.TEMPORAL],e.fieldDef(a.TEXT).type)){var l=e.config().mark.format;o.extend(n,r.formatMixins(e,a.TEXT,l))}else n.text={field:e.field(a.TEXT)};else t.value&&(n.text={value:t.value});return n}e.markType=n,e.background=t,e.properties=i}(i=t.text||(t.text={}))},{"../channel":9,"../type":45,"../util":46,"./util":28}],23:[function(e,n,t){var i,a=e("../channel"),r=e("./util");!function(e){function n(){return"rect"}function t(e){var n={};return e.has(a.X)?n.xc={scale:e.scaleName(a.X),field:e.field(a.X,{binSuffix:"_mid"})}:n.xc={value:e.config().scale.bandSize/2},e.has(a.Y)?n.yc={scale:e.scaleName(a.Y),field:e.field(a.Y,{binSuffix:"_mid"})}:n.yc={value:e.config().scale.bandSize/2},"horizontal"===e.config().mark.orient?(n.width={value:e.config().mark.tickThickness},n.height=e.has(a.SIZE)?{scale:e.scaleName(a.SIZE),field:e.field(a.SIZE)}:{value:e.sizeValue(a.Y)}):(n.width=e.has(a.SIZE)?{scale:e.scaleName(a.SIZE),field:e.field(a.SIZE)}:{value:e.sizeValue(a.X)},n.height={value:e.config().mark.tickThickness}),r.applyColorAndOpacity(n,e),n}function i(e){}e.markType=n,e.properties=t,e.labels=i}(i=t.tick||(t.tick={}))},{"../channel":9,"./util":28}],24:[function(e,n,t){function i(e){return d.contains([s.LINE,s.AREA],e.mark())?a(e):r(e)}function a(e){var n=e.mark(),t=e.spec().name,i=e.has(c.ROW)||e.has(c.COLUMN),a={data:e.dataTable()},r=l(e),p=[d.extend(t?{name:t+"-marks"}:{},{type:y[n].markType(),from:d.extend(i||r.length>0?{}:a,{transform:[{type:"sort",by:u(e)}]}),properties:{update:y[n].properties(e)}})];if(r.length>0){var m={type:"facet",groupby:r},g=n===s.AREA&&e.stack()?[f.imputeTransform(e),f.stackTransform(e),m]:[].concat(m,e.has(c.ORDER)?[{type:"sort",by:o(e)}]:[]);return[{name:(t?t+"-":"")+n+"-facet",type:"group",from:d.extend(i?{}:a,{transform:g}),properties:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:p}]}return p}function r(e){var n=e.mark(),t=e.spec().name,i=e.has(c.ROW)||e.has(c.COLUMN),a={data:e.dataTable()},r=[];if(n===s.TEXT&&e.has(c.COLOR)&&e.config().mark.applyColorToBackground&&!e.has(c.X)&&!e.has(c.Y)&&r.push(d.extend(t?{name:t+"-background"}:{},{type:"rect"},i?{}:{from:a},{properties:{update:O.text.background(e)}})),r.push(d.extend(t?{name:t+"-marks"}:{},{type:y[n].markType()},!i||e.stack()||e.has(c.ORDER)?{from:d.extend(i?{}:a,e.stack()?{transform:[f.stackTransform(e)]}:e.has(c.ORDER)?{transform:[{type:"sort",by:o(e)}]}:{})}:{},{properties:{update:y[n].properties(e)}})),e.has(c.LABEL)&&y[n].labels){var u=y[n].labels(e);void 0!==u&&r.push(d.extend(t?{name:t+"-label"}:{},{type:"text"},i?{}:{from:a},{properties:{update:u}}))}return r}function o(e){if(e.has(c.ORDER)){var n=e.encoding().order;return n instanceof Array?n.map(E.sortField):E.sortField(n)}return null}function u(e){if(e.mark()===s.LINE&&e.has(c.PATH)){var n=e.encoding().path;return n instanceof Array?n.map(E.sortField):E.sortField(n)}return"-"+e.field("horizontal"===e.config().mark.orient?c.Y:c.X)}function l(e){return[c.COLOR,c.DETAIL,c.SHAPE].reduce(function(n,t){return e.has(t)&&!e.fieldDef(t).aggregate&&n.push(e.field(t)),n},[])}var c=e("../channel"),s=e("../mark"),f=e("./stack"),d=e("../util"),p=e("./mark-area"),m=e("./mark-bar"),g=e("./mark-line"),h=e("./mark-point"),O=e("./mark-text"),T=e("./mark-tick"),E=e("./util"),y={area:p.area,bar:m.bar,line:g.line,point:h.point,text:O.text,tick:T.tick,circle:h.circle,square:h.square};t.compileMark=i},{"../channel":9,"../mark":33,"../util":46,"./mark-area":18,"./mark-bar":19,"./mark-line":20,"./mark-point":21,"./mark-text":22,"./mark-tick":23,"./stack":26,"./util":28}],25:[function(e,n,t){function i(e,n){return e.filter(v.hasScale).reduce(function(e,t){var i=n.fieldDef(t);return t===v.COLOR&&n.legend(v.COLOR)&&(i.type===S.ORDINAL||i.bin||i.timeUnit)&&(e.push(r(n,i)),i.bin&&e.push(o(n,i))),e.push(a(n,i,t)),e},[])}function a(e,n,i){var a=e.scale(i),r=e.sort(i),o={name:e.scaleName(i),type:u(a,n,i,e.mark())};return o.domain=l(a,e,i,o.type),E.extend(o,f(a,e,i,o.type)),r&&"descending"===("string"==typeof r?r:r.order)&&(o.reverse=!0),["round","clamp","nice","exponent","zero","padding","points"].forEach(function(e){var r=t[e](a[e],o.type,i,n);void 0!==r&&(o[e]=r)}),o}function r(e,n){return{name:t.COLOR_LEGEND,type:"ordinal",domain:{data:e.dataTable(),field:e.field(v.COLOR,n.bin||n.timeUnit?{}:{prefn:"rank_"}),sort:!0},range:{data:e.dataTable(),field:e.field(v.COLOR),sort:!0}}}function o(e,n){return{name:t.COLOR_LEGEND_LABEL,type:"ordinal",domain:{data:e.dataTable(),field:e.field(v.COLOR,{prefn:"rank_"}),sort:!0},range:{data:e.dataTable(),field:L.field(n,{binSuffix:"_range"}),sort:{field:e.field(v.COLOR,{binSuffix:"_start"}),op:"min"}}}}function u(e,n,t,i){if(!v.hasScale(t))return null;if(E.contains([v.ROW,v.COLUMN,v.SHAPE],t))return M.ScaleType.ORDINAL;if(void 0!==e.type)return e.type;switch(n.type){case S.NOMINAL:return M.ScaleType.ORDINAL;case S.ORDINAL:return t===v.COLOR?M.ScaleType.LINEAR:M.ScaleType.ORDINAL;case S.TEMPORAL:if(t===v.COLOR)return M.ScaleType.TIME;if(n.timeUnit)switch(n.timeUnit){case C.TimeUnit.HOURS:case C.TimeUnit.DAY:case C.TimeUnit.MONTH:return M.ScaleType.ORDINAL;default:return M.ScaleType.TIME}return M.ScaleType.TIME;case S.QUANTITATIVE:return n.bin?E.contains([v.X,v.Y,v.COLOR],t)?M.ScaleType.LINEAR:M.ScaleType.ORDINAL:M.ScaleType.LINEAR}return null}function l(e,n,t,i){var a=n.fieldDef(t);if(e.domain)return e.domain;if(a.type===S.TEMPORAL)return R.rawDomain(a.timeUnit,t)?{data:a.timeUnit,field:"date"}:{data:n.dataTable(),field:n.field(t),sort:{field:n.field(t),op:"min"}};var r=n.stack();if(r&&t===r.fieldChannel)return r.offset===M.StackOffset.NORMALIZE?[0,1]:{data:A.STACKED_SCALE,field:n.field(t,{prefn:"sum_"})};var o=s(e,n,t,i),u=c(n,t,i);return o?{data:A.SOURCE,field:n.field(t,{noAggregate:!0})}:a.bin?"ordinal"===i?{data:n.dataTable(),field:n.field(t,{binSuffix:"_range"}),sort:{field:n.field(t,{binSuffix:"_start"}),op:"min"}}:t===v.COLOR?{data:n.dataTable(),field:n.field(t,{binSuffix:"_start"})}:{data:n.dataTable(),field:[n.field(t,{binSuffix:"_start"}),n.field(t,{binSuffix:"_end"})]}:u?{data:u.op?A.SOURCE:n.dataTable(),field:a.type===S.ORDINAL&&t===v.COLOR?n.field(t,{prefn:"rank_"}):n.field(t),sort:u}:{data:n.dataTable(),field:a.type===S.ORDINAL&&t===v.COLOR?n.field(t,{prefn:"rank_"}):n.field(t)}}function c(e,n,t){if("ordinal"===t){var i=e.sort(n);return E.contains(["ascending","descending",void 0],i)?!0:"string"!=typeof i?{op:i.op,field:i.field}:void 0}}function s(e,n,t,i){var a=n.fieldDef(t);return e.useRawDomain&&a.aggregate&&y.SHARED_DOMAIN_OPS.indexOf(a.aggregate)>=0&&(a.type===S.QUANTITATIVE&&!a.bin||a.type===S.TEMPORAL&&E.contains(["time","utc"],i))}function f(e,n,t,i){var a=n.fieldDef(t),r=n.config().scale;if("ordinal"===i&&e.bandSize&&E.contains([v.X,v.Y],t))return{bandSize:e.bandSize};if(e.range&&!E.contains([v.X,v.Y,v.ROW,v.COLUMN],t))return{range:e.range};switch(t){case v.X:return{rangeMin:0,rangeMax:n.cellWidth()};case v.Y:return{rangeMin:n.cellHeight(),rangeMax:0};case v.SIZE:if(n.is(N.BAR)){if(void 0!==r.barSizeRange)return{range:r.barSizeRange};var o="horizontal"===n.config().mark.orient?v.Y:v.X;return{range:[n.config().mark.barThinSize,n.scale(o).bandSize]}}if(n.is(N.TEXT))return{range:r.fontSizeRange};if(void 0!==r.pointSizeRange)return{range:r.pointSizeRange};var u=n.isMeasure(v.X),l=n.isMeasure(v.Y),c=u!==l?n.scale(u?v.Y:v.X).bandSize:Math.min(n.scale(v.X).bandSize||r.bandSize,n.scale(v.Y).bandSize||r.bandSize);return{range:[9,(c-2)*(c-2)]};case v.SHAPE:return{range:r.shapeRange};case v.COLOR:return a.type===S.NOMINAL?{range:r.nominalColorRange}:{range:r.sequentialColorRange};case v.ROW:return{range:"height"};case v.COLUMN:return{range:"width"}}return{}}function d(e,n){return E.contains(["linear","pow","sqrt","log","time","utc"],n)?e:void 0}function p(e,n){return"pow"===n?e:void 0}function m(e,n,t,i){return E.contains(["linear","pow","sqrt","log","time","utc","quantize"],n)?void 0!==e?e:E.contains(["time","utc"],n)?R.smallestUnit(i.timeUnit):E.contains([v.X,v.Y],t):void 0}function g(e,n,t){return"ordinal"===n&&E.contains([v.X,v.Y],t)?e:void 0}function h(e,n,t){return"ordinal"===n&&E.contains([v.X,v.Y],t)?!0:void 0}function O(e,n,t){return E.contains([v.X,v.Y,v.ROW,v.COLUMN,v.SIZE],t)&&void 0!==e?e:void 0}function T(e,n,t,i){return E.contains(["time","utc","ordinal"],n)?void 0:void 0!==e?e:!i.bin&&E.contains([v.X,v.Y],t)}var E=e("../util"),y=e("../aggregate"),v=e("../channel"),A=e("../data"),S=e("../type"),N=e("../mark"),R=e("./time"),M=e("../enums"),C=e("../timeunit"),L=e("../fielddef");t.COLOR_LEGEND="color_legend",t.COLOR_LEGEND_LABEL="color_legend_label",t.compileScales=i,t.scaleType=u,t.domain=l,t.domainSort=c,t.rangeMixins=f,t.clamp=d,t.exponent=p,t.nice=m,t.padding=g,t.points=h,t.round=O,t.zero=T},{"../aggregate":7,"../channel":9,"../data":29,"../enums":31,"../fielddef":32,"../mark":33,"../timeunit":44,"../type":45,"../util":46,"./time":27}],26:[function(e,n,t){function i(e,n,t,i){var r=a(e,n,t);if(r.length>0&&d.contains([c.BAR,c.AREA],e)&&i.mark.stacked!==l.StackOffset.NONE&&f.isAggregate(n)){var o=f.has(n,u.X)&&s.isMeasure(n.x),p=f.has(n,u.Y)&&s.isMeasure(n.y);if(o&&!p)return{groupbyChannel:u.Y,fieldChannel:u.X,stackFields:r,offset:i.mark.stacked};if(p&&!o)return{groupbyChannel:u.X,fieldChannel:u.Y,stackFields:r,offset:i.mark.stacked}}return null}function a(e,n,t){return[u.COLOR,u.DETAIL].reduce(function(i,a){var r=n[a];if(f.has(n,a))if(d.isArray(r))r.forEach(function(e){i.push(s.field(e))});else{var o=r;i.push(s.field(o,{binSuffix:m.scaleType(t[a],o,a,e)===l.ScaleType.ORDINAL?"_range":"_start"}))}return i},[])}function r(e){var n=e.stack();return{type:"impute",field:e.field(n.fieldChannel),groupby:n.stackFields,orderby:[e.field(n.groupbyChannel)],method:"value",value:0}}function o(e){var n=e.stack(),t=e.encoding(),i=e.has(u.ORDER)?(d.isArray(t[u.ORDER])?t[u.ORDER]:[t[u.ORDER]]).map(p.sortField):n.stackFields.map(function(e){return"-"+e}),a=e.field(n.fieldChannel),r={type:"stack",groupby:[e.field(n.groupbyChannel)],field:e.field(n.fieldChannel),sortby:i,output:{start:a+"_start",end:a+"_end"}};return n.offset&&(r.offset=n.offset),r}var u=e("../channel"),l=e("../enums"),c=e("../mark"),s=e("../fielddef"),f=e("../encoding"),d=e("../util"),p=e("./util"),m=e("./scale");t.compileStackProperties=i,t.imputeTransform=r,t.stackTransform=o},{"../channel":9,"../encoding":30,"../enums":31,"../fielddef":32,"../mark":33,"../util":46,"./scale":25,"./util":28}],27:[function(e,n,t){function i(e,n){if(void 0===n&&(n=!1),e){var t=e.toString(),i=[];t.indexOf("year")>-1&&i.push(n?"%y":"%Y"),t.indexOf("month")>-1&&i.push(n?"%b":"%B"),t.indexOf("day")>-1?i.push(n?"%a":"%A"):t.indexOf("date")>-1&&i.push("%d");var a=[];t.indexOf("hour")>-1&&a.push("%H"),t.indexOf("minute")>-1&&a.push("%M"),t.indexOf("second")>-1&&a.push("%S"),t.indexOf("milliseconds")>-1&&a.push("%L");var r=[];return i.length>0&&r.push(i.join("-")),a.length>0&&r.push(a.join(":")),r.length>0?r.join(" "):void 0}}function a(e){return e?e.indexOf("second")>-1?"second":e.indexOf("minute")>-1?"minute":e.indexOf("hour")>-1?"hour":e.indexOf("day")>-1||e.indexOf("date")>-1?"day":e.indexOf("month")>-1?"month":e.indexOf("year")>-1?"year":void 0:void 0}function r(e,n,t){function i(e,i){return void 0===i&&(i=!0),t?n+(i?", ":""):e+"("+n+")"+(i?", ":"")}void 0===t&&(t=!1);var a="datetime(",r=e.toString();return a+=r.indexOf("year")>-1?i("year"):"2006, ",a+=r.indexOf("month")>-1?i("month"):"0, ",a+=r.indexOf("day")>-1?i("day",!1)+"+1, ":r.indexOf("date")>-1?i("date"):"1, ",a+=r.indexOf("hours")>-1?i("hours"):"0, ",a+=r.indexOf("minutes")>-1?i("minutes"):"0, ",a+=r.indexOf("seconds")>-1?i("seconds"):"0, ",a+=r.indexOf("milliseconds")>-1?i("milliseconds",!1):"0",a+")"}function o(e,n){if(u.contains([l.ROW,l.COLUMN,l.SHAPE,l.COLOR],n))return null;switch(e){case c.TimeUnit.SECONDS:return u.range(0,60);case c.TimeUnit.MINUTES:return u.range(0,60);case c.TimeUnit.HOURS:return u.range(0,24);case c.TimeUnit.DAY:return u.range(0,7);case c.TimeUnit.DATE:return u.range(1,32);case c.TimeUnit.MONTH:return u.range(0,12)}return null}var u=e("../util"),l=e("../channel"),c=e("../timeunit");t.format=i,t.smallestUnit=a,t.parseExpression=r,t.rawDomain=o},{"../channel":9,"../timeunit":44,"../util":46}],28:[function(e,n,t){function i(e,n){var i=n.config().mark.filled,a=n.fieldDef(s.COLOR);r(e,n,t.FILL_STROKE_CONFIG);var o;n.has(s.COLOR)?o={scale:n.scaleName(s.COLOR),field:n.field(s.COLOR,a.type===d.ORDINAL?{prefn:"rank_"}:{})}:a&&a.value&&(o={value:a.value}),void 0!==o?i?e.fill=o:e.stroke=o:e[i?"fill":"stroke"]=e[i?"fill":"stroke"]||{value:n.config().mark.color}}function a(e,n,t){t.forEach(function(t){var i=n[t];void 0!==i&&(e[t]={value:i})})}function r(e,n,t){a(e,n.config().mark,t)}function o(e,n,t){var i=e.fieldDef(n);if(!m.contains([d.QUANTITATIVE,d.TEMPORAL],i.type))return{};var a={};if(i.type===d.TEMPORAL&&(a.formatType="time"),void 0!==t)a.format=t;else switch(i.type){case d.QUANTITATIVE:a.format=e.config().numberFormat;break;case d.TEMPORAL:a.format=c(e,n)||e.config().timeFormat}if(n===s.TEXT){var r=(a.formatType||"number")+(a.format?":'"+a.format+"'":"");return{text:{template:"{{"+e.field(n,{datum:!0})+" | "+r+"}}"}}}return a}function u(e,n,t){switch(n){case s.ROW:case s.COLUMN:case s.X:case s.Y:return e.axis(n).shortTimeLabels;case s.COLOR:case s.SHAPE:case s.SIZE:return e.legend(n).shortTimeLabels;case s.TEXT:return e.config().mark.shortTimeLabels;case s.LABEL:}return!1}function l(e){return(e.sort===g.SortOrder.DESCENDING?"-":"")+f.field(e)}function c(e,n){var t=e.fieldDef(n);return p.format(t.timeUnit,u(e,n,t))}var s=e("../channel"),f=e("../fielddef"),d=e("../type"),p=e("./time"),m=e("../util"),g=e("../enums");t.FILL_STROKE_CONFIG=["fill","fillOpacity","stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","opacity"],t.applyColorAndOpacity=i,t.applyConfig=a,t.applyMarkConfig=r,t.formatMixins=o,t.sortField=l,t.timeFormat=c},{"../channel":9,"../enums":31,"../fielddef":32,"../type":45,"../util":46,"./time":27}],29:[function(e,n,t){var i=e("./type");t.SUMMARY="summary",t.SOURCE="source",t.STACKED_SCALE="stacked_scale",t.LAYOUT="layout",t.types={"boolean":i.NOMINAL,number:i.QUANTITATIVE,integer:i.QUANTITATIVE,date:i.TEMPORAL,string:i.NOMINAL}},{"./type":45}],30:[function(e,n,t){function i(e){var n=0;return e.color&&n++,e.size&&n++,e.shape&&n++,n}function a(e){return f.CHANNELS.filter(function(n){return r(e,n)})}function r(e,n){var t=e&&e[n];return t&&(void 0!==t.field||d.isArray(t)&&t.length>0)}function o(e){return d.any(f.CHANNELS,function(n){return!(!r(e,n)||!e[n].aggregate)})}function u(e){var n=[];return f.CHANNELS.forEach(function(t){r(e,t)&&(d.isArray(e[t])?e[t].forEach(function(e){n.push(e)}):n.push(e[t]))}),n}function l(e,n,t){var i=0;f.CHANNELS.forEach(function(a){r(e,a)&&(d.isArray(e[a])?e[a].forEach(function(e){n.call(t,e,a,i++)}):n.call(t,e[a],a,i++))})}function c(e,n,t){var i=[];return f.CHANNELS.forEach(function(a){r(e,a)&&(d.isArray(e[a])?e[a].forEach(function(r){i.push(n.call(t,r,a,e))}):i.push(n.call(t,e[a],a,e)))}),i}function s(e,n,t,i){var a=t;return f.CHANNELS.forEach(function(t){r(e,t)&&(d.isArray(e[t])?e[t].forEach(function(r){a=n.call(i,a,r,t,e)}):a=n.call(i,a,e[t],t,e))}),a}var f=e("./channel"),d=e("./util");t.countRetinal=i,t.channels=a,t.has=r,t.isAggregate=o,t.fieldDefs=u,t.forEach=l,t.map=c,t.reduce=s},{"./channel":9,"./util":46}],31:[function(e,n,t){!function(e){e[e.ASCENDING="ascending"]="ASCENDING",e[e.DESCENDING="descending"]="DESCENDING",e[e.NONE="none"]="NONE"}(t.SortOrder||(t.SortOrder={}));t.SortOrder;!function(e){e[e.LINEAR="linear"]="LINEAR",e[e.LOG="log"]="LOG",e[e.POW="pow"]="POW",e[e.SQRT="sqrt"]="SQRT",e[e.QUANTILE="quantile"]="QUANTILE",e[e.ORDINAL="ordinal"]="ORDINAL",e[e.TIME="time"]="TIME";
}(t.ScaleType||(t.ScaleType={}));t.ScaleType;!function(e){e[e.SECOND="second"]="SECOND",e[e.MINUTE="minute"]="MINUTE",e[e.HOUR="hour"]="HOUR",e[e.DAY="day"]="DAY",e[e.WEEK="week"]="WEEK",e[e.MONTH="month"]="MONTH",e[e.YEAR="year"]="YEAR"}(t.NiceTime||(t.NiceTime={}));t.NiceTime;!function(e){e[e.JSON="json"]="JSON",e[e.CSV="csv"]="CSV",e[e.TSV="tsv"]="TSV"}(t.DataFormat||(t.DataFormat={}));t.DataFormat;!function(e){e[e.TOP="top"]="TOP",e[e.RIGHT="right"]="RIGHT",e[e.LEFT="left"]="LEFT",e[e.BOTTOM="bottom"]="BOTTOM"}(t.AxisOrient||(t.AxisOrient={}));t.AxisOrient;!function(e){e[e.NORMAL="normal"]="NORMAL",e[e.BOLD="bold"]="BOLD"}(t.FontWeight||(t.FontWeight={}));t.FontWeight;!function(e){e[e.CIRCLE="circle"]="CIRCLE",e[e.SQUARE="square"]="SQUARE",e[e.CROSS="cross"]="CROSS",e[e.DIAMOND="diamond"]="DIAMOND",e[e.TRIANGLEUP="triangle-up"]="TRIANGLEUP",e[e.TRIANGLEDOWN="triangle-down"]="TRIANGLEDOWN"}(t.Shape||(t.Shape={}));t.Shape;!function(e){e[e.LEFT="left"]="LEFT",e[e.RIGHT="right"]="RIGHT",e[e.CENTER="center"]="CENTER"}(t.HorizontalAlign||(t.HorizontalAlign={}));t.HorizontalAlign;!function(e){e[e.TOP="top"]="TOP",e[e.MIDDLE="middle"]="MIDDLE",e[e.BOTTOM="bottom"]="BOTTOM"}(t.VerticalAlign||(t.VerticalAlign={}));t.VerticalAlign;!function(e){e[e.NORMAL="normal"]="NORMAL",e[e.ITALIC="italic"]="ITALIC"}(t.FontStyle||(t.FontStyle={}));t.FontStyle;!function(e){e[e.ZERO="zero"]="ZERO",e[e.CENTER="center"]="CENTER",e[e.NORMALIZE="normalize"]="NORMALIZE",e[e.NONE="none"]="NONE"}(t.StackOffset||(t.StackOffset={}));t.StackOffset},{}],32:[function(e,n,t){function i(e,n){void 0===n&&(n={});var t=(n.datum?"datum.":"")+(n.prefn||""),i=n.suffix||"",a=e.field;return l(e)?t+"count"+i:n.fn?t+n.fn+"_"+a+i:!n.nofn&&e.bin?t+"bin_"+a+(n.binSuffix||i||"_start"):n.nofn||n.noAggregate||!e.aggregate?!n.nofn&&e.timeUnit?t+e.timeUnit+"_"+a+i:t+a:t+e.aggregate+"_"+a+i}function a(e){return f.contains([d.NOMINAL,d.ORDINAL],e.type)||!!e.bin||e.type===d.TEMPORAL&&!!e.timeUnit}function r(e){return e&&e.field&&a(e)}function o(e){return e&&e.field&&!a(e)}function u(){return{field:"*",aggregate:m.AggregateOp.COUNT,type:d.QUANTITATIVE,displayName:t.COUNT_DISPLAYNAME}}function l(e){return e.aggregate===m.AggregateOp.COUNT}function c(e,n,t){void 0===t&&(t={});var i=n[e.field],a=e.type;if(e.bin){var r=e.bin,o="boolean"==typeof r?void 0:r.maxbins;void 0===o&&(o=10);var u=f.getbins(i,o);return(u.stop-u.start)/u.step}if(a===d.TEMPORAL){var l=e.timeUnit;switch(l){case p.TimeUnit.SECONDS:return 60;case p.TimeUnit.MINUTES:return 60;case p.TimeUnit.HOURS:return 24;case p.TimeUnit.DAY:return 7;case p.TimeUnit.DATE:return 31;case p.TimeUnit.MONTH:return 12;case p.TimeUnit.YEAR:var c=n["year_"+e.field];return c?c.distinct-(i.missing>0&&t[a]?1:0):null}}return e.aggregate?1:i.distinct-(i.missing>0&&t[a]?1:0)}function s(e){if(l(e))return t.COUNT_DISPLAYNAME;var n=e.aggregate||e.timeUnit||e.bin&&"bin";return n?n.toString().toUpperCase()+"("+e.field+")":e.field}var f=e("./util"),d=e("./type"),p=e("./timeunit"),m=e("./aggregate");t.field=i,t.isDimension=r,t.isMeasure=o,t.COUNT_DISPLAYNAME="Number of Records",t.count=u,t.isCount=l,t.cardinality=c,t.title=s},{"./aggregate":7,"./timeunit":44,"./type":45,"./util":46}],33:[function(e,n,t){!function(e){e[e.AREA="area"]="AREA",e[e.BAR="bar"]="BAR",e[e.LINE="line"]="LINE",e[e.POINT="point"]="POINT",e[e.TEXT="text"]="TEXT",e[e.TICK="tick"]="TICK",e[e.CIRCLE="circle"]="CIRCLE",e[e.SQUARE="square"]="SQUARE"}(t.Mark||(t.Mark={}));var i=t.Mark;t.AREA=i.AREA,t.BAR=i.BAR,t.LINE=i.LINE,t.POINT=i.POINT,t.TEXT=i.TEXT,t.TICK=i.TICK,t.CIRCLE=i.CIRCLE,t.SQUARE=i.SQUARE},{}],34:[function(e,n,t){t.defaultAxisConfig={offset:void 0,grid:void 0,labels:!0,labelMaxLength:25,tickSize:void 0,characterWidth:6},t.defaultFacetAxisConfig={axisWidth:0,labels:!0,grid:!1,tickSize:0}},{}],35:[function(e,n,t){t.defaultCellConfig={width:200,height:200},t.defaultFacetCellConfig={stroke:"#ccc",strokeWidth:1}},{}],36:[function(e,n,t){var i=e("./scale.schema"),a=e("./axis.schema"),r=e("./config.cell.schema"),o={color:"#000000",opacity:.4,offset:0};t.defaultFacetConfig={scale:i.defaultFacetScaleConfig,axis:a.defaultFacetAxisConfig,grid:o,cell:r.defaultFacetCellConfig}},{"./axis.schema":34,"./config.cell.schema":35,"./scale.schema":40}],37:[function(e,n,t){var i=e("../enums");t.defaultMarkConfig={color:"#4682b4",strokeWidth:2,size:30,barThinSize:2,tickThickness:1,fontSize:10,baseline:i.VerticalAlign.MIDDLE,text:"Abc",shortTimeLabels:!1,applyColorToBackground:!1}},{"../enums":31}],38:[function(e,n,t){var i=e("./config.cell.schema"),a=e("./config.facet.schema"),r=e("./config.mark.schema"),o=e("./scale.schema"),u=e("./axis.schema"),l=e("./legend.schema");t.defaultConfig={numberFormat:"s",timeFormat:"%Y-%m-%d",cell:i.defaultCellConfig,mark:r.defaultMarkConfig,scale:o.defaultScaleConfig,axis:u.defaultAxisConfig,legend:l.defaultLegendConfig,facet:a.defaultFacetConfig}},{"./axis.schema":34,"./config.cell.schema":35,"./config.facet.schema":36,"./config.mark.schema":37,"./legend.schema":39,"./scale.schema":40}],39:[function(e,n,t){t.defaultLegendConfig={orient:void 0,shortTimeLabels:!1}},{}],40:[function(e,n,t){t.defaultScaleConfig={round:!0,textBandWidth:90,bandSize:21,padding:1,useRawDomain:!1,nominalColorRange:"category10",sequentialColorRange:["#AFC6A3","#09622A"],shapeRange:"shapes",fontSizeRange:[8,40]},t.defaultFacetScaleConfig={round:!0,padding:16}},{}],41:[function(e,n,t){},{}],42:[function(e,n,t){function i(e){return"mark"+t.ASSIGN+e.mark+t.DELIM+r(e.encoding)}function a(e,n,i){var a=e.split(t.DELIM),r=a.shift().split(t.ASSIGN)[1].trim(),u=o(a.join(t.DELIM)),l={mark:m.Mark[r],encoding:u};return void 0!==n&&(l.data=n),void 0!==i&&(l.config=i),l}function r(e){return p.map(e,function(e,n){return n+t.ASSIGN+u(e)}).join(t.DELIM)}function o(e){return e.split(t.DELIM).reduce(function(e,n){var i=n.split(t.ASSIGN),a=i[0].trim(),r=i[1];return e[a]=c(r),e},{})}function u(e){return(e.aggregate?e.aggregate+t.FUNC:"")+(e.timeUnit?e.timeUnit+t.FUNC:"")+(e.bin?"bin"+t.FUNC:"")+(e.field||"")+t.TYPE+d.SHORT_TYPE[e.type]}function l(e,n){return void 0===n&&(n=t.DELIM),e.map(u).join(n)}function c(e){for(var n=e.split(t.TYPE),i={field:n[0].trim(),type:d.TYPE_FROM_SHORT_TYPE[n[1].trim()]},a=0;a<s.AGGREGATE_OPS.length;a++){var r=s.AGGREGATE_OPS[a];if(0===i.field.indexOf(r+"_")){i.field=i.field.substr(r.toString().length+1),r===s.AggregateOp.COUNT&&0===i.field.length&&(i.field="*"),i.aggregate=r;break}}for(var a=0;a<f.TIMEUNITS.length;a++){var o=f.TIMEUNITS[a];if(i.field&&0===i.field.indexOf(o+"_")){i.field=i.field.substr(i.field.length+1),i.timeUnit=o;break}}return i.field&&0===i.field.indexOf("bin_")&&(i.field=i.field.substr(4),i.bin=!0),i}var s=e("./aggregate"),f=e("./timeunit"),d=e("./type"),p=e("./encoding"),m=e("./mark");t.DELIM="|",t.ASSIGN="=",t.TYPE=",",t.FUNC="_",t.shorten=i,t.parse=a,t.shortenEncoding=r,t.parseEncoding=o,t.shortenFieldDef=u,t.shortenFieldDefs=l,t.parseFieldDef=c},{"./aggregate":7,"./encoding":30,"./mark":33,"./timeunit":44,"./type":45}],43:[function(e,n,t){function i(e){return s.isAggregate(e.encoding)}function a(e){return s.fieldDefs(e.encoding)}function r(e){return new l.Model(e).toSpec(!0)}function o(e){return(s.has(e.encoding,c.COLOR)||s.has(e.encoding,c.SHAPE))&&(e.mark===f.BAR||e.mark===f.AREA)&&(!e.config||!e.config.mark.stacked!=!1)&&s.isAggregate(e.encoding)}function u(e){var n=e.encoding,t=d.duplicate(e.encoding);return t.x=n.y,t.y=n.x,t.row=n.column,t.column=n.row,e.encoding=t,e}var l=e("./compile/Model"),c=e("./channel"),s=e("./encoding"),f=e("./mark"),d=e("./util");t.alwaysNoOcclusion=i,t.fieldDefs=a,t.getCleanSpec=r,t.isStack=o,t.transpose=u},{"./channel":9,"./compile/Model":10,"./encoding":30,"./mark":33,"./util":46}],44:[function(e,n,t){!function(e){e[e.YEAR="year"]="YEAR",e[e.MONTH="month"]="MONTH",e[e.DAY="day"]="DAY",e[e.DATE="date"]="DATE",e[e.HOURS="hours"]="HOURS",e[e.MINUTES="minutes"]="MINUTES",e[e.SECONDS="seconds"]="SECONDS",e[e.MILLISECONDS="milliseconds"]="MILLISECONDS",e[e.YEARMONTH="yearmonth"]="YEARMONTH",e[e.YEARMONTHDAY="yearmonthday"]="YEARMONTHDAY",e[e.YEARMONTHDATE="yearmonthdate"]="YEARMONTHDATE",e[e.YEARDAY="yearday"]="YEARDAY",e[e.YEARDATE="yeardate"]="YEARDATE",e[e.YEARMONTHDAYHOURS="yearmonthdayhours"]="YEARMONTHDAYHOURS",e[e.YEARMONTHDAYHOURSMINUTES="yearmonthdayhoursminutes"]="YEARMONTHDAYHOURSMINUTES",e[e.HOURSMINUTES="hoursminutes"]="HOURSMINUTES",e[e.HOURSMINUTESSECONDS="hoursminutesseconds"]="HOURSMINUTESSECONDS",e[e.MINUTESSECONDS="minutesseconds"]="MINUTESSECONDS",e[e.SECONDSMILLISECONDS="secondsmilliseconds"]="SECONDSMILLISECONDS"}(t.TimeUnit||(t.TimeUnit={}));var i=t.TimeUnit;t.TIMEUNITS=[i.YEAR,i.MONTH,i.DAY,i.DATE,i.HOURS,i.MINUTES,i.SECONDS,i.MILLISECONDS,i.YEARMONTH,i.YEARMONTHDAY,i.YEARMONTHDATE,i.YEARDAY,i.YEARDATE,i.YEARMONTHDAYHOURS,i.YEARMONTHDAYHOURSMINUTES,i.HOURSMINUTES,i.HOURSMINUTESSECONDS,i.MINUTESSECONDS,i.SECONDSMILLISECONDS]},{}],45:[function(e,n,t){function i(e){var n=e;return t.TYPE_FROM_SHORT_TYPE[n.toUpperCase()]||n.toLowerCase()}!function(e){e[e.QUANTITATIVE="quantitative"]="QUANTITATIVE",e[e.ORDINAL="ordinal"]="ORDINAL",e[e.TEMPORAL="temporal"]="TEMPORAL",e[e.NOMINAL="nominal"]="NOMINAL"}(t.Type||(t.Type={}));var a=t.Type;t.QUANTITATIVE=a.QUANTITATIVE,t.ORDINAL=a.ORDINAL,t.TEMPORAL=a.TEMPORAL,t.NOMINAL=a.NOMINAL,t.SHORT_TYPE={quantitative:"Q",temporal:"T",nominal:"N",ordinal:"O"},t.TYPE_FROM_SHORT_TYPE={Q:t.QUANTITATIVE,T:t.TEMPORAL,O:t.ORDINAL,N:t.NOMINAL},t.getFullName=i},{}],46:[function(e,n,t){function i(e,n){return e.indexOf(n)>-1}function a(e,n){return e.filter(function(e){return!i(n,e)})}function r(e,n,t){if(e.forEach)e.forEach.call(t,n);else for(var i in e)e.hasOwnProperty(i)&&n.call(t,e[i],i,e)}function o(e,n,t,i){if(e.reduce)return e.reduce.call(i,n,t);for(var a in e)e.hasOwnProperty(a)&&(t=n.call(i,t,e[a],a,e));return t}function u(e,n,t){if(e.map)return e.map.call(t,n);var i=[];for(var a in e)e.hasOwnProperty(a)&&i.push(n.call(t,e[a],a,e));return i}function l(e,n){for(var t=0,i=0;i<e.length;i++)if(n(e[i],i,t++))return!0;return!1}function c(e,n){for(var t=0,i=0;i<e.length;i++)if(!n(e[i],i,t++))return!1;return!0}function s(e){for(var n=[],t=1;t<arguments.length;t++)n[t-1]=arguments[t];for(var i=0;i<n.length;i++)e=f(e,n[i]);return e}function f(e,n){if("object"!=typeof n||null===n)return e;for(var t in n)n.hasOwnProperty(t)&&void 0!==n[t]&&("object"!=typeof n[t]||null===n[t]?e[t]=n[t]:"object"!=typeof e[t]||null===e[t]?e[t]=s(n[t].constructor===Array?[]:{},n[t]):s(e[t],n[t]));return e}function d(e,n){return h({min:e.min,max:e.max,maxbins:n})}function p(e){console.error("[VL Error]",e)}var m=e("datalib/src/util");t.keys=m.keys,t.extend=m.extend,t.duplicate=m.duplicate,t.isArray=m.isArray,t.vals=m.vals,t.truncate=m.truncate,t.toMap=m.toMap,t.isObject=m.isObject;var g=e("datalib/src/generate");t.range=g.range,t.contains=i,t.without=a,t.forEach=r,t.reduce=o,t.map=u,t.any=l,t.all=c,t.mergeDeep=s;var h=e("datalib/src/bins/bins");t.getbins=d,t.error=p},{"datalib/src/bins/bins":3,"datalib/src/generate":4,"datalib/src/util":6}],47:[function(e,n,t){function i(e,n,i){void 0===n&&(n=t.DEFAULT_REQUIRED_CHANNEL_MAP),void 0===i&&(i=t.DEFAULT_SUPPORTED_CHANNEL_TYPE);var a=e.mark,o=e.encoding,u=n[a],l=i[a];for(var c in u)if(!(u[c]in o))return'Missing encoding channel "'+u[c]+'" for mark "'+a+'"';for(var s in o)if(!l[s])return'Encoding channel "'+s+'" is not supported by mark type "'+a+'"';return a!==r.BAR||o.x||o.y?null:"Missing both x and y for bar"}var a=e("./util"),r=e("./mark");t.DEFAULT_REQUIRED_CHANNEL_MAP={text:["text"],line:["x","y"],area:["x","y"]},t.DEFAULT_SUPPORTED_CHANNEL_TYPE={bar:a.toMap(["row","column","x","y","size","color","detail"]),line:a.toMap(["row","column","x","y","color","detail"]),area:a.toMap(["row","column","x","y","color","detail"]),tick:a.toMap(["row","column","x","y","color","detail"]),circle:a.toMap(["row","column","x","y","color","size","detail"]),square:a.toMap(["row","column","x","y","color","size","detail"]),point:a.toMap(["row","column","x","y","color","size","detail","shape"]),text:a.toMap(["row","column","size","color","text"])},t.getEncodingMappingError=i},{"./mark":33,"./util":46}],48:[function(e,n,t){var i=e("./bin"),a=e("./channel"),r=e("./data"),o=e("./encoding"),u=e("./fielddef"),l=e("./compile/compile"),c=e("./schema/schema"),s=e("./shorthand"),f=e("./spec"),d=e("./timeunit"),p=e("./type"),m=e("./validate"),g=e("./util");t.bin=i,t.channel=a,t.compile=l.compile,t.data=r,t.encoding=o,t.fieldDef=u,t.schema=c,t.shorthand=s,t.spec=f,t.timeUnit=d,t.type=p,t.util=g,t.validate=m,t.version="1.0.1"},{"./bin":8,"./channel":9,"./compile/compile":12,"./data":29,"./encoding":30,"./fielddef":32,"./schema/schema":41,"./shorthand":42,"./spec":43,"./timeunit":44,"./type":45,"./util":46,"./validate":47}]},{},[48])(48)});
//# sourceMappingURL=vega-lite.min.js.map
