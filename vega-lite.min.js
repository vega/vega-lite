!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.vl=e()}}(function(){var e;return function t(e,n,i){function r(o,u){if(!n[o]){if(!e[o]){var l="function"==typeof require&&require;if(!u&&l)return l(o,!0);if(a)return a(o,!0);var s=new Error("Cannot find module '"+o+"'");throw s.code="MODULE_NOT_FOUND",s}var f=n[o]={exports:{}};e[o][0].call(f.exports,function(t){var n=e[o][1][t];return r(n?n:t)},f,f.exports,t,e,n,i)}return n[o].exports}for(var a="function"==typeof require&&require,o=0;o<i.length;o++)r(i[o]);return r}({1:[function(e,t,n){},{}],2:[function(t,n,i){!function(t,r){"object"==typeof i&&"undefined"!=typeof n?r(i):"function"==typeof e&&e.amd?e("d3-time",["exports"],r):r(t.d3_time={})}(this,function(e){"use strict";function t(e,n,i,o){function u(t){return e(t=new Date(+t)),t}return u.floor=u,u.round=function(t){var i=new Date(+t),r=new Date(t-1);return e(i),e(r),n(r,1),r-t>t-i?i:r},u.ceil=function(t){return e(t=new Date(t-1)),n(t,1),t},u.offset=function(e,t){return n(e=new Date(+e),null==t?1:Math.floor(t)),e},u.range=function(t,i,r){var a=[];if(t=new Date(t-1),i=new Date(+i),r=null==r?1:Math.floor(r),!(i>t&&r>0))return a;for(n(t,1),e(t),i>t&&a.push(new Date(+t));n(t,r),e(t),i>t;)a.push(new Date(+t));return a},u.filter=function(i){return t(function(t){for(;e(t),!i(t);)t.setTime(t-1)},function(e,t){for(;--t>=0;)for(;n(e,1),!i(e););})},i&&(u.count=function(t,n){return r.setTime(+t),a.setTime(+n),e(r),e(a),Math.floor(i(r,a))},u.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?u.filter(o?function(t){return o(t)%e===0}:function(t){return u.count(0,t)%e===0}):u:null}),u}function n(e){return t(function(t){t.setHours(0,0,0,0),t.setDate(t.getDate()-(t.getDay()+7-e)%7)},function(e,t){e.setDate(e.getDate()+7*t)},function(e,t){return(t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/6048e5})}function i(e){return t(function(t){t.setUTCHours(0,0,0,0),t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7)},function(e,t){e.setUTCDate(e.getUTCDate()+7*t)},function(e,t){return(t-e)/6048e5})}var r=new Date,a=new Date,o=t(function(){},function(e,t){e.setTime(+e+t)},function(e,t){return t-e});o.every=function(e){return e=Math.floor(e),isFinite(e)&&e>0?e>1?t(function(t){t.setTime(Math.floor(t/e)*e)},function(t,n){t.setTime(+t+n*e)},function(t,n){return(n-t)/e}):o:null};var u=t(function(e){e.setMilliseconds(0)},function(e,t){e.setTime(+e+1e3*t)},function(e,t){return(t-e)/1e3},function(e){return e.getSeconds()}),l=t(function(e){e.setSeconds(0,0)},function(e,t){e.setTime(+e+6e4*t)},function(e,t){return(t-e)/6e4},function(e){return e.getMinutes()}),s=t(function(e){e.setMinutes(0,0,0)},function(e,t){e.setTime(+e+36e5*t)},function(e,t){return(t-e)/36e5},function(e){return e.getHours()}),f=t(function(e){e.setHours(0,0,0,0)},function(e,t){e.setDate(e.getDate()+t)},function(e,t){return(t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5},function(e){return e.getDate()-1}),c=n(0),d=n(1),p=n(2),h=n(3),m=n(4),g=n(5),y=n(6),v=t(function(e){e.setHours(0,0,0,0),e.setDate(1)},function(e,t){e.setMonth(e.getMonth()+t)},function(e,t){return t.getMonth()-e.getMonth()+12*(t.getFullYear()-e.getFullYear())},function(e){return e.getMonth()}),b=t(function(e){e.setHours(0,0,0,0),e.setMonth(0,1)},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e,t){return t.getFullYear()-e.getFullYear()},function(e){return e.getFullYear()}),O=t(function(e){e.setUTCMilliseconds(0)},function(e,t){e.setTime(+e+1e3*t)},function(e,t){return(t-e)/1e3},function(e){return e.getUTCSeconds()}),T=t(function(e){e.setUTCSeconds(0,0)},function(e,t){e.setTime(+e+6e4*t)},function(e,t){return(t-e)/6e4},function(e){return e.getUTCMinutes()}),x=t(function(e){e.setUTCMinutes(0,0,0)},function(e,t){e.setTime(+e+36e5*t)},function(e,t){return(t-e)/36e5},function(e){return e.getUTCHours()}),A=t(function(e){e.setUTCHours(0,0,0,0)},function(e,t){e.setUTCDate(e.getUTCDate()+t)},function(e,t){return(t-e)/864e5},function(e){return e.getUTCDate()-1}),M=i(0),E=i(1),D=i(2),k=i(3),C=i(4),L=i(5),S=i(6),R=t(function(e){e.setUTCHours(0,0,0,0),e.setUTCDate(1)},function(e,t){e.setUTCMonth(e.getUTCMonth()+t)},function(e,t){return t.getUTCMonth()-e.getUTCMonth()+12*(t.getUTCFullYear()-e.getUTCFullYear())},function(e){return e.getUTCMonth()}),N=t(function(e){e.setUTCHours(0,0,0,0),e.setUTCMonth(0,1)},function(e,t){e.setUTCFullYear(e.getUTCFullYear()+t)},function(e,t){return t.getUTCFullYear()-e.getUTCFullYear()},function(e){return e.getUTCFullYear()}),w=o.range,I=u.range,U=l.range,Y=s.range,_=f.range,X=c.range,P=d.range,W=p.range,$=h.range,F=m.range,H=g.range,q=y.range,z=c.range,j=v.range,V=b.range,B=o,Q=w,Z=O.range,G=T.range,K=x.range,J=A.range,ee=M.range,te=E.range,ne=D.range,ie=k.range,re=C.range,ae=L.range,oe=S.range,ue=M.range,le=R.range,se=N.range,fe="0.1.0";e.version=fe,e.milliseconds=w,e.seconds=I,e.minutes=U,e.hours=Y,e.days=_,e.sundays=X,e.mondays=P,e.tuesdays=W,e.wednesdays=$,e.thursdays=F,e.fridays=H,e.saturdays=q,e.weeks=z,e.months=j,e.years=V,e.utcMillisecond=B,e.utcMilliseconds=Q,e.utcSeconds=Z,e.utcMinutes=G,e.utcHours=K,e.utcDays=J,e.utcSundays=ee,e.utcMondays=te,e.utcTuesdays=ne,e.utcWednesdays=ie,e.utcThursdays=re,e.utcFridays=ae,e.utcSaturdays=oe,e.utcWeeks=ue,e.utcMonths=le,e.utcYears=se,e.millisecond=o,e.second=u,e.minute=l,e.hour=s,e.day=f,e.sunday=c,e.monday=d,e.tuesday=p,e.wednesday=h,e.thursday=m,e.friday=g,e.saturday=y,e.week=c,e.month=v,e.year=b,e.utcSecond=O,e.utcMinute=T,e.utcHour=x,e.utcDay=A,e.utcSunday=M,e.utcMonday=E,e.utcTuesday=D,e.utcWednesday=k,e.utcThursday=C,e.utcFriday=L,e.utcSaturday=S,e.utcWeek=M,e.utcMonth=R,e.utcYear=N,e.interval=t})},{}],3:[function(e,t,n){function i(e){if(!e)throw Error("Missing binning options.");var t,n,i,u,l,s,f,c=e.maxbins||15,d=e.base||10,p=Math.log(d),h=e.div||[5,2],m=e.min,g=e.max,y=g-m;if(e.step)t=e.step;else if(e.steps)t=e.steps[Math.min(e.steps.length-1,r(e.steps,y/c,0,e.steps.length))];else{n=Math.ceil(Math.log(c)/p),i=e.minstep||0,t=Math.max(i,Math.pow(d,Math.round(Math.log(y)/p)-n));do t*=d;while(Math.ceil(y/t)>c);for(s=0;s<h.length;++s)l=t/h[s],l>=i&&c>=y/l&&(t=l)}return l=Math.log(t),u=l>=0?0:~~(-l/p)+1,f=Math.pow(d,-u-1),m=Math.min(m,Math.floor(m/t+f)*t),g=Math.ceil(g/t)*t,{start:m,stop:g,step:t,unit:{precision:u},value:a,index:o}}function r(e,t,n,i){for(;i>n;){var r=n+i>>>1;s.cmp(e[r],t)<0?n=r+1:i=r}return n}function a(e){return this.step*Math.floor(e/this.step+c)}function o(e){return Math.floor((e-this.start)/this.step+c)}function u(e){return this.unit.date(a.call(this,e))}function l(e){return o.call(this,this.unit.unit(e))}var s=e("../util"),f=e("../time"),c=1e-15;i.date=function(e){if(!e)throw Error("Missing date binning options.");var t=e.utc?f.utc:f,n=e.min,r=e.max,a=e.maxbins||20,o=e.minbins||4,s=+r-+n,c=e.unit?t[e.unit]:t.find(s,o,a),d=i({min:null!=c.min?c.min:c.unit(n),max:null!=c.max?c.max:c.unit(r),maxbins:a,minstep:c.minstep,steps:c.step});return d.unit=c,d.index=l,e.raw||(d.value=u),d},t.exports=i},{"../time":7,"../util":8}],4:[function(e,t,n){var i=t.exports={};i.repeat=function(e,t){var n,i=Array(t);for(n=0;t>n;++n)i[n]=e;return i},i.zeros=function(e){return i.repeat(0,e)},i.range=function(e,t,n){if(arguments.length<3&&(n=1,arguments.length<2&&(t=e,e=0)),(t-e)/n==1/0)throw new Error("Infinite range");var i,r=[],a=-1;if(0>n)for(;(i=e+n*++a)>t;)r.push(i);else for(;(i=e+n*++a)<t;)r.push(i);return r},i.random={},i.random.uniform=function(e,t){void 0===t&&(t=void 0===e?1:e,e=0);var n=t-e,r=function(){return e+n*Math.random()};return r.samples=function(e){return i.zeros(e).map(r)},r.pdf=function(i){return i>=e&&t>=i?1/n:0},r.cdf=function(i){return e>i?0:i>t?1:(i-e)/n},r.icdf=function(t){return t>=0&&1>=t?e+t*n:NaN},r},i.random.integer=function(e,t){void 0===t&&(t=e,e=0);var n=t-e,r=function(){return e+Math.floor(n*Math.random())};return r.samples=function(e){return i.zeros(e).map(r)},r.pdf=function(i){return i===Math.floor(i)&&i>=e&&t>i?1/n:0},r.cdf=function(i){var r=Math.floor(i);return e>r?0:r>=t?1:(r-e+1)/n},r.icdf=function(t){return t>=0&&1>=t?e-1+Math.floor(t*n):NaN},r},i.random.normal=function(e,t){e=e||0,t=t||1;var n,r=function(){var i,r,a=0,o=0;if(void 0!==n)return a=n,n=void 0,a;do a=2*Math.random()-1,o=2*Math.random()-1,i=a*a+o*o;while(0===i||i>1);return r=Math.sqrt(-2*Math.log(i)/i),n=e+o*r*t,e+a*r*t};return r.samples=function(e){return i.zeros(e).map(r)},r.pdf=function(n){var i=Math.exp(Math.pow(n-e,2)/(-2*Math.pow(t,2)));return 1/(t*Math.sqrt(2*Math.PI))*i},r.cdf=function(n){var i,r=(n-e)/t,a=Math.abs(r);if(a>37)i=0;else{var o,u=Math.exp(-a*a/2);7.07106781186547>a?(o=.0352624965998911*a+.700383064443688,o=o*a+6.37396220353165,o=o*a+33.912866078383,o=o*a+112.079291497871,o=o*a+221.213596169931,o=o*a+220.206867912376,i=u*o,o=.0883883476483184*a+1.75566716318264,o=o*a+16.064177579207,o=o*a+86.7807322029461,o=o*a+296.564248779674,o=o*a+637.333633378831,o=o*a+793.826512519948,o=o*a+440.413735824752,i/=o):(o=a+.65,o=a+4/o,o=a+3/o,o=a+2/o,o=a+1/o,i=u/o/2.506628274631)}return r>0?1-i:i},r.icdf=function(n){if(0>=n||n>=1)return NaN;var i=2*n-1,r=8*(Math.PI-3)/(3*Math.PI*(4-Math.PI)),a=2/(Math.PI*r)+Math.log(1-Math.pow(i,2))/2,o=Math.log(1-i*i)/r,u=(i>0?1:-1)*Math.sqrt(Math.sqrt(a*a-o)-a);return e+t*Math.SQRT2*u},r}},{}],5:[function(e,t,n){function i(e,t){return t?void(e[s]=t):e&&e[s]||null}function r(e,t){e=l.array(e),t=l.$(t);var n,i,r;if(e[s]&&(n=t(e[s]),l.isString(n)))return n;for(i=0,r=e.length;!l.isValid(n)&&r>i;++i)n=t?t(e[i]):e[i];return l.isDate(n)?"date":l.isNumber(n)?"number":l.isBoolean(n)?"boolean":l.isString(n)?"string":null}function a(e,t){return e.length?(t=t||l.keys(e[0]),t.reduce(function(t,n){return t[n]=r(e,n),t},{})):void 0}function o(e,t){e=l.array(e),t=l.$(t);var n,i,r,a=["boolean","integer","number","date"];for(n=0;n<e.length;++n){for(r=t?t(e[n]):e[n],i=0;i<a.length;++i)l.isValid(r)&&!c[a[i]](r)&&(a.splice(i,1),i-=1);if(0===a.length)return"string"}return a[0]}function u(e,t){return t=t||l.keys(e[0]),t.reduce(function(t,n){return t[n]=o(e,n),t},{})}var l=e("../util"),s="__types__",f={"boolean":l["boolean"],integer:l.number,number:l.number,date:l.date,string:function(e){return""===e?null:e}},c={"boolean":function(e){return"true"===e||"false"===e||l.isBoolean(e)},integer:function(e){return c.number(e)&&(e=+e)===~~e},number:function(e){return!isNaN(+e)&&!l.isDate(e)},date:function(e){return!isNaN(Date.parse(e))}};r.annotation=i,r.all=a,r.infer=o,r.inferAll=u,r.parsers=f,t.exports=r},{"../util":8}],6:[function(e,t,n){var i=e("./util"),r=e("./import/type"),a=e("./generate"),o={};o.unique=function(e,t,n){t=i.$(t),n=n||[];var r,a,o,u={};for(a=0,o=e.length;o>a;++a)r=t?t(e[a]):e[a],r in u||(u[r]=1,n.push(r));return n},o.count=function(e){return e&&e.length||0},o.count.valid=function(e,t){t=i.$(t);var n,r,a,o=0;for(r=0,a=e.length;a>r;++r)n=t?t(e[r]):e[r],i.isValid(n)&&(o+=1);return o},o.count.missing=function(e,t){t=i.$(t);var n,r,a,o=0;for(r=0,a=e.length;a>r;++r)n=t?t(e[r]):e[r],null==n&&(o+=1);return o},o.count.distinct=function(e,t){t=i.$(t);var n,r,a,o={},u=0;for(r=0,a=e.length;a>r;++r)n=t?t(e[r]):e[r],n in o||(o[n]=1,u+=1);return u},o.count.map=function(e,t){t=i.$(t);var n,r,a,o={};for(r=0,a=e.length;a>r;++r)n=t?t(e[r]):e[r],o[n]=n in o?o[n]+1:1;return o},o.median=function(e,t){return t&&(e=e.map(i.$(t))),e=e.filter(i.isValid).sort(i.cmp),o.quantile(e,.5)},o.quartile=function(e,t){t&&(e=e.map(i.$(t))),e=e.filter(i.isValid).sort(i.cmp);var n=o.quantile;return[n(e,.25),n(e,.5),n(e,.75)]},o.quantile=function(e,t,n){void 0===n&&(n=t,t=i.identity),t=i.$(t);var r=(e.length-1)*n+1,a=Math.floor(r),o=+t(e[a-1]),u=r-a;return u?o+u*(t(e[a])-o):o},o.sum=function(e,t){t=i.$(t);for(var n,r=0,a=0,o=e.length;o>a;++a)n=t?t(e[a]):e[a],i.isValid(n)&&(r+=n);return r},o.mean=function(e,t){t=i.$(t);var n,r,a,o,u,l=0;for(r=0,o=0,a=e.length;a>r;++r)u=t?t(e[r]):e[r],i.isValid(u)&&(n=u-l,l+=n/++o);return l},o.variance=function(e,t){if(t=i.$(t),!i.isArray(e)||e.length<2)return 0;var n,r,a,o,u=0,l=0;for(r=0,a=0;r<e.length;++r)o=t?t(e[r]):e[r],i.isValid(o)&&(n=o-u,u+=n/++a,l+=n*(o-u));return l/=a-1},o.stdev=function(e,t){return Math.sqrt(o.variance(e,t))},o.modeskew=function(e,t){var n=o.mean(e,t),i=o.median(e,t),r=o.stdev(e,t);return 0===r?0:(n-i)/r},o.min=function(e,t){return o.extent(e,t)[0]},o.max=function(e,t){return o.extent(e,t)[1]},o.extent=function(e,t){t=i.$(t);var n,r,a,o,u=e.length;for(o=0;u>o;++o)if(a=t?t(e[o]):e[o],i.isValid(a)){n=r=a;break}for(;u>o;++o)a=t?t(e[o]):e[o],i.isValid(a)&&(n>a&&(n=a),a>r&&(r=a));return[n,r]},o.extent.index=function(e,t){t=i.$(t);var n,r,a,o,u=-1,l=-1,s=e.length;for(o=0;s>o;++o)if(a=t?t(e[o]):e[o],i.isValid(a)){n=r=a,u=l=o;break}for(;s>o;++o)a=t?t(e[o]):e[o],i.isValid(a)&&(n>a&&(n=a,u=o),a>r&&(r=a,l=o));return[u,l]},o.dot=function(e,t,n){var r,a,o=0;if(n)for(t=i.$(t),n=i.$(n),r=0;r<e.length;++r)a=t(e[r])*n(e[r]),a===a&&(o+=a);else{if(e.length!==t.length)throw Error("Array lengths must match.");for(r=0;r<e.length;++r)a=e[r]*t[r],a===a&&(o+=a)}return o},o.dist=function(e,t,n,r){var a,o,u=i.isFunction(n)||i.isString(n),l=e,s=u?e:t,f=u?r:n,c=2===f||null==f,d=e.length,p=0;for(u&&(t=i.$(t),n=i.$(n)),o=0;d>o;++o)a=u?t(l[o])-n(s[o]):l[o]-s[o],p+=c?a*a:Math.pow(Math.abs(a),f);return c?Math.sqrt(p):Math.pow(p,1/f)},o.cohensd=function(e,t,n){var r=n?e.map(i.$(t)):e,a=n?e.map(i.$(n)):t,u=o.mean(r),l=o.mean(a),s=o.count.valid(r),f=o.count.valid(a);if(0>=s+f-2)return 0;var c=o.variance(r),d=o.variance(a),p=Math.sqrt(((s-1)*c+(f-1)*d)/(s+f-2));return 0===p?0:(u-l)/p},o.covariance=function(e,t,n){var r,a,u,l,s,f=n?e.map(i.$(t)):e,c=n?e.map(i.$(n)):t,d=f.length,p=o.mean(f),h=o.mean(c),m=0,g=0;if(d!==c.length)throw Error("Input lengths must match.");for(r=0;d>r;++r)if(a=f[r],l=i.isValid(a),u=c[r],s=i.isValid(u),l&&s)m+=(a-p)*(u-h),++g;else if(l||s)throw Error("Valid values must align.");return m/(g-1)},o.rank=function(e,t){t=i.$(t)||i.identity;var n,r,a,o=e.map(function(e,n){return{idx:n,val:t(e)}}).sort(i.comparator("val")),u=e.length,l=Array(u),s=-1,f={};for(n=0;u>n;++n){if(r=o[n].val,0>s&&f===r)s=n-1;else if(s>-1&&f!==r){for(a=1+(n-1+s)/2;n>s;++s)l[o[s].idx]=a;s=-1}l[o[n].idx]=n+1,f=r}if(s>-1)for(a=1+(u-1+s)/2;u>s;++s)l[o[s].idx]=a;return l},o.cor=function(e,t,n){var r=n;n=r?e.map(i.$(n)):t,t=r?e.map(i.$(t)):e;var a=o.dot(t,n),u=o.mean(t),l=o.mean(n),s=o.stdev(t),f=o.stdev(n),c=e.length;return(a-c*u*l)/((c-1)*s*f)},o.cor.rank=function(e,t,n){var r,a,u,l=n?o.rank(e,i.$(t)):o.rank(e),s=n?o.rank(e,i.$(n)):o.rank(t),f=e.length;for(r=0,a=0;f>r;++r)u=l[r]-s[r],a+=u*u;return 1-6*a/(f*(f*f-1))},o.cor.dist=function(e,t,n){var r,a,u,l,s=n?e.map(i.$(t)):e,f=n?e.map(i.$(n)):t,c=o.dist.mat(s),d=o.dist.mat(f),p=c.length;for(r=0,a=0,u=0,l=0;p>r;++r)a+=c[r]*c[r],u+=d[r]*d[r],l+=c[r]*d[r];return Math.sqrt(l/Math.sqrt(a*u))},o.linearRegression=function(e,t,n){var r,a,u=n?e.map(i.$(t)):e,l=n?e.map(i.$(n)):t,s=u.length,f=o.covariance(u,l),c=o.stdev(u),d=o.stdev(l),p=f/(c*c),h=o.mean(l)-p*o.mean(u),m={slope:p,intercept:h,R:f/(c*d),rss:0};for(a=0;s>a;++a)i.isValid(u[a])&&i.isValid(l[a])&&(r=p*u[a]+h-l[a],m.rss+=r*r);return m},o.z={},o.z.ci=function(e,t){var n=t?a.random.normal(0,1).icdf(1-t/2):1.96,i=o.mean(e),r=o.stdev(e)/Math.sqrt(o.count.valid(e));return[i-n*r,i+n*r]},o.z.test=function(e,t){var n=t?t:0,i=a.random.normal(0,1),r=o.mean(e),u=o.stdev(e)/Math.sqrt(o.count.valid(e));if(0===u)return r-n===0?1:0;var l=(r-n)/u;return 2*i.cdf(-Math.abs(l))},o.z.pairedTest=function(e,t,n){var r,a=n?e.map(i.$(t)):e,u=n?e.map(i.$(n)):t,l=o.count(a),s=o.count(u),f=Array();if(l!==s)throw Error("Array lengths must match.");for(r=0;l>r;++r)i.isValid(a[r])&&i.isValid(u[r])&&f.push(a[r]-u[r]);return o.z.test(f)},o.z.twoSampleTest=function(e,t,n){var r=n?e.map(i.$(t)):e,u=n?e.map(i.$(n)):t,l=o.count.valid(r),s=o.count.valid(u),f=a.random.normal(0,1),c=o.mean(r)-o.mean(u),d=Math.sqrt(o.variance(r)/l+o.variance(u)/s);if(0===d)return 0===c?1:0;var p=c/d;return 2*f.cdf(-Math.abs(p))},o.dist.mat=function(e){var t,n,i,r=e.length,o=r*r,u=Array(o),l=a.zeros(r),s=0;for(n=0;r>n;++n)for(u[n*r+n]=0,i=n+1;r>i;++i)u[n*r+i]=t=Math.abs(e[n]-e[i]),u[i*r+n]=t,l[n]+=t,l[i]+=t;for(n=0;r>n;++n)s+=l[n],l[n]/=r;for(s/=o,n=0;r>n;++n)for(i=n;r>i;++i)u[n*r+i]+=s-l[n]-l[i],u[i*r+n]=u[n*r+i];return u},o.entropy=function(e,t){t=i.$(t);var n,r,a=0,o=0,u=e.length;for(n=0;u>n;++n)a+=t?t(e[n]):e[n];if(0===a)return 0;for(n=0;u>n;++n)r=(t?t(e[n]):e[n])/a,r&&(o+=r*Math.log(r));return-o/Math.LN2},o.mutual=function(e,t,n,r){var a,o,u,l=r?e.map(i.$(t)):e,s=r?e.map(i.$(n)):t,f=r?e.map(i.$(r)):n,c={},d={},p=f.length,h=0,m=0,g=0;for(u=0;p>u;++u)c[l[u]]=0,d[s[u]]=0;for(u=0;p>u;++u)c[l[u]]+=f[u],d[s[u]]+=f[u],h+=f[u];for(o=1/(h*Math.LN2),u=0;p>u;++u)0!==f[u]&&(a=h*f[u]/(c[l[u]]*d[s[u]]),m+=f[u]*o*Math.log(a),g+=f[u]*o*Math.log(f[u]/h));return[m,1+m/g]},o.mutual.info=function(e,t,n,i){return o.mutual(e,t,n,i)[0]},o.mutual.dist=function(e,t,n,i){return o.mutual(e,t,n,i)[1]},o.profile=function(e,t){var n,a,u,l,s,f=0,c=0,d=0,p=0,h=null,m=null,g=0,y=[],v={};for(u=0;u<e.length;++u)l=t?t(e[u]):e[u],v[l]=l in v?v[l]+1:(p+=1,1),null==l?++d:i.isValid(l)&&(s="string"==typeof l?l.length:l,(null===h||h>s)&&(h=s),(null===m||s>m)&&(m=s),n=s-f,f+=n/++c,g+=n*(s-f),y.push(s));return g/=c-1,a=Math.sqrt(g),y.sort(i.cmp),{type:r(e,t),unique:v,count:e.length,valid:c,missing:d,distinct:p,min:h,max:m,mean:f,stdev:a,median:l=o.quantile(y,.5),q1:o.quantile(y,.25),q3:o.quantile(y,.75),modeskew:0===a?0:(f-l)/a}},o.summary=function(e,t){t=t||i.keys(e[0]);var n=t.map(function(t){var n=o.profile(e,i.$(t));return n.field=t,n});return n.__summary__=!0,n},t.exports=o},{"./generate":4,"./import/type":5,"./util":8}],7:[function(e,t,n){function i(e){return s.setTime(+e),s}function r(e,t,n,i,r,a){var o={type:e,date:t,unit:n};return i?o.step=i:o.minstep=1,null!=r&&(o.min=r),null!=a&&(o.max=a),o}function a(e,t,n,i,a,o){return r(e,function(e){return t.offset(n,e)},function(e){return t.count(n,e)},i,a,o)}function o(e,t,n,i){var r,a,o,u=h[0];for(r=1,a=h.length;a>r;++r)if(u=h[r],t>u[0]){if(o=t/u[0],o>i)return e[h[r-1][1]];if(o>=n)return e[u[1]]}return e[h[a-1][1]]}function u(e){var t,n,i={};for(t=0,n=e.length;n>t;++t)i[e[t].type]=e[t];return i.find=function(t,n,i){return o(e,t,n,i)},i}var l=e("d3-time"),s=new Date,f=new Date(0,0,1).setFullYear(0),c=new Date(Date.UTC(0,0,1)).setUTCFullYear(0),d=[a("second",l.second,f),a("minute",l.minute,f),a("hour",l.hour,f),a("day",l.day,f,[1,7]),a("month",l.month,f,[1,3,6]),a("year",l.year,f),r("seconds",function(e){return new Date(1970,0,1,0,0,e)},function(e){return i(e).getSeconds()},null,0,59),r("minutes",function(e){return new Date(1970,0,1,0,e)},function(e){return i(e).getMinutes()},null,0,59),r("hours",function(e){return new Date(1970,0,1,e)},function(e){return i(e).getHours()},null,0,23),r("weekdays",function(e){return new Date(1970,0,4+e)},function(e){return i(e).getDay()},[1],0,6),r("dates",function(e){return new Date(1970,0,e)},function(e){return i(e).getDate()},[1],1,31),r("months",function(e){return new Date(1970,e%12,1)},function(e){return i(e).getMonth()},[1],0,11)],p=[a("second",l.utcSecond,c),a("minute",l.utcMinute,c),a("hour",l.utcHour,c),a("day",l.utcDay,c,[1,7]),a("month",l.utcMonth,c,[1,3,6]),a("year",l.utcYear,c),r("seconds",function(e){return new Date(Date.UTC(1970,0,1,0,0,e))},function(e){return i(e).getUTCSeconds()},null,0,59),r("minutes",function(e){return new Date(Date.UTC(1970,0,1,0,e))},function(e){return i(e).getUTCMinutes()},null,0,59),r("hours",function(e){return new Date(Date.UTC(1970,0,1,e))},function(e){return i(e).getUTCHours()},null,0,23),r("weekdays",function(e){return new Date(Date.UTC(1970,0,4+e))},function(e){return i(e).getUTCDay()},[1],0,6),r("dates",function(e){return new Date(Date.UTC(1970,0,e))},function(e){return i(e).getUTCDate()},[1],1,31),r("months",function(e){return new Date(Date.UTC(1970,e%12,1))},function(e){return i(e).getUTCMonth()},[1],0,11)],h=[[31536e6,5],[7776e6,4],[2592e6,4],[12096e5,3],[6048e5,3],[1728e5,3],[864e5,3],[432e5,2],[216e5,2],[108e5,2],[36e5,2],[18e5,1],[9e5,1],[3e5,1],[6e4,1],[3e4,0],[15e3,0],[5e3,0],[1e3,0]];t.exports=u(d),t.exports.utc=u(p)},{"d3-time":2}],8:[function(e,t,n){function i(e){return e.replace(d,"$1\\'")}function r(e,t){var n,i="";for(n=0;e>n;++n)i+=t;return i}function a(e,t,n){var i=0,r=e.split(h);return e=n?(r=r.reverse()).filter(function(e){return i+=e.length,t>=i}).reverse():r.filter(function(e){return i+=e.length,t>=i}),e.length?e.join("").trim():r[0].slice(0,t)}var o=e("buffer"),u=e("./time"),l=u.utc,s=t.exports={},f="__name__";s.namedfunc=function(e,t){return t[f]=e,t},s.name=function(e){return null==e?null:e[f]},s.identity=function(e){return e},s["true"]=s.namedfunc("true",function(){return!0}),s["false"]=s.namedfunc("false",function(){return!1}),s.duplicate=function(e){return JSON.parse(JSON.stringify(e))},s.equal=function(e,t){return JSON.stringify(e)===JSON.stringify(t)},s.extend=function(e){for(var t,n,i=1,r=arguments.length;r>i;++i){t=arguments[i];for(n in t)e[n]=t[n]}return e},s.length=function(e){return null!=e&&null!=e.length?e.length:null},s.keys=function(e){var t,n=[];for(t in e)n.push(t);return n},s.vals=function(e){var t,n=[];for(t in e)n.push(e[t]);return n},s.toMap=function(e,t){return(t=s.$(t))?e.reduce(function(e,n){return e[t(n)]=1,e},{}):e.reduce(function(e,t){return e[t]=1,e},{})},s.keystr=function(e){var t=e.length;if(!t)return"";for(var n=String(e[0]),i=1;t>i;++i)n+="|"+String(e[i]);return n};var c=Object.prototype.toString;s.isObject=function(e){return e===Object(e)},s.isFunction=function(e){return"[object Function]"===c.call(e)},s.isString=function(e){return"string"==typeof value||"[object String]"===c.call(e)},s.isArray=Array.isArray||function(e){return"[object Array]"===c.call(e)},s.isNumber=function(e){return"number"==typeof e||"[object Number]"===c.call(e)},s.isBoolean=function(e){return e===!0||e===!1||"[object Boolean]"==c.call(e)},s.isDate=function(e){return"[object Date]"===c.call(e)},s.isValid=function(e){return null!=e&&e===e},s.isBuffer=o.Buffer&&o.Buffer.isBuffer||s["false"],s.number=function(e){return null==e||""===e?null:+e},s["boolean"]=function(e){return null==e||""===e?null:"false"===e?!1:!!e},s.date=function(e,t){var n=t?t:Date;return null==e||""===e?null:n.parse(e)},s.array=function(e){return null!=e?s.isArray(e)?e:[e]:[]},s.str=function(e){return s.isArray(e)?"["+e.map(s.str)+"]":s.isObject(e)?JSON.stringify(e):s.isString(e)?"'"+i(e)+"'":e};var d=/(^|[^\\])'/g,p=/\[(.*?)\]|[^.\[]+/g;s.field=function(e){return String(e).match(p).map(function(e){return"["!==e[0]?e:"'"!==e[1]&&'"'!==e[1]?e.slice(1,-1):e.slice(2,-2).replace(/\\(["'])/g,"$1")})},s.accessor=function(e){var t;return null==e||s.isFunction(e)?e:s.namedfunc(e,(t=s.field(e)).length>1?function(e){return t.reduce(function(e,t){return e[t]},e)}:function(t){return t[e]})},s.$=s.accessor,s.mutator=function(e){var t;return s.isString(e)&&(t=s.field(e)).length>1?function(e,n){for(var i=0;i<t.length-1;++i)e=e[t[i]];e[t[i]]=n}:function(t,n){t[e]=n}},s.$func=function(e,t){return function(n){n=s.$(n)||s.identity;var i=e+(s.name(n)?"_"+s.name(n):"");return s.namedfunc(i,function(e){return t(n(e))})}},s.$valid=s.$func("valid",s.isValid),s.$length=s.$func("length",s.length),s.$in=function(e,t){e=s.$(e);var n=s.isArray(t)?s.toMap(t):t;return function(t){return!!n[e(t)]}},s.$year=s.$func("year",u.year.unit),s.$month=s.$func("month",u.months.unit),s.$date=s.$func("date",u.dates.unit),s.$day=s.$func("day",u.weekdays.unit),s.$hour=s.$func("hour",u.hours.unit),s.$minute=s.$func("minute",u.minutes.unit),s.$second=s.$func("second",u.seconds.unit),s.$utcYear=s.$func("utcYear",l.year.unit),s.$utcMonth=s.$func("utcMonth",l.months.unit),s.$utcDate=s.$func("utcDate",l.dates.unit),s.$utcDay=s.$func("utcDay",l.weekdays.unit),s.$utcHour=s.$func("utcHour",l.hours.unit),s.$utcMinute=s.$func("utcMinute",l.minutes.unit),s.$utcSecond=s.$func("utcSecond",l.seconds.unit),s.comparator=function(e){var t=[];return void 0===e&&(e=[]),e=s.array(e).map(function(e){var n=1;return"-"===e[0]?(n=-1,e=e.slice(1)):"+"===e[0]&&(n=1,e=e.slice(1)),t.push(n),s.accessor(e)}),function(n,i){var r,a,o,u,l;for(r=0,a=e.length;a>r;++r){if(o=e[r],u=o(n),l=o(i),l>u)return-1*t[r];if(u>l)return t[r]}return 0}},s.cmp=function(e,t){return t>e?-1:e>t?1:e>=t?0:null===e?-1:null===t?1:NaN},s.numcmp=function(e,t){return e-t},s.stablesort=function(e,t,n){var i=e.reduce(function(e,t,i){return e[n(t)]=i,e},{});return e.sort(function(e,r){var a=t(e),o=t(r);return o>a?-1:a>o?1:i[n(e)]-i[n(r)]}),e},s.pad=function(e,t,n,i){i=i||" ";var a=t-e.length;if(0>=a)return e;switch(n){case"left":return r(a,i)+e;case"middle":case"center":return r(Math.floor(a/2),i)+e+r(Math.ceil(a/2),i);default:return e+r(a,i)}},s.truncate=function(e,t,n,i,r){var o=e.length;if(t>=o)return e;r=void 0!==r?String(r):"â€¦";var u=Math.max(0,t-r.length);switch(n){case"left":return r+(i?a(e,u,1):e.slice(o-u));case"middle":case"center":var l=Math.ceil(u/2),s=Math.floor(u/2);return(i?a(e,l):e.slice(0,l))+r+(i?a(e,s,1):e.slice(o-s));default:return(i?a(e,u):e.slice(0,u))+r}};var h=/([\u0009\u000A\u000B\u000C\u000D\u0020\u00A0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u2028\u2029\u3000\uFEFF])/},{"./time":7,buffer:1}],9:[function(e,t,n){n.AGGREGATE_OPS=["values","count","valid","missing","distinct","sum","mean","average","variance","variancep","stdev","stdevp","median","q1","q3","modeskew","min","max","argmin","argmax"],n.SHARED_DOMAIN_OPS=["mean","average","stdev","stdevp","median","q1","q3","min","max"]},{}],10:[function(e,t,n){n.MAXBINS_DEFAULT=15},{}],11:[function(e,t,n){function i(e,t){return!!r(e)[t]}function r(e){switch(e){case n.X:case n.Y:return{point:!0,tick:!0,circle:!0,square:!0,bar:!0,line:!0,area:!0};case n.ROW:case n.COLUMN:return{point:!0,tick:!0,circle:!0,square:!0,bar:!0,line:!0,area:!0,text:!0};case n.SIZE:return{point:!0,tick:!0,circle:!0,square:!0,bar:!0,text:!0};case n.COLOR:case n.DETAIL:return{point:!0,tick:!0,circle:!0,square:!0,bar:!0,line:!0,area:!0,text:!0};case n.SHAPE:return{point:!0};case n.TEXT:return{text:!0}}return{}}function a(e){switch(e){case n.X:case n.Y:case n.COLOR:return{measure:!0,dimension:!0};case n.ROW:case n.COLUMN:case n.SHAPE:case n.DETAIL:return{measure:!1,dimension:!0};case n.SIZE:case n.TEXT:return{measure:!0,dimension:!1}}throw new Error("Invalid encoding channel"+e)}!function(e){e[e.X="x"]="X",e[e.Y="y"]="Y",e[e.ROW="row"]="ROW",e[e.COLUMN="column"]="COLUMN",e[e.SHAPE="shape"]="SHAPE",e[e.SIZE="size"]="SIZE",e[e.COLOR="color"]="COLOR",e[e.TEXT="text"]="TEXT",e[e.DETAIL="detail"]="DETAIL"}(n.Channel||(n.Channel={}));var o=n.Channel;n.X=o.X,n.Y=o.Y,n.ROW=o.ROW,n.COLUMN=o.COLUMN,n.SHAPE=o.SHAPE,n.SIZE=o.SIZE,n.COLOR=o.COLOR,n.TEXT=o.TEXT,n.DETAIL=o.DETAIL,n.CHANNELS=[n.X,n.Y,n.ROW,n.COLUMN,n.SIZE,n.SHAPE,n.COLOR,n.TEXT,n.DETAIL],n.supportMark=i,n.getSupportedMark=r,n.getSupportedRole=a},{}],12:[function(e,t,n){var i=e("../bin"),r=e("../channel"),a=e("../data"),o=e("../fielddef"),u=e("../encoding"),l=e("./layout"),s=e("../mark"),f=e("../schema/schema"),c=e("../schema/schemautil"),d=e("../type"),p=e("../util"),h=e("./time"),m=function(){function e(e,t){var n=f.instantiate();this._spec=c.merge(n,t||{},e),u.forEach(this._spec.encoding,function(e,t){e.type&&(e.type=d.getFullName(e.type))}),this._stack=this.getStackProperties(),this._layout=l.compileLayout(this)}return e.prototype.getStackProperties=function(){var e=this.has(r.COLOR)?r.COLOR:this.has(r.DETAIL)?r.DETAIL:null;if(e&&(this.is(s.BAR)||this.is(s.AREA))&&this.config("stack")!==!1&&this.isAggregate()){var t=this.isMeasure(r.X),n=this.isMeasure(r.Y);if(t&&!n)return{groupbyChannel:r.Y,fieldChannel:r.X,stackChannel:e,config:this.config("stack")};if(n&&!t)return{groupbyChannel:r.X,fieldChannel:r.Y,stackChannel:e,config:this.config("stack")}}return null},e.prototype.layout=function(){return this._layout},e.prototype.stack=function(){return this._stack},e.prototype.toSpec=function(e,t){var n,i=p.duplicate(this._spec.encoding);n={mark:this._spec.mark,encoding:i},e||(n.config=p.duplicate(this._spec.config)),t||(n.data=p.duplicate(this._spec.data));var r=f.instantiate();return c.subtract(n,r)},e.prototype.mark=function(){return this._spec.mark},e.prototype.spec=function(){return this._spec},e.prototype.is=function(e){return this._spec.mark===e},e.prototype.has=function(e){return void 0!==this._spec.encoding[e].field},e.prototype.fieldDef=function(e){return this._spec.encoding[e]},e.prototype.field=function(e,t){t=t||{};var n=this.fieldDef(e),i=(t.datum?"datum.":"")+(t.prefn||""),r=n.field;if(o.isCount(n))return i+"count";if(t.fn)return i+t.fn+"_"+r;if(!t.nofn&&n.bin){var a=t.binSuffix||"_start";return i+"bin_"+r+a}return t.nofn||t.noAggregate||!n.aggregate?!t.nofn&&n.timeUnit?i+n.timeUnit+"_"+r:i+r:i+n.aggregate+"_"+r},e.prototype.fieldTitle=function(e){if(o.isCount(this._spec.encoding[e]))return o.COUNT_DISPLAYNAME;var t=this._spec.encoding[e].aggregate||this._spec.encoding[e].timeUnit||this._spec.encoding[e].bin&&"bin";return t?t.toUpperCase()+"("+this._spec.encoding[e].field+")":this._spec.encoding[e].field},e.prototype.bin=function(e){var t=this._spec.encoding[e].bin;return t==={}?!1:t===!0?{maxbins:i.MAXBINS_DEFAULT}:t},e.prototype.numberFormat=function(e){return this.config("numberFormat")},e.prototype.map=function(e){return u.map(this._spec.encoding,e)},e.prototype.reduce=function(e,t){return u.reduce(this._spec.encoding,e,t)},e.prototype.forEach=function(e){return u.forEach(this._spec.encoding,e)},e.prototype.isOrdinalScale=function(e){var t=this.fieldDef(e);return t&&(p.contains([d.NOMINAL,d.ORDINAL],t.type)||t.type===d.TEMPORAL&&t.timeUnit&&"ordinal"===h.scale.type(t.timeUnit,e))},e.prototype.isDimension=function(e){return this.has(e)&&o.isDimension(this.fieldDef(e))},e.prototype.isMeasure=function(e){return this.has(e)&&o.isMeasure(this.fieldDef(e))},e.prototype.isAggregate=function(){return u.isAggregate(this._spec.encoding)},e.prototype.isFacet=function(){return this.has(r.ROW)||this.has(r.COLUMN)},e.prototype.dataTable=function(){return this.isAggregate()?a.SUMMARY:a.SOURCE},e.prototype.data=function(){return this._spec.data},e.prototype.hasValues=function(){var e=this.data().values;return e&&e.length},e.prototype.config=function(e){return this._spec.config[e]},e.prototype.markOpacity=function(){var e=this.config("marks").opacity;return e?e:!p.contains([s.POINT,s.TICK,s.CIRCLE,s.SQUARE],this.mark())||this.isAggregate()&&!this.has(r.DETAIL)?void 0:.7},e}();n.Model=m},{"../bin":10,"../channel":11,"../data":23,"../encoding":24,"../fielddef":25,"../mark":26,"../schema/schema":39,"../schema/schemautil":40,"../type":45,"../util":46,"./layout":17,"./time":22}],13:[function(e,t,n){function i(e,t){var i=e===p.COLUMN,r=e===p.ROW,a=i?"x":r?"y":e,o={type:a,scale:e};["format","grid","layer","orient","tickSize","ticks","title","offset","tickPadding","tickSize","tickSizeMajor","tickSizeMinor","tickSizeEnd","titleOffset","values","subdivide"].forEach(function(i){var r,a=(r=n[i])?r(t,e,o):t.fieldDef(e).axis[i];void 0!==a&&(o[i]=a)});var u=t.fieldDef(e).axis.properties||{};return["axis","labels","grid","title","ticks","majorTicks","minorTicks"].forEach(function(n){var i=m[n]?m[n](t,e,u[n],o):u[n];void 0!==i&&(o.properties=o.properties||{},o.properties[n]=i)}),o}function r(e,t){var n=e.fieldDef(t),i=n.axis.format;if(void 0!==i)return i;if(n.type===d.QUANTITATIVE)return e.numberFormat(t);if(n.type===d.TEMPORAL){var r=n.timeUnit;if(!r)return e.config("timeFormat");if("year"===r)return"d"}}function a(e,t){var n=e.fieldDef(t),i=n.axis.grid;return void 0!==i?i:!e.isOrdinalScale(t)&&!n.bin}function o(e,t,n){var i=e.fieldDef(t).axis.layer;return void 0!==i?i:n.grid?"back":void 0}function u(e,t){var n=e.fieldDef(t).axis.orient;return n?n:t===p.COLUMN?"top":t===p.ROW&&e.has(p.Y)&&"right"!==e.fieldDef(p.Y).axis.orient?"right":void 0;
}function l(e,t){var n=e.fieldDef(t).axis.ticks;return void 0!==n?n:t!==p.X||e.fieldDef(t).bin?void 0:5}function s(e,t){var n=e.fieldDef(t).axis.tickSize;return void 0!==n?n:t===p.ROW||t===p.COLUMN?0:void 0}function f(e,t){var n=e.fieldDef(t).axis;if(void 0!==n.title)return n.title;var i,r=e.fieldTitle(t),a=e.layout();return n.titleMaxLength?i=n.titleMaxLength:t===p.X&&"number"==typeof a.cellWidth?i=a.cellWidth/e.config("characterWidth"):t===p.Y&&"number"==typeof a.cellHeight&&(i=a.cellHeight/e.config("characterWidth")),i?c.truncate(r,i):r}var c=e("../util"),d=e("../type"),p=e("../channel"),h=e("./time");n.compileAxis=i,n.format=r,n.grid=a,n.layer=o,n.orient=u,n.ticks=l,n.tickSize=s,n.title=f;var m;!function(e){function t(e,t,n){return t===p.ROW||t===p.COLUMN?c.extend({opacity:{value:0}},n||{}):n||void 0}function n(e,t,n,i){var r=e.fieldDef(t),a=h.labelTemplate(r.timeUnit,r.axis.shortTimeNames);switch(r.type===d.TEMPORAL&&a&&(n=c.extend({text:{template:"{{datum.data | "+a+"}}"}},n||{})),c.contains([d.NOMINAL,d.ORDINAL],r.type)&&r.axis.labelMaxLength&&(n=c.extend({text:{template:"{{ datum.data | truncate:"+r.axis.labelMaxLength+"}}"}},n||{})),t){case p.X:(e.isDimension(p.X)||r.type===d.TEMPORAL)&&(n=c.extend({angle:{value:270},align:{value:"top"===i.orient?"left":"right"},baseline:{value:"middle"}},n||{}));break;case p.ROW:"right"===i.orient&&(n=c.extend({angle:{value:90},align:{value:"center"},baseline:{value:"bottom"}},n||{}))}return n||void 0}e.axis=t,e.labels=n}(m||(m={}))},{"../channel":11,"../type":45,"../util":46,"./time":22}],14:[function(e,t,n){function i(e,t){var n=new r.Model(e,t),i=n.layout(),h=c.extend({name:e.name?e.name+"_root":"root",type:"group"},e.description?{description:e.description}:{},{from:{data:d.LAYOUT},properties:{update:{width:i.width.field?{field:i.width.field}:{value:i.width},height:i.height.field?{field:i.height.field}:{value:i.height}}}}),m=s.compileMarks(n);if(n.has(p.ROW)||n.has(p.COLUMN))c.extend(h,u.facetMixins(n,m));else{h.marks=m.map(function(e){return e.from=e.from||{},e.from.data=n.dataTable(),e});var g=n.map(function(e,t){return t});h.scales=f.compileScales(g,n);var y=(n.has(p.X)?[a.compileAxis(p.X,n)]:[]).concat(n.has(p.Y)?[a.compileAxis(p.Y,n)]:[]);y.length>0&&(h.axes=y)}var v=l.compileLegends(n);v.length>0&&(h.legends=v);var b=1,O=c.extend(e.name?{name:e.name}:{},{width:i.width.field?b:i.width,height:i.height.field?b:i.height,padding:"auto"},["viewport","background","scene"].reduce(function(e,t){var i=n.config(t);return void 0!==i&&(e[t]=i),e},{}),{data:o.compileData(n),marks:[h]});return{spec:O}}var r=e("./Model"),a=e("./axis"),o=e("./data"),u=e("./facet"),l=e("./legend"),s=e("./marks"),f=e("./scale"),c=e("../util"),d=e("../data"),p=e("../channel"),h=e("./Model");n.Model=h.Model,n.compile=i},{"../channel":11,"../data":23,"../util":46,"./Model":12,"./axis":13,"./data":15,"./facet":16,"./legend":18,"./marks":19,"./scale":20}],15:[function(e,t,n){function i(e){var t=[d.def(e)],n=h.def(e);n&&t.push(n),r(t[t.length-1],e);var i=p.def(e);i&&t.push(i);var a=e.stack();return a&&t.push(m.def(e,a)),t}function r(e,t){t.forEach(function(n,i){"log"===t.fieldDef(i).scale.type&&e.transform.push({type:"filter",test:t.field(i,{datum:!0})+" > 0"})})}var a=e("../fielddef"),o=e("../util"),u=e("../bin"),l=e("../channel"),s=e("../data"),f=e("./time"),c=e("../type");n.compileData=i;var d;!function(e){function t(e){var t={name:s.SOURCE};e.hasValues()?(t.values=e.data().values,t.format={type:"json"}):(t.url=e.data().url,t.format={type:e.data().formatType});var r=n(e);return r&&(t.format.parse=r),t.transform=i(e),t}function n(e){var t;return e.forEach(function(e){if(e.type===c.TEMPORAL)t=t||{},t[e.field]="date";else if(e.type===c.QUANTITATIVE){if(a.isCount(e))return;t=t||{},t[e.field]="number"}}),t}function i(e){return d(e).concat(h(e),r(e),l(e),p(e))}function r(e){return e.reduce(function(t,n,i){if(n.type===c.TEMPORAL&&n.timeUnit){var r=e.field(i,{nofn:!0,datum:!0});t.push({type:"formula",field:e.field(i),expr:f.formula(n.timeUnit,r)})}return t},[])}function l(e){return e.reduce(function(t,n,i){var r=e.bin(i);return r&&t.push({type:"bin",field:n.field,output:{start:e.field(i,{binSuffix:"_start"}),mid:e.field(i,{binSuffix:"_mid"}),end:e.field(i,{binSuffix:"_end"})},maxbins:"boolean"==typeof r?u.MAXBINS_DEFAULT:r.maxbins}),t},[])}function d(e){var t=e.config("filterNull"),n=o.keys(e.reduce(function(e,n){return n.field&&"*"!==n.field&&t[n.type]&&(e[n.field]=!0),e},{}));return n.length>0?[{type:"filter",test:n.map(function(e){return"datum."+e+"!==null"}).join(" && ")}]:[]}function p(e){var t=e.data().filter;return t?[{type:"filter",test:t}]:[]}function h(e){var t=e.data().calculate;return void 0===t?[]:t.reduce(function(e,t){return e.push(o.extend({type:"formula"},t)),e},[])}e.def=t,e.transform=i,e.timeTransform=r,e.binTransform=l,e.nullFilterTransform=d,e.filterTransform=p,e.formulaTransform=h}(d=n.source||(n.source={}));var p;!function(e){function t(e){var t=[],n=[];if(e.has(l.X)&&e.isOrdinalScale(l.X)){var i=e.fieldDef(l.X).scale,r=i.domain instanceof Array;r||t.push({field:e.field(l.X),ops:["distinct"]});var a=r?i.domain.length:e.field(l.X,{datum:!0,prefn:"distinct_"});n.push({type:"formula",field:"cellWidth",expr:"("+a+" + "+i.padding+") * "+i.bandWidth})}if(e.has(l.Y)&&e.isOrdinalScale(l.Y)){var o=e.fieldDef(l.Y).scale,u=o.domain instanceof Array;u||t.push({field:e.field(l.Y),ops:["distinct"]});var f=u?o.domain.length:e.field(l.Y,{datum:!0,prefn:"distinct_"});n.push({type:"formula",field:"cellHeight",expr:"("+f+" + "+o.padding+") * "+o.bandWidth})}var c=e.config("cell").padding,d=e.layout();if(e.has(l.COLUMN)){var p=d.cellWidth.field?"datum."+d.cellWidth.field:d.cellWidth,h=e.fieldDef(l.COLUMN).scale,m=h.domain instanceof Array;m||t.push({field:e.fieldDef(l.COLUMN).field,ops:["distinct"]});var g=m?h.domain.length:e.field(l.COLUMN,{datum:!0,prefn:"distinct_"});n.push({type:"formula",field:"width",expr:p+" * "+g+" + ("+g+" - 1) * "+c})}if(e.has(l.ROW)){var y=d.cellHeight.field?"datum."+d.cellHeight.field:d.cellHeight,v=e.fieldDef(l.ROW).scale,b=v.domain instanceof Array;b||t.push({field:e.fieldDef(l.ROW).field,ops:["distinct"]});var O=b?v.domain.length:e.field(l.ROW,{datum:!0,prefn:"distinct_"});n.push({type:"formula",field:"height",expr:y+" * "+O+" + ("+O+" - 1) * "+c})}return n.length>0?t.length>0?{name:s.LAYOUT,source:e.dataTable(),transform:[{type:"aggregate",summarize:t}].concat(n)}:{name:s.LAYOUT,values:[{}],transform:n}:null}e.def=t}(p=n.layout||(n.layout={}));var h;!function(e){function t(e){var t={},n={},i=!1;e.forEach(function(r,a){r.aggregate?(i=!0,"count"===r.aggregate?(n["*"]=n["*"]||{},n["*"].count=!0):(n[r.field]=n[r.field]||{},n[r.field][r.aggregate]=!0)):r.bin?(t[e.field(a,{binSuffix:"_start"})]=e.field(a,{binSuffix:"_start"}),t[e.field(a,{binSuffix:"_mid"})]=e.field(a,{binSuffix:"_mid"}),t[e.field(a,{binSuffix:"_end"})]=e.field(a,{binSuffix:"_end"})):t[r.field]=e.field(a)});var r=o.vals(t),a=o.reduce(n,function(e,t,n){return e[n]=o.keys(t),e},{});return i?{name:s.SUMMARY,source:s.SOURCE,transform:[{type:"aggregate",groupby:r,summarize:a}]}:null}e.def=t}(h=n.summary||(n.summary={}));var m;!function(e){function t(e,t){var n=t.groupbyChannel,i=t.fieldChannel,r=(e.has(l.COLUMN)?[e.field(l.COLUMN)]:[]).concat(e.has(l.ROW)?[e.field(l.ROW)]:[]),a={name:s.STACKED,source:e.dataTable(),transform:[{type:"aggregate",groupby:[e.field(n)].concat(r),summarize:[{ops:["sum"],field:e.field(i)}]}]};return r&&r.length>0&&a.transform.push({type:"aggregate",groupby:r,summarize:[{ops:["max"],field:e.field(i,{prefn:"sum_"})}]}),a}e.def=t}(m=n.stack||(n.stack={})),n.filterNonPositiveForLog=r},{"../bin":10,"../channel":11,"../data":23,"../fielddef":25,"../type":45,"../util":46,"./time":22}],16:[function(e,t,n){function i(e,t){var n=e.layout(),i=e.has(s.COLUMN)?n.cellWidth.field?{scale:"column",band:!0}:{value:n.cellWidth}:{field:{group:"width"}},d=e.has(s.ROW)?n.cellHeight.field?{scale:"row",band:!0}:{value:n.cellHeight}:{field:{group:"height"}},p={width:i,height:d},h=e.config("cell");["fill","fillOpacity","stroke","strokeWidth","strokeOpacity","strokeDash","strokeDashOffset"].forEach(function(e){var t=h[e];void 0!==t&&(p[e]=t)});var m=[],g=[],y=[],v=[],b=e.has(s.ROW),O=e.has(s.COLUMN);b?(e.isDimension(s.ROW)||l.error("Row encoding should be ordinal."),p.y={scale:s.ROW,field:e.field(s.ROW)},y.push(e.field(s.ROW)),g.push(f.compileAxis(s.ROW,e)),e.has(s.X)&&m.push(r(e,i,O)),m.push(o(e,d))):e.has(s.X)&&v.push(f.compileAxis(s.X,e)),O?(e.isDimension(s.COLUMN)||l.error("Col encoding should be ordinal."),p.x={scale:s.COLUMN,field:e.field(s.COLUMN)},y.push(e.field(s.COLUMN)),g.push(f.compileAxis(s.COLUMN,e)),e.has(s.Y)&&m.push(a(e,d,b)),m.push(u(e,i))):e.has(s.Y)&&v.push(f.compileAxis(s.Y,e));var T={name:"cell",type:"group",from:{data:e.dataTable(),transform:[{type:"facet",groupby:y}]},properties:{update:p},marks:t};v.length>0&&(T.axes=v),m.push(T);var x=e.map(function(e,t){return t});return{marks:m,axes:g,scales:c.compileScales(x,e)}}function r(e,t,n){var i={name:"x-axes",type:"group",properties:{update:{width:t,height:{field:{group:"height"}},x:n?{scale:s.COLUMN,field:e.field(s.COLUMN)}:{value:0},y:{value:-e.config("cell").padding/2}}},axes:[f.compileAxis(s.X,e)]};return n&&(i.from={data:e.dataTable(),transform:{type:"facet",groupby:[e.field(s.COLUMN)]}}),i}function a(e,t,n){var i={name:"y-axes",type:"group",properties:{update:{width:{field:{group:"width"}},height:t,x:{value:-e.config("cell").padding/2},y:n?{scale:s.ROW,field:e.field(s.ROW)}:{value:0}}},axes:[f.compileAxis(s.Y,e)]};return n&&(i.from={data:e.dataTable(),transform:{type:"facet",groupby:[e.field(s.ROW)]}}),i}function o(e,t){var n=!e.has(s.X)||"top"!==e.fieldDef(s.X).axis.orient,i=e.config("cell").padding/2-1,r={name:"row-rules",type:"rule",from:{data:e.dataTable(),transform:[{type:"facet",groupby:[e.field(s.ROW)]}]},properties:{update:{y:{scale:"row",field:e.field(s.ROW),offset:(n?-1:1)*i},x:{value:0,offset:-e.config("cell").gridOffset},x2:{field:{group:"width"},offset:e.config("cell").gridOffset},stroke:{value:e.config("cell").gridColor},strokeOpacity:{value:e.config("cell").gridOpacity}}}};return n?r:{name:"row-rules-group",type:"group",properties:{update:{y:t.value?t:{field:{parent:"cellHeight"}},width:{field:{group:"width"}}}},marks:[r]}}function u(e,t){var n=!e.has(s.Y)||"right"===e.fieldDef(s.Y).axis.orient,i=e.config("cell").padding/2-1,r={name:"column-rules",type:"rule",from:{data:e.dataTable(),transform:[{type:"facet",groupby:[e.field(s.COLUMN)]}]},properties:{update:{x:{scale:"column",field:e.field(s.COLUMN),offset:(n?-1:1)*i},y:{value:0,offset:-e.config("cell").gridOffset},y2:{field:{group:"height"},offset:e.config("cell").gridOffset},stroke:{value:e.config("cell").gridColor},strokeOpacity:{value:e.config("cell").gridOpacity}}}};return n?r:{name:"column-rules-group",type:"group",properties:{update:{x:t.value?t:{field:{parent:"cellWidth"}},height:{field:{group:"height"}}}},marks:[r]}}var l=e("../util"),s=e("../channel"),f=e("./axis"),c=e("./scale");n.facetMixins=i},{"../channel":11,"../util":46,"./axis":13,"./scale":20}],17:[function(e,t,n){function i(e){var t=r(e),n=o(e);return{cellWidth:t,cellHeight:n,width:a(e,t),height:u(e,n)}}function r(e){return e.has(l.X)?e.isOrdinalScale(l.X)?{data:f.LAYOUT,field:"cellWidth"}:e.config("cell").width:e.mark()===s.TEXT?e.config("textCellWidth"):e.fieldDef(l.X).scale.bandWidth}function a(e,t){return e.has(l.COLUMN)?{data:f.LAYOUT,field:"width"}:t}function o(e){return e.has(l.Y)?e.isOrdinalScale(l.Y)?{data:f.LAYOUT,field:"cellHeight"}:e.config("cell").height:e.fieldDef(l.Y).scale.bandWidth}function u(e,t){return e.has(l.ROW)?{data:f.LAYOUT,field:"height"}:t}var l=e("../channel"),s=e("../mark"),f=e("../data");n.compileLayout=i},{"../channel":11,"../data":23,"../mark":26}],18:[function(e,t,n){function i(e){var t=[];return e.has(u.COLOR)&&e.fieldDef(u.COLOR).legend&&t.push(r(e,u.COLOR,{fill:u.COLOR})),e.has(u.SIZE)&&e.fieldDef(u.SIZE).legend&&t.push(r(e,u.SIZE,{size:u.SIZE})),e.has(u.SHAPE)&&e.fieldDef(u.SHAPE).legend&&t.push(r(e,u.SHAPE,{shape:u.SHAPE})),t}function r(e,t,n){var i=e.fieldDef(t).legend;n.title=a(e,t),["orient","format","values"].forEach(function(e){var t=i[e];void 0!==t&&(n[e]=t)});var r="boolean"!=typeof i&&i.properties||{};return["title","labels","symbols","legend"].forEach(function(i){var a=c[i]?c[i](e,t,r[i]):r[i];void 0!==a&&(n.properties=n.properties||{},n.properties[i]=a)}),n}function a(e,t){var n=e.fieldDef(t).legend;return"boolean"!=typeof n&&n.title?n.title:e.fieldTitle(t)}var o=e("../util"),u=e("../channel"),l=e("./time"),s=e("../type"),f=e("../mark");n.compileLegends=i,n.compileLegend=r,n.title=a;var c;!function(e){function t(e,t,n){var i=e.fieldDef(t),r=i.timeUnit;return i.type===s.TEMPORAL&&r&&l.labelTemplate(r)?o.extend({text:{template:"{{datum.data | "+l.labelTemplate(r)+"}}"}},n||{}):n}function n(e,t,n){var i={},r=e.mark();switch(r){case f.BAR:case f.TICK:case f.TEXT:i.stroke={value:"transparent"},i.shape={value:"square"};break;case f.CIRCLE:case f.SQUARE:i.shape={value:r};case f.POINT:e.config("marks").filled?(e.has(u.COLOR)&&t===u.COLOR?i.fill={scale:u.COLOR,field:"data"}:i.fill={value:e.fieldDef(u.COLOR).value},i.stroke={value:"transparent"}):(e.has(u.COLOR)&&t===u.COLOR?i.stroke={scale:u.COLOR,field:"data"}:i.stroke={value:e.fieldDef(u.COLOR).value},i.fill={value:"transparent"},i.strokeWidth={value:e.config("marks").strokeWidth});break;case f.LINE:case f.AREA:}var a=e.markOpacity();return a&&(i.opacity={value:a}),i=o.extend(i,n||{}),o.keys(i).length>0?i:void 0}e.labels=t,e.symbols=n}(c||(c={}))},{"../channel":11,"../mark":26,"../type":45,"../util":46,"./time":22}],19:[function(e,t,n){function i(e){var t=e.mark();if(t===u.LINE||t===u.AREA){var n=t===u.LINE?e.config("sortLineBy"):void 0;if(!n){var i=e.isMeasure(o.X)&&e.isDimension(o.Y)?o.Y:o.X;n="-"+e.field(i)}var r={type:f[t],from:{transform:[{type:"sort",by:n}]},properties:{update:c[t](e)}},l=a(e);if(l.length>0){var d={type:"facet",groupby:l},p=t===u.AREA&&e.stack()?[s.imputeTransform(e),s.stackTransform(e),d]:[d];return[{name:t+"-facet",type:"group",from:{transform:p},properties:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:[r]}]}return[r]}var h=[];t===u.TEXT&&e.has(o.COLOR)&&h.push({type:"rect",properties:{update:c.textBackground(e)}});var m={type:f[t],properties:{update:c[t](e)}},g=e.stack();return t===u.BAR&&g&&(m.from={transform:[s.stackTransform(e)]}),h.push(m),h}function r(e,t,n){n.forEach(function(n){var i=t[n];void 0!==i&&(e[n]={value:i})})}function a(e){return[o.COLOR,o.DETAIL,o.SHAPE].reduce(function(t,n){return e.has(n)&&!e.fieldDef(n).aggregate&&t.push(e.field(n)),t},[])}var o=e("../channel"),u=e("../mark"),l=e("../type"),s=e("./stack"),f={bar:"rect",tick:"rect",point:"symbol",line:"line",area:"area",text:"text",circle:"symbol",square:"symbol"};n.compileMarks=i;var c;!function(e){function t(e){var t=e.stack(),n={};t&&o.X===t.fieldChannel?(n.x={scale:o.X,field:e.field(o.X)+"_start"},n.x2={scale:o.X,field:e.field(o.X)+"_end"}):e.fieldDef(o.X).bin?(n.x={scale:o.X,field:e.field(o.X,{binSuffix:"_start"}),offset:1},n.x2={scale:o.X,field:e.field(o.X,{binSuffix:"_end"})}):e.isMeasure(o.X)?(n.x={scale:o.X,field:e.field(o.X)},(!e.has(o.Y)||e.isDimension(o.Y))&&(n.x2={value:0})):e.has(o.X)?n.xc={scale:o.X,field:e.field(o.X)}:n.x={value:0,offset:e.config("singleBarOffset")},n.x2||(!e.has(o.X)||e.isOrdinalScale(o.X)?e.has(o.SIZE)?n.width={scale:o.SIZE,field:e.field(o.SIZE)}:n.width={value:e.fieldDef(o.X).scale.bandWidth,offset:-1}:n.width={value:2}),t&&o.Y===t.fieldChannel?(n.y={scale:o.Y,field:e.field(o.Y)+"_start"},n.y2={scale:o.Y,field:e.field(o.Y)+"_end"}):e.fieldDef(o.Y).bin?(n.y={scale:o.Y,field:e.field(o.Y,{binSuffix:"_start"})},n.y2={scale:o.Y,field:e.field(o.Y,{binSuffix:"_end"}),offset:1}):e.isMeasure(o.Y)?(n.y={scale:o.Y,field:e.field(o.Y)},n.y2={field:{group:"height"}}):(e.has(o.Y)?n.yc={scale:o.Y,field:e.field(o.Y)}:n.y2={field:{group:"height"},offset:-e.config("singleBarOffset")},e.has(o.SIZE)?n.height={scale:o.SIZE,field:e.field(o.SIZE)}:n.height={value:e.fieldDef(o.Y).scale.bandWidth,offset:-1}),e.has(o.COLOR)?n.fill={scale:o.COLOR,field:e.field(o.COLOR)}:n.fill={value:e.fieldDef(o.COLOR).value};var i=e.markOpacity();return i&&(n.opacity={value:i}),n}function n(e){var t={},n=e.config("marks");e.has(o.X)?t.x={scale:o.X,field:e.field(o.X,{binSuffix:"_mid"})}:e.has(o.X)||(t.x={value:e.fieldDef(o.X).scale.bandWidth/2}),e.has(o.Y)?t.y={scale:o.Y,field:e.field(o.Y,{binSuffix:"_mid"})}:e.has(o.Y)||(t.y={value:e.fieldDef(o.Y).scale.bandWidth/2}),e.has(o.SIZE)?t.size={scale:o.SIZE,field:e.field(o.SIZE)}:e.has(o.SIZE)||(t.size={value:e.fieldDef(o.SIZE).value}),e.has(o.SHAPE)?t.shape={scale:o.SHAPE,field:e.field(o.SHAPE)}:e.has(o.SHAPE)||(t.shape={value:e.fieldDef(o.SHAPE).value}),n.filled?e.has(o.COLOR)?t.fill={scale:o.COLOR,field:e.field(o.COLOR)}:e.has(o.COLOR)||(t.fill={value:e.fieldDef(o.COLOR).value}):(e.has(o.COLOR)?t.stroke={scale:o.COLOR,field:e.field(o.COLOR)}:e.has(o.COLOR)||(t.stroke={value:e.fieldDef(o.COLOR).value}),t.strokeWidth={value:e.config("marks").strokeWidth});var i=e.markOpacity();return i&&(t.opacity={value:i}),t}function i(e){var t={};e.has(o.X)?t.x={scale:o.X,field:e.field(o.X,{binSuffix:"_mid"})}:e.has(o.X)||(t.x={value:0}),e.has(o.Y)?t.y={scale:o.Y,field:e.field(o.Y,{binSuffix:"_mid"})}:e.has(o.Y)||(t.y={field:{group:"height"}}),e.has(o.COLOR)?t.stroke={scale:o.COLOR,field:e.field(o.COLOR)}:e.has(o.COLOR)||(t.stroke={value:e.fieldDef(o.COLOR).value});var n=e.markOpacity();return n&&(t.opacity={value:n}),t.strokeWidth={value:e.config("marks").strokeWidth},r(t,e.config("marks"),["interpolate","tension"]),t}function a(e){var t=e.stack(),n={};t&&o.X===t.fieldChannel?(n.x={scale:o.X,field:e.field(o.X)+"_start"},n.x2={scale:o.X,field:e.field(o.X)+"_end"}):e.isMeasure(o.X)?(n.x={scale:o.X,field:e.field(o.X)},e.isDimension(o.Y)&&(n.x2={scale:o.X,value:0},n.orient={value:"horizontal"})):e.has(o.X)?n.x={scale:o.X,field:e.field(o.X,{binSuffix:"_mid"})}:n.x={value:0},t&&o.Y===t.fieldChannel?(n.y={scale:o.Y,field:e.field(o.Y)+"_start"},n.y2={scale:o.Y,field:e.field(o.Y)+"_end"}):e.isMeasure(o.Y)?(n.y={scale:o.Y,field:e.field(o.Y)},n.y2={scale:o.Y,value:0}):e.has(o.Y)?n.y={scale:o.Y,field:e.field(o.Y,{binSuffix:"_mid"})}:n.y={field:{group:"height"}},e.has(o.COLOR)?n.fill={scale:o.COLOR,field:e.field(o.COLOR)}:e.has(o.COLOR)||(n.fill={value:e.fieldDef(o.COLOR).value});var i=e.markOpacity();return i&&(n.opacity={value:i}),r(n,e.config("marks"),["interpolate","tension"]),n}function u(e){var t={};e.has(o.X)?(t.x={scale:o.X,field:e.field(o.X,{binSuffix:"_mid"})},e.isDimension(o.X)&&(t.x.offset=-e.fieldDef(o.X).scale.bandWidth/3)):e.has(o.X)||(t.x={value:0}),e.has(o.Y)?(t.y={scale:o.Y,field:e.field(o.Y,{binSuffix:"_mid"})},e.isDimension(o.Y)&&(t.y.offset=-e.fieldDef(o.Y).scale.bandWidth/3)):e.has(o.Y)||(t.y={value:0}),!e.has(o.X)||e.isDimension(o.X)?t.width={value:e.fieldDef(o.X).scale.bandWidth/1.5}:t.width={value:1},!e.has(o.Y)||e.isDimension(o.Y)?t.height={value:e.fieldDef(o.Y).scale.bandWidth/1.5}:t.height={value:1},e.has(o.COLOR)?t.fill={scale:o.COLOR,field:e.field(o.COLOR)}:t.fill={value:e.fieldDef(o.COLOR).value};var n=e.markOpacity();return n&&(t.opacity={value:n}),t}function s(e){return function(t){var n={};t.has(o.X)?n.x={scale:o.X,field:t.field(o.X,{binSuffix:"_mid"})}:t.has(o.X)||(n.x={value:t.fieldDef(o.X).scale.bandWidth/2}),t.has(o.Y)?n.y={scale:o.Y,field:t.field(o.Y,{binSuffix:"_mid"})}:t.has(o.Y)||(n.y={value:t.fieldDef(o.Y).scale.bandWidth/2}),t.has(o.SIZE)?n.size={scale:o.SIZE,field:t.field(o.SIZE)}:t.has(o.X)||(n.size={value:t.fieldDef(o.SIZE).value}),n.shape={value:e},t.has(o.COLOR)?n.fill={scale:o.COLOR,field:t.field(o.COLOR)}:t.has(o.COLOR)||(n.fill={value:t.fieldDef(o.COLOR).value});var i=t.markOpacity();return i&&(n.opacity={value:i}),n}}function f(e){return{x:{value:0},y:{value:0},width:{field:{group:"width"}},height:{field:{group:"height"}},fill:{scale:o.COLOR,field:e.field(o.COLOR)}}}function c(e){var t={},n=e.fieldDef(o.TEXT),i=e.config("marks");e.has(o.X)?t.x={scale:o.X,field:e.field(o.X,{binSuffix:"_mid"})}:e.has(o.X)||(e.has(o.TEXT)&&e.fieldDef(o.TEXT).type===l.QUANTITATIVE?t.x={field:{group:"width"},offset:-5}:t.x={value:e.fieldDef(o.X).scale.bandWidth/2}),e.has(o.Y)?t.y={scale:o.Y,field:e.field(o.Y,{binSuffix:"_mid"})}:e.has(o.Y)||(t.y={value:e.fieldDef(o.Y).scale.bandWidth/2}),e.has(o.SIZE)?t.fontSize={scale:o.SIZE,field:e.field(o.SIZE)}:e.has(o.SIZE)||(t.fontSize={value:i.fontSize});var a=e.markOpacity();if(a&&(t.opacity={value:a}),e.has(o.TEXT))if(e.fieldDef(o.TEXT).type===l.QUANTITATIVE){var u=void 0!==i.format?i.format:e.numberFormat(o.TEXT);t.text={template:"{{"+e.field(o.TEXT,{datum:!0})+" | number:'"+u+"'}}"}}else t.text={field:e.field(o.TEXT)};else t.text={value:n.value};return r(t,i,["angle","align","baseline","dx","dy","fill","font","fontWeight","fontStyle","radius","theta"]),t}e.bar=t,e.point=n,e.line=i,e.area=a,e.tick=u,e.circle=s("circle"),e.square=s("square"),e.textBackground=f,e.text=c}(c=n.properties||(n.properties={}))},{"../channel":11,"../mark":26,"../type":45,"./stack":21}],20:[function(e,t,n){function i(e,t){return e.reduce(function(e,i){var o={name:i,type:r(i,t)};return o.domain=a(t,i,o.type),b.extend(o,g(t,i,o.type)),["reverse","round","clamp","nice","exponent","zero","bandWidth","outerPadding","padding","points"].forEach(function(e){var r=n[e](t,i,o.type);void 0!==r&&(o[e]=r)}),e.push(o),e},[])}function r(e,t){var n=t.fieldDef(e);switch(n.type){case M.NOMINAL:return"ordinal";case M.ORDINAL:var i=n.scale.range;return e===T.COLOR&&"string"!=typeof i?"linear":"ordinal";case M.TEMPORAL:return A.scale.type(n.timeUnit,e);case M.QUANTITATIVE:return t.bin(e)?e===T.ROW||e===T.COLUMN||e===T.SHAPE?"ordinal":"linear":n.scale.type}}function a(e,t,n){var i=e.fieldDef(t);if(i.scale.domain)return i.scale.domain;if(i.type===M.TEMPORAL){var r=A.scale.domain(i.timeUnit,t);if(r)return r}var a=e.stack();if(a&&t===a.fieldChannel){var u=e.has(T.ROW)||e.has(T.COLUMN);return{data:x.STACKED,field:e.field(t,{prefn:(u?"max_":"")+"sum_"})}}var s=l(e,t),f=o(e,t,n);return s?{data:x.SOURCE,field:e.field(t,{noAggregate:!0})}:i.bin?{data:e.dataTable(),field:"ordinal"===n?e.field(t,{binSuffix:"_start"}):[e.field(t,{binSuffix:"_start"}),e.field(t,{binSuffix:"_end"})]}:f?{data:f.op?x.SOURCE:e.dataTable(),field:e.field(t),sort:f}:{data:e.dataTable(),field:e.field(t)}}function o(e,t,n){var i=e.fieldDef(t).sort;return"ascending"===i||"descending"===i?!0:"ordinal"===n&&"string"!=typeof i?{op:i.op,field:i.field}:void 0}function u(e,t){var n=e.fieldDef(t).sort;return n&&("string"==typeof n?"descending"===n:"descending"===n.order)?!0:void 0}function l(e,t){var n=e.fieldDef(t);return n.scale.useRawDomain&&n.aggregate&&O.SHARED_DOMAIN_OPS.indexOf(n.aggregate)>=0&&(n.type===M.QUANTITATIVE&&!n.bin||n.type===M.TEMPORAL&&(!n.timeUnit||"linear"===A.scale.type(n.timeUnit,t)))}function s(e,t,n){return"ordinal"===n?e.fieldDef(t).scale.bandWidth:void 0}function f(e,t){return e.fieldDef(t).scale.clamp}function c(e,t){return e.fieldDef(t).scale.exponent}function d(e,t,n){if(void 0!==e.fieldDef(t).scale.nice)return e.fieldDef(t).scale.nice;switch(t){case T.X:case T.Y:if("time"===n||"ordinal"===n)return;return!0;case T.ROW:case T.COLUMN:return!0}}function p(e,t,n){return"ordinal"===n&&void 0!==e.fieldDef(t).scale.outerPadding?e.fieldDef(t).scale.outerPadding:void 0}function h(e,t,n){return"ordinal"===n?e.fieldDef(t).scale.padding:void 0}function m(e,t,n){if("ordinal"===n){if(void 0!==e.fieldDef(t).scale.points)return e.fieldDef(t).scale.points;switch(t){case T.X:case T.Y:return!0}}}function g(e,t,n){var i=e.fieldDef(t);if(i.scale.range)return{range:i.scale.range};switch(t){case T.X:return{rangeMin:0,rangeMax:e.layout().cellWidth};case T.Y:return"ordinal"===n?{rangeMin:0,rangeMax:e.layout().cellHeight}:{rangeMin:e.layout().cellHeight,rangeMax:0};case T.SIZE:if(e.is(E.BAR))return{range:[3,Math.max(e.fieldDef(T.X).scale.bandWidth,e.fieldDef(T.Y).scale.bandWidth)]};if(e.is(E.TEXT))return{range:[8,40]};var r=Math.min(e.fieldDef(T.X).scale.bandWidth,e.fieldDef(T.Y).scale.bandWidth)-1;return{range:[10,.8*r*r]};case T.SHAPE:return{range:"shapes"};case T.COLOR:return"ordinal"===n?{range:"category10"}:{range:["#AFC6A3","#09622A"]};case T.ROW:return{range:"height"};case T.COLUMN:return{range:"width"}}return{}}function y(e,t){if(void 0!==e.fieldDef(t).scale.round)return e.fieldDef(t).scale.round;switch(t){case T.X:case T.Y:case T.ROW:case T.COLUMN:case T.SIZE:return!0}}function v(e,t){var n=e.fieldDef(t),i=n.timeUnit;return void 0!==n.scale.zero?n.scale.zero:n.type!==M.TEMPORAL?n.bin?!1:t===T.X||t===T.Y?void 0:!1:"year"===i?!1:void 0}var b=e("../util"),O=e("../aggregate"),T=e("../channel"),x=e("../data"),A=e("./time"),M=e("../type"),E=e("../mark");n.compileScales=i,n.type=r,n.domain=a,n.domainSort=o,n.reverse=u,n._useRawDomain=l,n.bandWidth=s,n.clamp=f,n.exponent=c,n.nice=d,n.outerPadding=p,n.padding=h,n.points=m,n.rangeMixins=g,n.round=y,n.zero=v},{"../aggregate":9,"../channel":11,"../data":23,"../mark":26,"../type":45,"../util":46,"./time":22}],21:[function(e,t,n){function i(e){var t=e.stack();return{type:"impute",field:e.field(t.fieldChannel),groupby:[e.field(t.stackChannel)],orderby:[e.field(t.groupbyChannel)],method:"value",value:0}}function r(e){var t=e.stack(),n="descending"===t.config.sort?"-"+e.field(t.stackChannel):"ascending"===t.config.sort?e.field(t.stackChannel):a.isObject(t.config.sort)?t.config.sort:"-"+e.field(t.stackChannel),i=e.field(t.fieldChannel),r={type:"stack",groupby:[e.field(t.groupbyChannel)],field:e.field(t.fieldChannel),sortby:n,output:{start:i+"_start",end:i+"_end"}};return t.config.offset&&(r.offset=t.config.offset),r}var a=e("../util");n.imputeTransform=i,n.stackTransform=r},{"../util":46}],22:[function(e,t,n){function i(e,t,n,i){var r=e.timeUnit;switch(r){case"seconds":return 60;case"minutes":return 60;case"hours":return 24;case"day":return 7;case"date":return 31;case"month":return 12;case"year":var a=t[e.field],o=t["year_"+e.field];return o?o.distinct-(a.missing>0&&n[i]?1:0):null}return null}function r(e,t){var n="utc"+e;return n+"("+t+")"}function a(e,t){void 0===t&&(t=!1);var n=t?"-abbrev":"";switch(e){case"day":return"day"+n;case"month":return"month"+n}return null}var o=e("../util"),u=e("../channel");n.cardinality=i,n.formula=r;var l;!function(e){function t(e,t){if(t===u.COLOR)return"linear";if(t===u.COLUMN||t===u.ROW)return"ordinal";switch(e){case"hours":case"day":case"date":case"month":return"ordinal";case"year":case"second":case"minute":return"linear"}return"time"}function n(e,t){var n=t===u.COLOR;switch(e){case"seconds":case"minutes":return n?[0,59]:o.range(0,60);case"hours":return n?[0,23]:o.range(0,24);case"day":return n?[0,6]:o.range(0,7);case"date":return n?[1,31]:o.range(1,32);case"month":return n?[0,11]:o.range(0,12)}return null}e.type=t,e.domain=n}(l=n.scale||(n.scale={})),n.labelTemplate=a},{"../channel":11,"../util":46}],23:[function(e,t,n){var i=e("./type");n.SUMMARY="summary",n.SOURCE="source",n.STACKED="stacked",n.LAYOUT="layout",n.types={"boolean":i.NOMINAL,number:i.QUANTITATIVE,integer:i.QUANTITATIVE,date:i.TEMPORAL,string:i.NOMINAL}},{"./type":45}],24:[function(e,t,n){function i(e){var t=0;return e.color&&t++,e.size&&t++,e.shape&&t++,t}function r(e,t){var n=e&&e[t];return n&&n.field}function a(e){for(var t in e)if(r(e,t)&&e[t].aggregate)return!0;return!1}function o(e){var t=[];return f.CHANNELS.forEach(function(n){r(e,n)&&t.push(e[n])}),t}function u(e,t){var n=0;f.CHANNELS.forEach(function(i){r(e,i)&&t(e[i],i,n++)})}function l(e,t){var n=[];return f.CHANNELS.forEach(function(i){r(e,i)&&n.push(t(e[i],i,e))}),n}function s(e,t,n){var i=n;return f.CHANNELS.forEach(function(n){r(e,n)&&(i=t(i,e[n],n,e))}),i}var f=e("./channel");n.countRetinal=i,n.has=r,n.isAggregate=a,n.fieldDefs=o,n.forEach=u,n.map=l,n.reduce=s},{"./channel":11}],25:[function(e,t,n){function i(e){return f.contains([d.NOMINAL,d.ORDINAL],e.type)||!!e.bin||e.type===d.TEMPORAL&&!!e.timeUnit}function r(e){return e&&i(e)}function a(e){return e&&!i(e)}function o(){return{field:"*",aggregate:"count",type:d.QUANTITATIVE,displayName:n.COUNT_DISPLAYNAME}}function u(e){return"count"===e.aggregate}function l(e,t,n){void 0===n&&(n={});var i=t[e.field],r=e.type;if(e.bin){var a=e.bin,o="boolean"==typeof a?s.MAXBINS_DEFAULT:a.maxbins,u=f.getbins(i,o);return(u.stop-u.start)/u.step}if(e.type===d.TEMPORAL){var l=c.cardinality(e,t,n,r);if(null!==l)return l}return e.aggregate?1:i.distinct-(i.missing>0&&n[r]?1:0)}var s=e("./bin"),f=e("./util"),c=e("./compiler/time"),d=e("./type");n.isDimension=r,n.isMeasure=a,n.count=o,n.COUNT_DISPLAYNAME="Number of Records",n.isCount=u,n.cardinality=l},{"./bin":10,"./compiler/time":22,"./type":45,"./util":46}],26:[function(e,t,n){!function(e){e[e.AREA="area"]="AREA",e[e.BAR="bar"]="BAR",e[e.LINE="line"]="LINE",e[e.POINT="point"]="POINT",e[e.TEXT="text"]="TEXT",e[e.TICK="tick"]="TICK",e[e.CIRCLE="circle"]="CIRCLE",e[e.SQUARE="square"]="SQUARE"}(n.Mark||(n.Mark={}));var i=n.Mark;n.AREA=i.AREA,n.BAR=i.BAR,n.LINE=i.LINE,n.POINT=i.POINT,n.TEXT=i.TEXT,n.TICK=i.TICK,n.CIRCLE=i.CIRCLE,n.SQUARE=i.SQUARE},{}],27:[function(e,t,n){n.axis={type:"object",properties:{format:{type:"string","default":void 0,description:"The formatting pattern for axis labels. If not undefined, this will be determined by the max value of the field."},grid:{type:"boolean","default":void 0,description:"A flag indicate if gridlines should be created in addition to ticks. If `grid` is unspecified, the default value is `true` for ROW and COL. For X and Y, the default value is `true` for quantitative and time fields and `false` otherwise."},layer:{type:"string","default":void 0,description:"A string indicating if the axis (and any gridlines) should be placed above or below the data marks."},orient:{type:"string","default":void 0,"enum":["top","right","left","bottom"],description:"The orientation of the axis. One of top, bottom, left or right. The orientation can be used to further specialize the axis type (e.g., a y axis oriented for the right edge of the chart)."},ticks:{type:"integer","default":void 0,minimum:0,description:'A desired number of ticks, for axes visualizing quantitative scales. The resulting number may be different so that values are "nice" (multiples of 2, 5, 10) and lie within the underlying scale\'s range.'},title:{type:"string","default":void 0,description:"A title for the axis. (Shows field name and its function by default.)"},labelMaxLength:{type:"integer","default":25,minimum:0,description:"Truncate labels that are too long."},titleMaxLength:{type:"integer","default":void 0,minimum:0,description:"Max length for axis title if the title is automatically generated from the field's description"},titleOffset:{type:"integer","default":void 0,description:"A title offset value for the axis."},shortTimeNames:{type:"boolean","default":!1,description:"Whether month names and weekday names should be abbreviated."},properties:{type:"object","default":void 0,description:"Optional mark property definitions for custom axis styling."}}}},{}],28:[function(e,t,n){var i=e("../bin"),r=e("../type"),a=e("../util");n.bin={type:["boolean","object"],"default":!1,properties:{maxbins:{type:"integer","default":i.MAXBINS_DEFAULT,minimum:2,description:"Maximum number of bins."}},supportedTypes:a.toMap([r.QUANTITATIVE])}},{"../bin":10,"../type":45,"../util":46}],29:[function(e,t,n){n.cellConfig={type:"object",properties:{width:{type:"integer","default":200},height:{type:"integer","default":200},padding:{type:"integer","default":16,description:"default padding between facets."},gridColor:{type:"string",role:"color","default":"#000000"},gridOpacity:{type:"number",minimum:0,maximum:1,"default":.25},gridOffset:{type:"number","default":6},fill:{type:"string",role:"color","default":"rgba(0,0,0,0)"},fillOpacity:{type:"number"},stroke:{type:"string",role:"color"},strokeWidth:{
type:"integer"},strokeOpacity:{type:"number"},strokeDash:{type:"array","default":void 0},strokeDashOffset:{type:"integer",description:"The offset (in pixels) into which to begin drawing with the stroke dash array."}}}},{}],30:[function(e,t,n){n.marksConfig={type:"object",properties:{filled:{type:"boolean","default":!1,description:"Whether the shape's color should be used as fill color instead of stroke color."},format:{type:"string","default":"",description:"The formatting pattern for text value.If not defined, this will be determined automatically"},fill:{type:"string",role:"color","default":"#000000"},opacity:{type:"number","default":void 0,minimum:0,maximum:1},strokeWidth:{type:"integer","default":2,minimum:0},strokeDash:{type:"array","default":void 0,description:"An array of alternating stroke, space lengths for creating dashed or dotted lines."},strokeDashOffset:{type:"array","default":void 0,description:"The offset (in pixels) into which to begin drawing with the stroke dash array."},orient:{type:"string","default":void 0,description:"The orientation of this area mark. One of horizontal (the default) or vertical."},interpolate:{type:"string","default":void 0,description:"The line interpolation method to use. One of linear, step-before, step-after, basis, basis-open, basis-closed, bundle, cardinal, cardinal-open, cardinal-closed, monotone."},tension:{type:"number","default":void 0,description:"Depending on the interpolation type, sets the tension parameter."},align:{type:"string","default":"right","enum":["left","right","center"],description:"The horizontal alignment of the text. One of left, right, center."},angle:{type:"number","default":void 0,description:"The rotation angle of the text, in degrees."},baseline:{type:"string","default":"middle","enum":["top","middle","bottom"],description:"The vertical alignment of the text. One of top, middle, bottom."},dx:{type:"number","default":void 0,description:"The horizontal offset, in pixels, between the text label and its anchor point. The offset is applied after rotation by the angle property."},dy:{type:"number","default":void 0,description:"The vertical offset, in pixels, between the text label and its anchor point. The offset is applied after rotation by the angle property."},font:{type:"string","default":void 0,role:"font",description:"The typeface to set the text in (e.g., Helvetica Neue)."},fontStyle:{type:"string","default":void 0,"enum":["normal","italic"],description:"The font style (e.g., italic)."},fontWeight:{type:"string","enum":["normal","bold"],"default":void 0,description:"The font weight (e.g., bold)."},radius:{type:"number","default":void 0,description:"Polar coordinate radial offset, in pixels, of the text label from the origin determined by the x and y properties."},theta:{type:"number","default":void 0,description:'Polar coordinate angle, in radians, of the text label from the origin determined by the x and y properties. Values for theta follow the same convention of arc mark startAngle and endAngle properties: angles are measured in radians, with 0 indicating "north".'}}}},{}],31:[function(e,t,n){var i=e("./config.stack.schema"),r=e("./config.cell.schema"),a=e("./config.marks.schema");n.config={type:"object",properties:{viewport:{type:"array",items:{type:"integer"},"default":void 0,description:"The width and height of the on-screen viewport, in pixels. If necessary, clipping and scrolling will be applied."},background:{type:"string",role:"color","default":void 0,description:'CSS color property to use as background of visualization. Default is `"transparent"`.'},scene:{type:"object","default":void 0,description:"An object to style the top-level scenegraph root. Available properties include `fill`, `fillOpacity`, `stroke`, `strokeOpacity`, `strokeWidth`, `strokeDash`, `strokeDashOffset`"},filterNull:{type:"object",properties:{nominal:{type:"boolean","default":!1},ordinal:{type:"boolean","default":!1},quantitative:{type:"boolean","default":!0},temporal:{type:"boolean","default":!0}}},textCellWidth:{type:"integer","default":90,minimum:0},sortLineBy:{type:"string","default":void 0,description:"Data field to sort line by. '-' prefix can be added to suggest descending order."},stack:i.stackConfig,cell:r.cellConfig,marks:a.marksConfig,singleBarOffset:{type:"integer","default":5,minimum:0},characterWidth:{type:"integer","default":6},numberFormat:{type:"string","default":"s",description:"D3 Number format for axis labels and text tables."},timeFormat:{type:"string","default":"%Y-%m-%d",description:"Date format for axis labels."}}}},{"./config.cell.schema":29,"./config.marks.schema":30,"./config.stack.schema":32}],32:[function(e,t,n){n.stackConfig={type:["boolean","object"],"default":{},description:"Enable stacking (for bar and area marks only).",properties:{sort:{oneOf:[{type:"string","enum":["ascending","descending"]},{type:"array",items:{type:"string"}}],description:'Order of the stack. This can be either a string (either "descending" or "ascending")or a list of fields to determine the order of stack layers.By default, stack uses descending order.'},offset:{type:"string","enum":["zero","center","normalize"]}}}},{}],33:[function(e,t,n){n.data={type:"object",properties:{formatType:{type:"string","enum":["json","csv","tsv"],"default":"json"},url:{type:"string","default":void 0},values:{type:"array","default":void 0,description:"Pass array of objects instead of a url to a file.",items:{type:"object",additionalProperties:!0}},filter:{type:"string","default":void 0,description:"A string containing the filter Vega expression. Use `datum` to refer to the current data object."},calculate:{type:"array","default":void 0,description:"Calculate new field(s) using the provided expresssion(s). Calculation are applied before filter.",items:{type:"object",properties:{field:{type:"string",description:"The field in which to store the computed formula value."},expr:{type:"string",description:"A string containing an expression for the formula. Use the variable `datum` to to refer to the current data object."}}}}}}},{}],34:[function(e,t,n){var i=e("./schemautil"),r=e("../util"),a=e("./axis.schema"),o=e("./legend.schema"),u=e("./sort.schema"),l=e("./fielddef.schema"),s={required:["field","type"]},f=i.merge(r.duplicate(l.typicalField),s,{properties:{scale:{properties:{padding:{"default":1},bandWidth:{"default":21}}},axis:a.axis,sort:u.sort}}),c=r.duplicate(f),d=i.merge(r.duplicate(l.onlyOrdinalField),s,{properties:{axis:a.axis,sort:u.sort}}),p=i.merge(r.duplicate(d)),h=i.merge(r.duplicate(d)),m=i.merge(r.duplicate(l.typicalField),{properties:{legend:o.legend,sort:u.sort,value:{type:"integer","default":30,minimum:0,description:"Size of marks."}}}),g=i.merge(r.duplicate(l.typicalField),{properties:{legend:o.legend,sort:u.sort,value:{type:"string",role:"color","default":"#4682b4",description:"Color to be used for marks."},scale:{type:"object",properties:{quantitativeRange:{type:"array","default":["#AFC6A3","#09622A"],description:"Color range to encode quantitative variables.",minItems:2,maxItems:2,items:{type:"string",role:"color"}}}}}}),y=i.merge(r.duplicate(l.onlyOrdinalField),{properties:{legend:o.legend,sort:u.sort,value:{type:"string","enum":["circle","square","cross","diamond","triangle-up","triangle-down"],"default":"circle",description:"Mark to be used."}}}),v=i.merge(r.duplicate(l.onlyOrdinalField),{properties:{sort:u.sort}}),b=i.merge(r.duplicate(l.typicalField),{properties:{sort:u.sort,value:{type:"string","default":"Abc"}}});n.encoding={type:"object",properties:{x:f,y:c,row:p,column:h,size:m,color:g,shape:y,text:b,detail:v}}},{"../util":46,"./axis.schema":27,"./fielddef.schema":35,"./legend.schema":36,"./schemautil":40,"./sort.schema":41}],35:[function(e,t,n){var i=e("./bin.schema"),r=e("./scale.schema"),a=e("../aggregate"),o=e("../util"),u=e("./schemautil"),l=e("../timeunit"),s=e("../type");n.fieldDef={type:"object",properties:{field:{type:"string"},type:{type:"string","enum":[s.NOMINAL,s.ORDINAL,s.QUANTITATIVE,s.TEMPORAL]},timeUnit:{type:"string","enum":l.TIMEUNITS,supportedTypes:o.toMap([s.TEMPORAL])},bin:i.bin}},n.aggregate={type:"string","enum":a.AGGREGATE_OPS,supportedEnums:{quantitative:a.AGGREGATE_OPS,ordinal:["median","min","max"],nominal:[],temporal:["mean","median","min","max"],"":["count"]},supportedTypes:o.toMap([s.QUANTITATIVE,s.NOMINAL,s.ORDINAL,s.TEMPORAL,""])},n.typicalField=u.merge(o.duplicate(n.fieldDef),{properties:{aggregate:n.aggregate,scale:r.typicalScale}}),n.onlyOrdinalField=u.merge(o.duplicate(n.fieldDef),{properties:{scale:r.ordinalOnlyScale}})},{"../aggregate":9,"../timeunit":44,"../type":45,"../util":46,"./bin.schema":28,"./scale.schema":38,"./schemautil":40}],36:[function(e,t,n){n.legend={"default":!0,description:"Properties of a legend or boolean flag for determining whether to show it.",oneOf:[{type:"object",properties:{orient:{type:"string","default":void 0,description:'The orientation of the legend. One of "left" or "right". This determines how the legend is positioned within the scene. The default is "right".'},title:{type:"string","default":void 0,description:"A title for the legend. (Shows field name and its function by default.)"},format:{type:"string","default":void 0,description:"An optional formatting pattern for legend labels. Vega uses D3's format pattern."},values:{type:"array","default":void 0,description:"Explicitly set the visible legend values."},properties:{type:"object","default":void 0,description:"Optional mark property definitions for custom legend styling. "}}},{type:"boolean"}]}},{}],37:[function(e,t,n){n.mark={type:"string","enum":["point","tick","bar","line","area","circle","square","text"]}},{}],38:[function(e,t,n){var i=e("../util"),r=e("./schemautil"),a=e("../type"),o={type:"object",properties:{type:{type:"string","enum":["linear","log","pow","sqrt","quantile"],"default":"linear",supportedTypes:i.toMap([a.QUANTITATIVE])},domain:{"default":void 0,type:["array","object"],description:"The domain of the scale, representing the set of data values. For quantitative data, this can take the form of a two-element array with minimum and maximum values. For ordinal/categorical data, this may be an array of valid input values. The domain may also be specified by a reference to a data source."},range:{"default":void 0,type:["array","object","string"],description:"The range of the scale, representing the set of visual values. For numeric values, the range can take the form of a two-element array with minimum and maximum values. For ordinal or quantized data, the range may by an array of desired output values, which are mapped to elements in the specified domain. For ordinal scales only, the range can be defined using a DataRef: the range values are then drawn dynamically from a backing data set."},round:{"default":void 0,type:"boolean",description:"If true, rounds numeric output values to integers. This can be helpful for snapping to the pixel grid."}}},u={properties:{bandWidth:{type:"integer",minimum:0,"default":void 0},outerPadding:{type:"number","default":void 0},padding:{type:"number","default":void 0,description:"Applies spacing among ordinal elements in the scale range. The actual effect depends on how the scale is configured. If the __points__ parameter is `true`, the padding value is interpreted as a multiple of the spacing between points. A reasonable value is 1.0, such that the first and last point will be offset from the minimum and maximum value by half the distance between points. Otherwise, padding is typically in the range [0, 1] and corresponds to the fraction of space in the range interval to allocate to padding. A value of 0.5 means that the range band width will be equal to the padding width. For more, see the [D3 ordinal scale documentation](https://github.com/mbostock/d3/wiki/Ordinal-Scales)."},points:{type:"boolean","default":void 0,description:"If true, distributes the ordinal values over a quantitative range at uniformly spaced points. The spacing of the points can be adjusted using the padding property. If false, the ordinal scale will construct evenly-spaced bands, rather than points."}}},l={properties:{clamp:{type:"boolean","default":!0,description:"If true, values that exceed the data domain are clamped to either the minimum or maximum range value"},nice:{"default":void 0,oneOf:[{type:"boolean",description:"If true, modifies the scale domain to use a more human-friendly number range (e.g., 7 instead of 6.96)."},{type:"string","enum":["second","minute","hour","day","week","month","year"],description:'If specified, modifies the scale domain to use a more human-friendly value range. For time and utc scale types only, the nice value should be a string indicating the desired time interval; legal values are "second", "minute", "hour", "day", "week", "month", or "year".'}],supportedTypes:i.toMap([a.QUANTITATIVE,a.TEMPORAL]),description:""},exponent:{type:"number","default":void 0,description:"Sets the exponent of the scale transformation. For pow scale types only, otherwise ignored."},zero:{type:"boolean",description:"If true, ensures that a zero baseline value is included in the scale domain. This option is ignored for non-quantitative scales.","default":void 0,supportedTypes:i.toMap([a.QUANTITATIVE,a.TEMPORAL])},useRawDomain:{type:"boolean","default":!1,description:"Uses the source data range as scale domain instead of aggregated data for aggregate axis. This option does not work with sum or count aggregateas they might have a substantially larger scale range."}}};n.ordinalOnlyScale=r.merge(i.duplicate(o),u),n.typicalScale=r.merge(i.duplicate(o),u,l)},{"../type":45,"../util":46,"./schemautil":40}],39:[function(e,t,n){function i(){return r.instantiate(n.schema)}var r=e("./schemautil"),a=e("./mark.schema"),o=e("./config.schema"),u=e("./data.schema"),l=e("./encoding.schema"),s=e("./fielddef.schema");n.aggregate=s.aggregate,n.util=r,n.schema={$schema:"http://json-schema.org/draft-04/schema#",description:"Schema for Vega-lite specification",type:"object",required:["mark","encoding"],properties:{name:{type:"string"},description:{type:"string"},data:u.data,mark:a.mark,encoding:l.encoding,config:o.config}},n.instantiate=i},{"./config.schema":31,"./data.schema":33,"./encoding.schema":34,"./fielddef.schema":35,"./mark.schema":37,"./schemautil":40}],40:[function(e,t,n){function i(e){return 0===Object.keys(e).length}function r(e,t){return u(a(t),e)}function a(e){var t;if(void 0!==e){if("default"in e)return t=e["default"],s.isObject(t)?s.duplicate(t):t;if("object"===e.type){var n={};for(var i in e.properties)t=a(e.properties[i]),void 0!==t&&(n[i]=t);return n}"array"===e.type}}function o(e,t){var n={};for(var r in e){var a=t[r],u=e[r];if(!t||a!==u)if("object"==typeof u&&!s.isArray(u)&&a){var l=o(u,a);i(l)||(n[r]=l)}else if(s.isArray(u)){if(s.isArray(a)&&u.length===a.length){for(var f=!0,c=0;c<u.length;c++)if(u[c]!==a[c]){f=!1;break}if(f)continue}n[r]=u}else n[r]=u}return n}function u(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];for(var i=0;i<t.length;i++)e=l(e,t[i]);return e}function l(e,t){if("object"!=typeof t||null===t)return e;for(var n in t)t.hasOwnProperty(n)&&void 0!==t[n]&&("object"!=typeof t[n]||null===t[n]?e[n]=t[n]:"object"!=typeof e[n]||null===e[n]?e[n]=u(t[n].constructor===Array?[]:{},t[n]):u(e[n],t[n]));return e}var s=e("../util");n.extend=r,n.instantiate=a,n.subtract=o,n.merge=u},{"../util":46}],41:[function(e,t,n){var i=e("../aggregate"),r=e("../type"),a=e("../util");n.sort={"default":"ascending",supportedTypes:a.toMap([r.QUANTITATIVE,r.ORDINAL]),oneOf:[{type:"string","enum":["ascending","descending","unsorted"]},{type:"object",required:["field","op"],properties:{field:{type:"string",description:"The field name to aggregate over."},op:{type:"string","enum":i.AGGREGATE_OPS,description:"The field name to aggregate over."},order:{type:"string","enum":["ascending","descending"]}}}]}},{"../aggregate":9,"../type":45,"../util":46}],42:[function(e,t,n){function i(e){return"mark"+n.ASSIGN+e.mark+n.DELIM+a(e.encoding)}function r(e,t,i){var r=e.split(n.DELIM),a=r.shift().split(n.ASSIGN)[1].trim(),u=o(r.join(n.DELIM)),l={mark:h.Mark[a],encoding:u};return void 0!==t&&(l.data=t),void 0!==i&&(l.config=i),l}function a(e){return p.map(e,function(e,t){return t+n.ASSIGN+u(e)}).join(n.DELIM)}function o(e){return e.split(n.DELIM).reduce(function(e,t){var i=t.split(n.ASSIGN),r=i[0].trim(),a=i[1];return e[r]=s(a),e},{})}function u(e){return(e.aggregate?e.aggregate+n.FUNC:"")+(e.timeUnit?e.timeUnit+n.FUNC:"")+(e.bin?"bin"+n.FUNC:"")+(e.field||"")+n.TYPE+d.SHORT_TYPE[e.type]}function l(e,t){return void 0===t&&(t=n.DELIM),e.map(u).join(t)}function s(e){var t,i=e.split(n.TYPE),r={field:i[0].trim(),type:d.TYPE_FROM_SHORT_TYPE[i[1].trim()]};for(t in f.AGGREGATE_OPS){var a=f.AGGREGATE_OPS[t];if(0===r.field.indexOf(a+"_")){r.field=r.field.substr(a.length+1),"count"===a&&0===r.field.length&&(r.field="*"),r.aggregate=a;break}}for(t in c.TIMEUNITS){var o=c.TIMEUNITS[t];if(r.field&&0===r.field.indexOf(o+"_")){r.field=r.field.substr(r.field.length+1),r.timeUnit=o;break}}return r.field&&0===r.field.indexOf("bin_")&&(r.field=r.field.substr(4),r.bin=!0),r}var f=e("./aggregate"),c=e("./timeunit"),d=e("./type"),p=e("./encoding"),h=e("./mark");n.DELIM="|",n.ASSIGN="=",n.TYPE=",",n.FUNC="_",n.shorten=i,n.parse=r,n.shortenEncoding=a,n.parseEncoding=o,n.shortenFieldDef=u,n.shortenFieldDefs=l,n.parseFieldDef=s},{"./aggregate":9,"./encoding":24,"./mark":26,"./timeunit":44,"./type":45}],43:[function(e,t,n){function i(e){return f.isAggregate(e.encoding)}function r(e){return f.fieldDefs(e.encoding)}function a(e){return new l.Model(e).toSpec(!0)}function o(e){return(f.has(e.encoding,s.COLOR)||f.has(e.encoding,s.SHAPE))&&(e.mark===c.BAR||e.mark===c.AREA)&&(!e.config||!e.config.stack!=!1)&&f.isAggregate(e.encoding)}function u(e){var t=e.encoding,n=d.duplicate(e.encoding);return n.x=t.y,n.y=t.x,n.row=t.column,n.column=t.row,e.encoding=n,e}var l=e("./compiler/Model"),s=e("./channel"),f=e("./encoding"),c=e("./mark"),d=e("./util");n.alwaysNoOcclusion=i,n.fieldDefs=r,n.getCleanSpec=a,n.isStack=o,n.transpose=u},{"./channel":11,"./compiler/Model":12,"./encoding":24,"./mark":26,"./util":46}],44:[function(e,t,n){n.TIMEUNITS=["year","month","day","date","hours","minutes","seconds"]},{}],45:[function(e,t,n){function i(e){var t=e;return n.TYPE_FROM_SHORT_TYPE[t.toUpperCase()]||t.toLowerCase()}!function(e){e[e.QUANTITATIVE="quantitative"]="QUANTITATIVE",e[e.ORDINAL="ordinal"]="ORDINAL",e[e.TEMPORAL="temporal"]="TEMPORAL",e[e.NOMINAL="nominal"]="NOMINAL"}(n.Type||(n.Type={}));var r=n.Type;n.QUANTITATIVE=r.QUANTITATIVE,n.ORDINAL=r.ORDINAL,n.TEMPORAL=r.TEMPORAL,n.NOMINAL=r.NOMINAL,n.SHORT_TYPE={quantitative:"Q",temporal:"T",nominal:"N",ordinal:"O"},n.TYPE_FROM_SHORT_TYPE={Q:n.QUANTITATIVE,T:n.TEMPORAL,O:n.ORDINAL,N:n.NOMINAL},n.getFullName=i},{}],46:[function(e,t,n){function i(e){for(var t in e)n.hasOwnProperty(t)||(n[t]=e[t])}function r(e,t){return e.indexOf(t)>-1}function a(e,t,n){if(e.forEach)e.forEach.call(n,t);else for(var i in e)t.call(n,e[i],i,e)}function o(e,t,n,i){if(e.reduce)return e.reduce.call(i,t,n);for(var r in e)n=t.call(i,n,e[r],r,e);return n}function u(e,t,n){if(e.map)return e.map.call(n,t);var i=[];for(var r in e)i.push(t.call(n,e[r],r,e));return i}function l(e,t){var n,i=0;for(n in e)if(t(e[n],n,i++))return!0;return!1}function s(e,t){var n,i=0;for(n in e)if(!t(e[n],n,i++))return!1;return!0}function f(e,t){return d({min:e.min,max:e.max,maxbins:t})}function c(e){console.error("[VL Error]",e)}i(e("datalib/src/util")),i(e("datalib/src/generate")),i(e("datalib/src/stats")),n.contains=r,n.forEach=a,n.reduce=o,n.map=u,n.any=l,n.all=s;var d=e("datalib/src/bins/bins");n.getbins=f,n.error=c},{"datalib/src/bins/bins":3,"datalib/src/generate":4,"datalib/src/stats":6,"datalib/src/util":8}],47:[function(e,t,n){function i(e,t,i){void 0===t&&(t=n.DEFAULT_REQUIRED_CHANNEL_MAP),void 0===i&&(i=n.DEFAULT_SUPPORTED_CHANNEL_TYPE);var r=e.mark,o=e.encoding,u=t[r],l=i[r];for(var s in u)if(!(u[s]in o))return'Missing encoding channel "'+u[s]+'" for mark "'+r+'"';for(var f in o)if(!l[f])return'Encoding channel "'+f+'" is not supported by mark type "'+r+'"';return r!==a.BAR||o.x||o.y?null:"Missing both x and y for bar"}var r=e("./util"),a=e("./mark");n.DEFAULT_REQUIRED_CHANNEL_MAP={text:["text"],line:["x","y"],area:["x","y"]},n.DEFAULT_SUPPORTED_CHANNEL_TYPE={bar:r.toMap(["row","column","x","y","size","color","detail"]),line:r.toMap(["row","column","x","y","color","detail"]),area:r.toMap(["row","column","x","y","color","detail"]),tick:r.toMap(["row","column","x","y","color","detail"]),circle:r.toMap(["row","column","x","y","color","size","detail"]),square:r.toMap(["row","column","x","y","color","size","detail"]),point:r.toMap(["row","column","x","y","color","size","detail","shape"]),text:r.toMap(["row","column","size","color","text"])},n.getEncodingMappingError=i},{"./mark":26,"./util":46}],48:[function(e,t,n){var i=e("./bin"),r=e("./channel"),a=e("./data"),o=e("./encoding"),u=e("./fielddef"),l=e("./compiler/compiler"),s=e("./schema/schema"),f=e("./shorthand"),c=e("./spec"),d=e("./timeunit"),p=e("./type"),h=e("./validate"),m=e("./util");n.bin=i,n.channel=r,n.compiler=l,n.compile=l.compile,n.data=a,n.encoding=o,n.fieldDef=u,n.schema=s,n.shorthand=f,n.spec=c,n.timeUnit=d,n.type=p,n.util=m,n.validate=h,n.version="0.9.0"},{"./bin":10,"./channel":11,"./compiler/compiler":14,"./data":23,"./encoding":24,"./fielddef":25,"./schema/schema":39,"./shorthand":42,"./spec":43,"./timeunit":44,"./type":45,"./util":46,"./validate":47}]},{},[48])(48)});
//# sourceMappingURL=vega-lite.min.js.map
